---
:platform:
  :name: redhat
  :release: '9.3'
  :target_id: eb5ee6b5-fb36-5a69-bfbe-ed7412a4568a
:profiles:
- :name: cis-rhel9-level1-workstation
  :version: 1.0.0-1
  :sha256: a82f366218de75c5ce5adc10ec2b5643fc7f73d445cc9539312d5136801a4044
  :title: CIS Red Hat Enterprise Linux 9 Benchmark Level 1 - Workstation
  :maintainer: Chef Software, Inc.
  :summary: CIS Red Hat Enterprise Linux 9 Benchmark Level 1 - Workstation translated
    from SCAP
  :license: Proprietary, All rights reserved
  :copyright: Chef Software, Inc.
  :copyright_email: support@chef.io
  :supports:
  - :platform-family: redhat
  :attributes:
  - :name: max_startups
    :options:
      :value: 10:30:60
  - :name: sudo_log_file
    :options:
      :value: "/var/log/sudo.log"
  - :name: ipv6_status
    :options:
      :value: enabled
  - :name: audit_tools_files
    :options:
      :value:
      - "/sbin/auditctl"
      - "/sbin/aureport"
      - "/sbin/ausearch"
      - "/sbin/autrace"
      - "/sbin/auditd"
      - "/sbin/augenrules"
  - :name: max_idle_delay
    :options:
      :value: '900'
  - :name: max_lock_delay
    :options:
      :value: '5'
  :groups:
  - :id: controls/translated-controls.rb
    :controls:
    - xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_Ensure_tmp_is_a_separate_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.2.2_Ensure_nodev_option_set_on_tmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.2.3_Ensure_noexec_option_set_on_tmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.2.4_Ensure_nosuid_option_set_on_tmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.3.2_Ensure_nodev_option_set_on_var_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.3.3_Ensure_nosuid_option_set_on_var_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.4.2_Ensure_noexec_option_set_on_vartmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.4.3_Ensure_nosuid_option_set_on_vartmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.4.4_Ensure_nodev_option_set_on_vartmp_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.5.2_Ensure_nodev_option_set_on_varlog_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.5.3_Ensure_noexec_option_set_on_varlog_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.5.4_Ensure_nosuid_option_set_on_varlog_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.6.2_Ensure_noexec_option_set_on_varlogaudit_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.6.3_Ensure_nodev_option_set_on_varlogaudit_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.6.4_Ensure_nosuid_option_set_on_varlogaudit_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.7.2_Ensure_nodev_option_set_on_home_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.7.3_Ensure_nosuid_option_set_on_home_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.8.1_Ensure_devshm_is_a_separate_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.8.2_Ensure_nodev_option_set_on_devshm_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.8.3_Ensure_noexec_option_set_on_devshm_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.1.8.4_Ensure_nosuid_option_set_on_devshm_partition
    - xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_GPG_keys_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_gpgcheck_is_globally_activated
    - xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_package_manager_repositories_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_AIDE_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_filesystem_integrity_is_regularly_checked
    - xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_cryptographic_mechanisms_are_used_to_protect_the_integrity_of_audit_tools
    - xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_bootloader_password_is_set
    - xccdf_org.cisecurity.benchmarks_rule_1.4.2_Ensure_permissions_on_bootloader_config_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_core_dump_storage_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_1.5.2_Ensure_core_dump_backtraces_are_disabled
    - xccdf_org.cisecurity.benchmarks_rule_1.5.3_Ensure_address_space_layout_randomization_ASLR_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.1_Ensure_SELinux_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.2_Ensure_SELinux_is_not_disabled_in_bootloader_configuration
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.3_Ensure_SELinux_policy_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.4_Ensure_the_SELinux_mode_is_not_disabled
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.6_Ensure_no_unconfined_services_exist
    - xccdf_org.cisecurity.benchmarks_rule_1.6.1.8_Ensure_the_MCS_Translation_Service_mcstrans_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_1.7.1_Ensure_message_of_the_day_is_configured_properly
    - xccdf_org.cisecurity.benchmarks_rule_1.7.2_Ensure_local_login_warning_banner_is_configured_properly
    - xccdf_org.cisecurity.benchmarks_rule_1.7.3_Ensure_remote_login_warning_banner_is_configured_properly
    - xccdf_org.cisecurity.benchmarks_rule_1.7.4_Ensure_permissions_on_etcmotd_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.7.5_Ensure_permissions_on_etcissue_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.7.6_Ensure_permissions_on_etcissue.net_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.8.2_Ensure_GDM_login_banner_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_1.8.3_Ensure_GDM_disable-user-list_option_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_1.8.4_Ensure_GDM_screen_locks_when_the_user_is_idle
    - xccdf_org.cisecurity.benchmarks_rule_1.8.5_Ensure_GDM_screen_locks_cannot_be_overridden
    - xccdf_org.cisecurity.benchmarks_rule_1.8.8_Ensure_GDM_autorun-never_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_1.8.9_Ensure_GDM_autorun-never_is_not_overridden
    - xccdf_org.cisecurity.benchmarks_rule_1.8.10_Ensure_XDCMP_is_not_enabled
    - xccdf_org.cisecurity.benchmarks_rule_1.9_Ensure_updates_patches_and_additional_security_software_are_installed
    - xccdf_org.cisecurity.benchmarks_rule_1.10_Ensure_system-wide_crypto_policy_is_not_legacy
    - xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_time_synchronization_is_in_use
    - xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_chrony_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_2.2.4_Ensure_DHCP_Server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.5_Ensure_DNS_Server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.6_Ensure_VSFTP_Server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.7_Ensure_TFTP_Server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.8_Ensure_a_web_server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.9_Ensure_IMAP_and_POP3_server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.10_Ensure_Samba_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.11_Ensure_HTTP_Proxy_Server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.12_Ensure_net-snmp_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.13_Ensure_telnet-server_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.14_Ensure_dnsmasq_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.2.15_Ensure_mail_transfer_agent_is_configured_for_local-only_mode
    - xccdf_org.cisecurity.benchmarks_rule_2.2.16_Ensure_nfs-utils_is_not_installed_or_the__nfs-server_service_is_masked
    - xccdf_org.cisecurity.benchmarks_rule_2.2.17_Ensure_rpcbind_is_not_installed_or_the__rpcbind_services_are_masked
    - xccdf_org.cisecurity.benchmarks_rule_2.2.18_Ensure_rsync-daemon_is_not_installed_or_the_rsyncd_service_is_masked
    - xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_telnet_client_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_LDAP_client_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_TFTP_client_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_FTP_client_is_not_installed
    - xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_nonessential_services_listening_on_the_system_are_removed_or_masked
    - xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_IPv6_status_is_identified
    - xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_IP_forwarding_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_packet_redirect_sending_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_3.3.1_Ensure_source_routed_packets_are_not_accepted
    - xccdf_org.cisecurity.benchmarks_rule_3.3.2_Ensure_ICMP_redirects_are_not_accepted
    - xccdf_org.cisecurity.benchmarks_rule_3.3.3_Ensure_secure_ICMP_redirects_are_not_accepted
    - xccdf_org.cisecurity.benchmarks_rule_3.3.4_Ensure_suspicious_packets_are_logged
    - xccdf_org.cisecurity.benchmarks_rule_3.3.5_Ensure_broadcast_ICMP_requests_are_ignored
    - xccdf_org.cisecurity.benchmarks_rule_3.3.6_Ensure_bogus_ICMP_responses_are_ignored
    - xccdf_org.cisecurity.benchmarks_rule_3.3.7_Ensure_Reverse_Path_Filtering_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_3.3.8_Ensure_TCP_SYN_Cookies_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_3.3.9_Ensure_IPv6_router_advertisements_are_not_accepted
    - xccdf_org.cisecurity.benchmarks_rule_3.4.1.1_Ensure_nftables_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_3.4.1.2_Ensure_a_single_firewall_configuration_utility_is_in_use
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.1_Ensure_firewalld_default_zone_is_set
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.2_Ensure_at_least_one_nftables_table_exists
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.3_Ensure_nftables_base_chains_exist
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.4_Ensure_host_based_firewall_loopback_traffic_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.5_Ensure_firewalld_drops_unnecessary_services_and_ports
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.6_Ensure_nftables_established_connections_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_3.4.2.7_Ensure_nftables_default_deny_firewall_policy
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.1_Ensure_rsyslog_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.2_Ensure_rsyslog_service_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.3_Ensure_journald_is_configured_to_send_logs_to_rsyslog
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.4_Ensure_rsyslog_default_file_permissions_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.5_Ensure_logging_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.6_Ensure_rsyslog_is_configured_to_send_logs_to_a_remote_log_host
    - xccdf_org.cisecurity.benchmarks_rule_4.2.1.7_Ensure_rsyslog_is_not_configured_to_receive_logs_from_a_remote_client
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.1_Ensure_systemd-journal-remote_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.2_Ensure_systemd-journal-remote_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.3_Ensure_systemd-journal-remote_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.4_Ensure_journald_is_not_configured_to_receive_logs_from_a_remote_client
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.2_Ensure_journald_service_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.3_Ensure_journald_is_configured_to_compress_large_log_files
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.4_Ensure_journald_is_configured_to_write_logfiles_to_persistent_disk
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.5_Ensure_journald_is_not_configured_to_send_logs_to_rsyslog
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.6_Ensure_journald_log_rotation_is_configured_per_site_policy
    - xccdf_org.cisecurity.benchmarks_rule_4.2.2.7_Ensure_journald_default_file_permissions_configured
    - xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_all_logfiles_have_appropriate_permissions_and_ownership
    - xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_logrotate_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_cron_daemon_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_permissions_on_etccrontab_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_permissions_on_etccron.hourly_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_permissions_on_etccron.daily_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_permissions_on_etccron.weekly_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_permissions_on_etccron.monthly_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_permissions_on_etccron.d_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_cron_is_restricted_to_authorized_users
    - xccdf_org.cisecurity.benchmarks_rule_5.1.9_Ensure_at_is_restricted_to_authorized_users
    - xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_permissions_on_etcsshsshd_config_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_permissions_on_SSH_private_host_key_files_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_permissions_on_SSH_public_host_key_files_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_SSH_access_is_limited
    - xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_SSH_LogLevel_is_appropriate
    - xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_SSH_PAM_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_SSH_root_login_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_SSH_HostbasedAuthentication_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.9_Ensure_SSH_PermitEmptyPasswords_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.10_Ensure_SSH_PermitUserEnvironment_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.11_Ensure_SSH_IgnoreRhosts_is_enabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.12_Ensure_SSH_X11_forwarding_is_disabled
    - xccdf_org.cisecurity.benchmarks_rule_5.2.14_Ensure_system-wide_crypto_policy_is_not_over-ridden
    - xccdf_org.cisecurity.benchmarks_rule_5.2.15_Ensure_SSH_warning_banner_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.2.16_Ensure_SSH_MaxAuthTries_is_set_to_4_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.2.17_Ensure_SSH_MaxStartups_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.2.18_Ensure_SSH_MaxSessions_is_set_to_10_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.2.19_Ensure_SSH_LoginGraceTime_is_set_to_one_minute_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.2.20_Ensure_SSH_Idle_Timeout_Interval_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_sudo_is_installed
    - xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_sudo_commands_use_pty
    - xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_sudo_log_file_exists
    - xccdf_org.cisecurity.benchmarks_rule_5.3.5_Ensure_re-authentication_for_privilege_escalation_is_not_disabled_globally
    - xccdf_org.cisecurity.benchmarks_rule_5.3.6_Ensure_sudo_authentication_timeout_is_configured_correctly
    - xccdf_org.cisecurity.benchmarks_rule_5.3.7_Ensure_access_to_the_su_command_is_restricted
    - xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_custom_authselect_profile_is_used
    - xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_authselect_includes_with-faillock
    - xccdf_org.cisecurity.benchmarks_rule_5.5.1_Ensure_password_creation_requirements_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_lockout_for_failed_password_attempts_is_configured
    - xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_password_reuse_is_limited
    - xccdf_org.cisecurity.benchmarks_rule_5.5.4_Ensure_password_hashing_algorithm_is_SHA-512_or_yescrypt
    - xccdf_org.cisecurity.benchmarks_rule_5.6.1.1_Ensure_password_expiration_is_365_days_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.6.1.2_Ensure_minimum_days_between_password_changes_is__configured
    - xccdf_org.cisecurity.benchmarks_rule_5.6.1.3_Ensure_password_expiration_warning_days_is_7_or_more
    - xccdf_org.cisecurity.benchmarks_rule_5.6.1.4_Ensure_inactive_password_lock_is_30_days_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.6.1.5_Ensure_all_users_last_password_change_date_is_in_the_past
    - xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_system_accounts_are_secured
    - xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_default_user_shell_timeout_is_900_seconds_or_less
    - xccdf_org.cisecurity.benchmarks_rule_5.6.4_Ensure_default_group_for_the_root_account_is_GID_0
    - xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_default_user_umask_is_027_or_more_restrictive
    - xccdf_org.cisecurity.benchmarks_rule_5.6.6_Ensure_root_password_is_set
    - xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_permissions_on_etcpasswd_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_permissions_on_etcpasswd-_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_permissions_on_etcgroup_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_permissions_on_etcgroup-_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_permissions_on_etcshadow_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.6_Ensure_permissions_on_etcshadow-_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.7_Ensure_permissions_on_etcgshadow_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.8_Ensure_permissions_on_etcgshadow-_are_configured
    - xccdf_org.cisecurity.benchmarks_rule_6.1.9_Ensure_no_world_writable_files_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.1.10_Ensure_no_unowned_files_or_directories_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.1.11_Ensure_no_ungrouped_files_or_directories_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.1.12_Ensure_sticky_bit_is_set_on_all_world-writable_directories
    - xccdf_org.cisecurity.benchmarks_rule_6.1.13_Audit_SUID_executables
    - xccdf_org.cisecurity.benchmarks_rule_6.1.14_Audit_SGID_executables
    - xccdf_org.cisecurity.benchmarks_rule_6.2.1_Ensure_accounts_in_etcpasswd_use_shadowed_passwords
    - xccdf_org.cisecurity.benchmarks_rule_6.2.2_Ensure_etcshadow_password_fields_are_not_empty
    - xccdf_org.cisecurity.benchmarks_rule_6.2.3_Ensure_all_groups_in_etcpasswd_exist_in_etcgroup
    - xccdf_org.cisecurity.benchmarks_rule_6.2.4_Ensure_no_duplicate_UIDs_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.2.5_Ensure_no_duplicate_GIDs_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.2.6_Ensure_no_duplicate_user_names_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.2.7_Ensure_no_duplicate_group_names_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.2.8_Ensure_root_PATH_Integrity
    - xccdf_org.cisecurity.benchmarks_rule_6.2.9_Ensure_root_is_the_only_UID_0_account
    - xccdf_org.cisecurity.benchmarks_rule_6.2.10_Ensure_local_interactive_user_home_directories_exist
    - xccdf_org.cisecurity.benchmarks_rule_6.2.11_Ensure_local_interactive_users_own_their_home_directories
    - xccdf_org.cisecurity.benchmarks_rule_6.2.12_Ensure_local_interactive_user_home_directories_are_mode_750_or_more_restrictive
    - xccdf_org.cisecurity.benchmarks_rule_6.2.13_Ensure_no_local_interactive_user_has_.netrc_files
    - xccdf_org.cisecurity.benchmarks_rule_6.2.14_Ensure_no_local_interactive_user_has_.forward_files
    - xccdf_org.cisecurity.benchmarks_rule_6.2.15_Ensure_no_local_interactive_user_has_.rhosts_files
    - xccdf_org.cisecurity.benchmarks_rule_6.2.16_Ensure_local_interactive_user_dot_files_are_not_group_or_world_writable
  :controls:
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_Ensure_tmp_is_a_separate_partition
    :title: Ensure /tmp is a separate partition
    :desc: |-
      The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.

      Rationale: Making /tmp its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated. Once the program was updated, the hard link would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.

      Since the /tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition.

      This can be accomplished by either mounting tmpfs to /tmp , or creating a separate partition for /tmp .
    :descriptions:
    - :label: default
      :data: |-
        The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.

        Rationale: Making /tmp its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated. Once the program was updated, the hard link would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.

        Since the /tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition.

        This can be accomplished by either mounting tmpfs to /tmp , or creating a separate partition for /tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_Ensure_tmp_is_a_separate_partition\"
      do\n  title \"Ensure /tmp is a separate partition\"\n  desc  \"\n    The /tmp
      directory is a world-writable directory used for temporary storage by all users
      and some applications.\n    \n    Rationale: Making /tmp its own file system
      allows an administrator to set additional mount options such as the noexec option
      on the mount, making /tmp useless for an attacker to install executable code.
      It would also prevent an attacker from establishing a hard link to a system
      setuid program and wait for it to be updated. Once the program was updated,
      the hard link would be broken and the attacker would have his own copy of the
      program. If the program happened to have a security vulnerability, the attacker
      could continue to exploit the known flaw.\n    \n    Since the /tmp directory
      is intended to be world-writable, there is a risk of resource exhaustion if
      it is not bound to a separate partition.\n    \n    This can be accomplished
      by either mounting tmpfs to /tmp , or creating a separate partition for /tmp
      .\n  \"\n  impact 1.0\n  describe mount(\"/tmp\") do\n    it { should be_mounted
      }\n  end\nend\n"
    :source_location:
      :line: 47
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /tmp is expected to be mounted
      :run_time: 0.020635684
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /tmp is not mounted
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.2.2_Ensure_nodev_option_set_on_tmp_partition
    :title: Ensure nodev option set on /tmp partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /tmp .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.2.2_Ensure_nodev_option_set_on_tmp_partition\"
      do\n  title \"Ensure nodev option set on /tmp partition\"\n  desc  \"\n    The
      nodev mount option specifies that the filesystem cannot contain special devices.\n
      \   \n    Rationale: Since the /tmp filesystem is not intended to support devices,
      set this option to ensure that users cannot create a block or character special
      devices in /tmp .\n  \"\n  impact 1.0\n  describe mount(\"/tmp\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/tmp\") do\n    its(\"options\")
      { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 64
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /tmp is expected to be mounted
      :run_time: 0.000195167
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /tmp is not mounted
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
    - :status: failed
      :code_desc: Mount /tmp options is expected to include "nodev"
      :run_time: 0.000231208
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.2.3_Ensure_noexec_option_set_on_tmp_partition
    :title: Ensure noexec option set on /tmp partition
    :desc: |-
      The noexec mount option specifies that the filesystem cannot contain executable binaries.

      Rationale: Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp .
    :descriptions:
    - :label: default
      :data: |-
        The noexec mount option specifies that the filesystem cannot contain executable binaries.

        Rationale: Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.2.3_Ensure_noexec_option_set_on_tmp_partition\"
      do\n  title \"Ensure noexec option set on /tmp partition\"\n  desc  \"\n    The
      noexec mount option specifies that the filesystem cannot contain executable
      binaries.\n    \n    Rationale: Since the /tmp filesystem is only intended for
      temporary file storage, set this option to ensure that users cannot run executable
      binaries from /tmp .\n  \"\n  impact 1.0\n  describe mount(\"/tmp\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/tmp\") do\n    its(\"options\")
      { should include \"noexec\" }\n  end\nend\n"
    :source_location:
      :line: 80
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /tmp is expected to be mounted
      :run_time: 0.000131556
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /tmp is not mounted
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
    - :status: failed
      :code_desc: Mount /tmp options is expected to include "noexec"
      :run_time: 0.000164179
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "noexec", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.2.4_Ensure_nosuid_option_set_on_tmp_partition
    :title: Ensure nosuid option set on /tmp partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.2.4_Ensure_nosuid_option_set_on_tmp_partition\"
      do\n  title \"Ensure nosuid option set on /tmp partition\"\n  desc  \"\n    The
      nosuid mount option specifies that the filesystem cannot contain setuid files.\n
      \   \n    Rationale: Since the /tmp filesystem is only intended for temporary
      file storage, set this option to ensure that users cannot create setuid files
      in /tmp .\n  \"\n  impact 1.0\n  describe mount(\"/tmp\") do\n    it { should
      be_mounted }\n  end\n  describe mount(\"/tmp\") do\n    its(\"options\") { should
      include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 96
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /tmp is expected to be mounted
      :run_time: 0.00012213
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /tmp is not mounted
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
    - :status: failed
      :code_desc: Mount /tmp options is expected to include "nosuid"
      :run_time: 0.00013573
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/tmp"]'
      :resource_id: "/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.3.2_Ensure_nodev_option_set_on_var_partition
    :title: Ensure nodev option set on /var partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /var filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /var filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.3.2_Ensure_nodev_option_set_on_var_partition\"
      do\n  title \"Ensure nodev option set on /var partition\"\n  desc  \"\n    The
      nodev mount option specifies that the filesystem cannot contain special devices.\n
      \   \n    Rationale: Since the /var filesystem is not intended to support devices,
      set this option to ensure that users cannot create a block or character special
      devices in /var .\n  \"\n  impact 1.0\n  describe mount(\"/var\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/var\") do\n    its(\"options\")
      { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 112
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var is expected to be mounted
      :run_time: 0.057811933
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var is not mounted
      :resource_class: mount
      :resource_params: '["/var"]'
      :resource_id: "/var"
    - :status: failed
      :code_desc: Mount /var options is expected to include "nodev"
      :run_time: 0.000261802
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var"]'
      :resource_id: "/var"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.3.3_Ensure_nosuid_option_set_on_var_partition
    :title: Ensure nosuid option set on /var partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /var filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /var filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.3.3_Ensure_nosuid_option_set_on_var_partition\"
      do\n  title \"Ensure nosuid option set on /var partition\"\n  desc  \"\n    The
      nosuid mount option specifies that the filesystem cannot contain setuid files.\n
      \   \n    Rationale: Since the /var filesystem is only intended for variable
      files such as logs, set this option to ensure that users cannot create setuid
      files in /var .\n  \"\n  impact 1.0\n  describe mount(\"/var\") do\n    it {
      should be_mounted }\n  end\n  describe mount(\"/var\") do\n    its(\"options\")
      { should include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 128
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var is expected to be mounted
      :run_time: 0.000150202
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var is not mounted
      :resource_class: mount
      :resource_params: '["/var"]'
      :resource_id: "/var"
    - :status: failed
      :code_desc: Mount /var options is expected to include "nosuid"
      :run_time: 0.000143782
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var"]'
      :resource_id: "/var"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.4.2_Ensure_noexec_option_set_on_vartmp_partition
    :title: Ensure noexec option set on /var/tmp partition
    :desc: |-
      The noexec mount option specifies that the filesystem cannot contain executable binaries.

      Rationale: Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp .
    :descriptions:
    - :label: default
      :data: |-
        The noexec mount option specifies that the filesystem cannot contain executable binaries.

        Rationale: Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.4.2_Ensure_noexec_option_set_on_vartmp_partition\"
      do\n  title \"Ensure noexec option set on /var/tmp partition\"\n  desc  \"\n
      \   The noexec mount option specifies that the filesystem cannot contain executable
      binaries.\n    \n    Rationale: Since the /var/tmp filesystem is only intended
      for temporary file storage, set this option to ensure that users cannot run
      executable binaries from /var/tmp .\n  \"\n  impact 1.0\n  describe mount(\"/var/tmp\")
      do\n    it { should be_mounted }\n  end\n  describe mount(\"/var/tmp\") do\n
      \   its(\"options\") { should include \"noexec\" }\n  end\nend\n"
    :source_location:
      :line: 144
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/tmp is expected to be mounted
      :run_time: 0.058686935
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/tmp is not mounted
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
    - :status: failed
      :code_desc: Mount /var/tmp options is expected to include "noexec"
      :run_time: 0.000265841
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "noexec", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.4.3_Ensure_nosuid_option_set_on_vartmp_partition
    :title: Ensure nosuid option set on /var/tmp partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.4.3_Ensure_nosuid_option_set_on_vartmp_partition\"
      do\n  title \"Ensure nosuid option set on /var/tmp partition\"\n  desc  \"\n
      \   The nosuid mount option specifies that the filesystem cannot contain setuid
      files.\n    \n    Rationale: Since the /var/tmp filesystem is only intended
      for temporary file storage, set this option to ensure that users cannot create
      setuid files in /var/tmp .\n  \"\n  impact 1.0\n  describe mount(\"/var/tmp\")
      do\n    it { should be_mounted }\n  end\n  describe mount(\"/var/tmp\") do\n
      \   its(\"options\") { should include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 160
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/tmp is expected to be mounted
      :run_time: 0.000147187
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/tmp is not mounted
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
    - :status: failed
      :code_desc: Mount /var/tmp options is expected to include "nosuid"
      :run_time: 0.000139605
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.4.4_Ensure_nodev_option_set_on_vartmp_partition
    :title: Ensure nodev option set on /var/tmp partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/tmp .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/tmp .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.4.4_Ensure_nodev_option_set_on_vartmp_partition\"
      do\n  title \"Ensure nodev option set on /var/tmp partition\"\n  desc  \"\n
      \   The nodev mount option specifies that the filesystem cannot contain special
      devices.\n    \n    Rationale: Since the /var/tmp filesystem is not intended
      to support devices, set this option to ensure that users cannot create a block
      or character special devices in /var/tmp .\n  \"\n  impact 1.0\n  describe mount(\"/var/tmp\")
      do\n    it { should be_mounted }\n  end\n  describe mount(\"/var/tmp\") do\n
      \   its(\"options\") { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 176
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/tmp is expected to be mounted
      :run_time: 0.000119493
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/tmp is not mounted
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
    - :status: failed
      :code_desc: Mount /var/tmp options is expected to include "nodev"
      :run_time: 0.000133774
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/tmp"]'
      :resource_id: "/var/tmp"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.5.2_Ensure_nodev_option_set_on_varlog_partition
    :title: Ensure nodev option set on /var/log partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /var/log filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /var/log filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.5.2_Ensure_nodev_option_set_on_varlog_partition\"
      do\n  title \"Ensure nodev option set on /var/log partition\"\n  desc  \"\n
      \   The nodev mount option specifies that the filesystem cannot contain special
      devices.\n    \n    Rationale: Since the /var/log filesystem is not intended
      to support devices, set this option to ensure that users cannot create a block
      or character special devices in /var/log .\n  \"\n  impact 1.0\n  describe mount(\"/var/log\")
      do\n    it { should be_mounted }\n  end\n  describe mount(\"/var/log\") do\n
      \   its(\"options\") { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 192
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log is expected to be mounted
      :run_time: 0.057888926
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log is not mounted
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
    - :status: failed
      :code_desc: Mount /var/log options is expected to include "nodev"
      :run_time: 0.000254354
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.5.3_Ensure_noexec_option_set_on_varlog_partition
    :title: Ensure noexec option set on /var/log partition
    :desc: |-
      The noexec mount option specifies that the filesystem cannot contain executable binaries.

      Rationale: Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot run executable binaries from /var/log .
    :descriptions:
    - :label: default
      :data: |-
        The noexec mount option specifies that the filesystem cannot contain executable binaries.

        Rationale: Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot run executable binaries from /var/log .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.5.3_Ensure_noexec_option_set_on_varlog_partition\"
      do\n  title \"Ensure noexec option set on /var/log partition\"\n  desc  \"\n
      \   The noexec mount option specifies that the filesystem cannot contain executable
      binaries.\n    \n    Rationale: Since the /var/log filesystem is only intended
      for log files, set this option to ensure that users cannot run executable binaries
      from /var/log .\n  \"\n  impact 1.0\n  describe mount(\"/var/log\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/var/log\") do\n    its(\"options\")
      { should include \"noexec\" }\n  end\nend\n"
    :source_location:
      :line: 208
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log is expected to be mounted
      :run_time: 0.000162068
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log is not mounted
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
    - :status: failed
      :code_desc: Mount /var/log options is expected to include "noexec"
      :run_time: 0.000173533
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "noexec", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.5.4_Ensure_nosuid_option_set_on_varlog_partition
    :title: Ensure nosuid option set on /var/log partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot create setuid files in /var/log .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot create setuid files in /var/log .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.5.4_Ensure_nosuid_option_set_on_varlog_partition\"
      do\n  title \"Ensure nosuid option set on /var/log partition\"\n  desc  \"\n
      \   The nosuid mount option specifies that the filesystem cannot contain setuid
      files.\n    \n    Rationale: Since the /var/log filesystem is only intended
      for log files, set this option to ensure that users cannot create setuid files
      in /var/log .\n  \"\n  impact 1.0\n  describe mount(\"/var/log\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/var/log\") do\n    its(\"options\")
      { should include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 224
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log is expected to be mounted
      :run_time: 0.000130327
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log is not mounted
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
    - :status: failed
      :code_desc: Mount /var/log options is expected to include "nosuid"
      :run_time: 0.000179284
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log"]'
      :resource_id: "/var/log"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.6.2_Ensure_noexec_option_set_on_varlogaudit_partition
    :title: Ensure noexec option set on /var/log/audit partition
    :desc: |-
      The noexec mount option specifies that the filesystem cannot contain executable binaries.

      Rationale: Since the /var/log/audit filesystem is only intended for audit logs, set this option to ensure that users cannot run executable binaries from /var/log/audit .
    :descriptions:
    - :label: default
      :data: |-
        The noexec mount option specifies that the filesystem cannot contain executable binaries.

        Rationale: Since the /var/log/audit filesystem is only intended for audit logs, set this option to ensure that users cannot run executable binaries from /var/log/audit .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.6.2_Ensure_noexec_option_set_on_varlogaudit_partition\"
      do\n  title \"Ensure noexec option set on /var/log/audit partition\"\n  desc
      \ \"\n    The noexec mount option specifies that the filesystem cannot contain
      executable binaries.\n    \n    Rationale: Since the /var/log/audit filesystem
      is only intended for audit logs, set this option to ensure that users cannot
      run executable binaries from /var/log/audit .\n  \"\n  impact 1.0\n  describe
      mount(\"/var/log/audit\") do\n    it { should be_mounted }\n  end\n  describe
      mount(\"/var/log/audit\") do\n    its(\"options\") { should include \"noexec\"
      }\n  end\nend\n"
    :source_location:
      :line: 240
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log/audit is expected to be mounted
      :run_time: 0.058408638
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log/audit is not mounted
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
    - :status: failed
      :code_desc: Mount /var/log/audit options is expected to include "noexec"
      :run_time: 0.000273354
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "noexec", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.6.3_Ensure_nodev_option_set_on_varlogaudit_partition
    :title: Ensure nodev option set on /var/log/audit partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /var/log/audit filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log/audit .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /var/log/audit filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log/audit .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.6.3_Ensure_nodev_option_set_on_varlogaudit_partition\"
      do\n  title \"Ensure nodev option set on /var/log/audit partition\"\n  desc
      \ \"\n    The nodev mount option specifies that the filesystem cannot contain
      special devices.\n    \n    Rationale: Since the /var/log/audit filesystem is
      not intended to support devices, set this option to ensure that users cannot
      create a block or character special devices in /var/log/audit .\n  \"\n  impact
      1.0\n  describe mount(\"/var/log/audit\") do\n    it { should be_mounted }\n
      \ end\n  describe mount(\"/var/log/audit\") do\n    its(\"options\") { should
      include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 256
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log/audit is expected to be mounted
      :run_time: 0.000170679
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log/audit is not mounted
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
    - :status: failed
      :code_desc: Mount /var/log/audit options is expected to include "nodev"
      :run_time: 0.000158504
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.6.4_Ensure_nosuid_option_set_on_varlogaudit_partition
    :title: Ensure nosuid option set on /var/log/audit partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /var/log/audit filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var/log/audit .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /var/log/audit filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var/log/audit .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.6.4_Ensure_nosuid_option_set_on_varlogaudit_partition\"
      do\n  title \"Ensure nosuid option set on /var/log/audit partition\"\n  desc
      \ \"\n    The nosuid mount option specifies that the filesystem cannot contain
      setuid files.\n    \n    Rationale: Since the /var/log/audit filesystem is only
      intended for variable files such as logs, set this option to ensure that users
      cannot create setuid files in /var/log/audit .\n  \"\n  impact 1.0\n  describe
      mount(\"/var/log/audit\") do\n    it { should be_mounted }\n  end\n  describe
      mount(\"/var/log/audit\") do\n    its(\"options\") { should include \"nosuid\"
      }\n  end\nend\n"
    :source_location:
      :line: 272
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /var/log/audit is expected to be mounted
      :run_time: 0.000116809
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /var/log/audit is not mounted
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
    - :status: failed
      :code_desc: Mount /var/log/audit options is expected to include "nosuid"
      :run_time: 0.000135665
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/var/log/audit"]'
      :resource_id: "/var/log/audit"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.7.2_Ensure_nodev_option_set_on_home_partition
    :title: Ensure nodev option set on /home partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /home filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var .
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /home filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.7.2_Ensure_nodev_option_set_on_home_partition\"
      do\n  title \"Ensure nodev option set on /home partition\"\n  desc  \"\n    The
      nodev mount option specifies that the filesystem cannot contain special devices.\n
      \   \n    Rationale: Since the /home filesystem is not intended to support devices,
      set this option to ensure that users cannot create a block or character special
      devices in /var .\n  \"\n  impact 1.0\n  describe mount(\"/home\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/home\") do\n    its(\"options\")
      { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 288
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /home is expected to be mounted
      :run_time: 0.058532823
      :start_time: '2024-04-04T14:52:30+00:00'
      :message: |2

        Mount /home is not mounted
      :resource_class: mount
      :resource_params: '["/home"]'
      :resource_id: "/home"
    - :status: failed
      :code_desc: Mount /home options is expected to include "nodev"
      :run_time: 0.000259247
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to include "nodev", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/home"]'
      :resource_id: "/home"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.7.3_Ensure_nosuid_option_set_on_home_partition
    :title: Ensure nosuid option set on /home partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Since the /home filesystem is only intended for user file storage, set this option to ensure that users cannot create setuid files in /home .
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Since the /home filesystem is only intended for user file storage, set this option to ensure that users cannot create setuid files in /home .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.7.3_Ensure_nosuid_option_set_on_home_partition\"
      do\n  title \"Ensure nosuid option set on /home partition\"\n  desc  \"\n    The
      nosuid mount option specifies that the filesystem cannot contain setuid files.\n
      \   \n    Rationale: Since the /home filesystem is only intended for user file
      storage, set this option to ensure that users cannot create setuid files in
      /home .\n  \"\n  impact 1.0\n  describe mount(\"/home\") do\n    it { should
      be_mounted }\n  end\n  describe mount(\"/home\") do\n    its(\"options\") {
      should include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 304
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Mount /home is expected to be mounted
      :run_time: 0.000148482
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |2

        Mount /home is not mounted
      :resource_class: mount
      :resource_params: '["/home"]'
      :resource_id: "/home"
    - :status: failed
      :code_desc: Mount /home options is expected to include "nosuid"
      :run_time: 0.000139366
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to include "nosuid", but it does not respond to `include?`
      :resource_class: mount
      :resource_params: '["/home"]'
      :resource_id: "/home"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.8.1_Ensure_devshm_is_a_separate_partition
    :title: Ensure /dev/shm is a separate partition
    :desc: |-
      The /dev/shm directory is a world-writable directory that can function as shared memory that facilitates inter process communication (IPC).

      Rationale: Making /dev/shm its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated. Once the program was updated, the hard link would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.

      This can be accomplished by mounting tmpfs to /dev/shm .
    :descriptions:
    - :label: default
      :data: |-
        The /dev/shm directory is a world-writable directory that can function as shared memory that facilitates inter process communication (IPC).

        Rationale: Making /dev/shm its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated. Once the program was updated, the hard link would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.

        This can be accomplished by mounting tmpfs to /dev/shm .
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.8.1_Ensure_devshm_is_a_separate_partition\"
      do\n  title \"Ensure /dev/shm is a separate partition\"\n  desc  \"\n    The
      /dev/shm directory is a world-writable directory that can function as shared
      memory that facilitates inter process communication (IPC).\n    \n    Rationale:
      Making /dev/shm its own file system allows an administrator to set additional
      mount options such as the noexec option on the mount, making /dev/shm useless
      for an attacker to install executable code. It would also prevent an attacker
      from establishing a hard link to a system setuid program and wait for it to
      be updated. Once the program was updated, the hard link would be broken and
      the attacker would have his own copy of the program. If the program happened
      to have a security vulnerability, the attacker could continue to exploit the
      known flaw.\n    \n    This can be accomplished by mounting tmpfs to /dev/shm
      .\n  \"\n  impact 1.0\n  describe mount(\"/dev/shm\") do\n    it { should be_mounted
      }\n  end\nend\n"
    :source_location:
      :line: 320
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Mount /dev/shm is expected to be mounted
      :run_time: 0.058613194
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.8.2_Ensure_nodev_option_set_on_devshm_partition
    :title: Ensure nodev option set on /dev/shm partition
    :desc: |-
      The nodev mount option specifies that the filesystem cannot contain special devices.

      Rationale: Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.
    :descriptions:
    - :label: default
      :data: |-
        The nodev mount option specifies that the filesystem cannot contain special devices.

        Rationale: Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.8.2_Ensure_nodev_option_set_on_devshm_partition\"
      do\n  title \"Ensure nodev option set on /dev/shm partition\"\n  desc  \"\n
      \   The nodev mount option specifies that the filesystem cannot contain special
      devices.\n    \n    Rationale: Since the /dev/shm filesystem is not intended
      to support devices, set this option to ensure that users cannot attempt to create
      special devices in /dev/shm partitions.\n  \"\n  impact 1.0\n  describe mount(\"/dev/shm\")
      do\n    it { should be_mounted }\n  end\n  describe mount(\"/dev/shm\") do\n
      \   its(\"options\") { should include \"nodev\" }\n  end\nend\n"
    :source_location:
      :line: 335
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Mount /dev/shm is expected to be mounted
      :run_time: 0.000174837
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
    - :status: passed
      :code_desc: Mount /dev/shm options is expected to include "nodev"
      :run_time: 0.000206108
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.8.3_Ensure_noexec_option_set_on_devshm_partition
    :title: Ensure noexec option set on /dev/shm partition
    :desc: |-
      The noexec mount option specifies that the filesystem cannot contain executable binaries.

      Rationale: Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.
    :descriptions:
    - :label: default
      :data: |-
        The noexec mount option specifies that the filesystem cannot contain executable binaries.

        Rationale: Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.8.3_Ensure_noexec_option_set_on_devshm_partition\"
      do\n  title \"Ensure noexec option set on /dev/shm partition\"\n  desc  \"\n
      \   The noexec mount option specifies that the filesystem cannot contain executable
      binaries.\n    \n    Rationale: Setting this option on a file system prevents
      users from executing programs from shared memory. This deters users from introducing
      potentially malicious software on the system.\n  \"\n  impact 1.0\n  describe
      mount(\"/dev/shm\") do\n    it { should be_mounted }\n  end\n  describe mount(\"/dev/shm\")
      do\n    its(\"options\") { should include \"noexec\" }\n  end\nend\n"
    :source_location:
      :line: 351
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Mount /dev/shm is expected to be mounted
      :run_time: 0.000106973
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
    - :status: failed
      :code_desc: Mount /dev/shm options is expected to include "noexec"
      :run_time: 0.000266711
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected ["rw", "nosuid", "nodev", "seclabel", "inode64"] to include
        "noexec"
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.1.8.4_Ensure_nosuid_option_set_on_devshm_partition
    :title: Ensure nosuid option set on /dev/shm partition
    :desc: |-
      The nosuid mount option specifies that the filesystem cannot contain setuid files.

      Rationale: Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.
    :descriptions:
    - :label: default
      :data: |-
        The nosuid mount option specifies that the filesystem cannot contain setuid files.

        Rationale: Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.1.8.4_Ensure_nosuid_option_set_on_devshm_partition\"
      do\n  title \"Ensure nosuid option set on /dev/shm partition\"\n  desc  \"\n
      \   The nosuid mount option specifies that the filesystem cannot contain setuid
      files.\n    \n    Rationale: Setting this option on a file system prevents users
      from introducing privileged programs onto the system and allowing non-root users
      to execute them.\n  \"\n  impact 1.0\n  describe mount(\"/dev/shm\") do\n    it
      { should be_mounted }\n  end\n  describe mount(\"/dev/shm\") do\n    its(\"options\")
      { should include \"nosuid\" }\n  end\nend\n"
    :source_location:
      :line: 367
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Mount /dev/shm is expected to be mounted
      :run_time: 0.000117705
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
    - :status: passed
      :code_desc: Mount /dev/shm options is expected to include "nosuid"
      :run_time: 0.000137064
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: mount
      :resource_params: '["/dev/shm"]'
      :resource_id: "/dev/shm"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_GPG_keys_are_configured
    :title: Ensure GPG keys are configured
    :desc: |-
      The RPM Package Manager implements GPG key signing to verify package integrity during and after installation.

      Rationale: It is important to ensure that updates are obtained from a valid source to protect against spoofing that could lead to the inadvertent installation of malware on the system. To this end, verify that GPG keys are configured correctly for your system.
    :descriptions:
    - :label: default
      :data: |-
        The RPM Package Manager implements GPG key signing to verify package integrity during and after installation.

        Rationale: It is important to ensure that updates are obtained from a valid source to protect against spoofing that could lead to the inadvertent installation of malware on the system. To this end, verify that GPG keys are configured correctly for your system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_GPG_keys_are_configured\"
      do\n  title \"Ensure GPG keys are configured\"\n  desc  \"\n    The RPM Package
      Manager implements GPG key signing to verify package integrity during and after
      installation.\n    \n    Rationale: It is important to ensure that updates are
      obtained from a valid source to protect against spoofing that could lead to
      the inadvertent installation of malware on the system. To this end, verify that
      GPG keys are configured correctly for your system.\n  \"\n  impact 0.0\n  gpg_keys
      = command(\"rpm -qa gpg-pubkey*\").stdout.split\n  describe gpg_keys do\n    it
      { should_not be_empty }\n  end\n  gpg_keys.each do |key|\n    describe key do\n
      \     it { should match(/^\\s*gpg-pubkey-[A-Za-z0-9]+-[A-Za-z0-9]+(\\s+#.*)?$/)
      }\n    end\n  end\n  files = command(\"find /etc/yum.repos.d -type f -regex
      .\\\\*/.\\\\*\").stdout.split\n  describe files.delete_if { |f| command(\"file
      #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/ || file(f).content
      !~ /^\\s*gpgkey\\s*=\\s*.*$/ } do\n    it { should_not be_empty }\n  end\n  describe
      file(\"/etc/dnf/dnf.conf\") do\n    its(\"content\") { should match(/^\\s*gpgkey\\s*=\\s*.*$/)
      }\n  end\nend\n"
    :source_location:
      :line: 383
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: '["gpg-pubkey-fd431d51-4ae0493b", "gpg-pubkey-5a6340b3-6229229e",
        "gpg-pubkey-f21541eb-4a5233e7"] is expected not to be empty'
      :run_time: 0.006298164
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: gpg-pubkey-fd431d51-4ae0493b is expected to match /^\s*gpg-pubkey-[A-Za-z0-9]+-[A-Za-z0-9]+(\s+#.*)?$/
      :run_time: 0.000120294
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: gpg-pubkey-fd431d51-4ae0493b
    - :status: passed
      :code_desc: gpg-pubkey-5a6340b3-6229229e is expected to match /^\s*gpg-pubkey-[A-Za-z0-9]+-[A-Za-z0-9]+(\s+#.*)?$/
      :run_time: 6.9957e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: gpg-pubkey-5a6340b3-6229229e
    - :status: passed
      :code_desc: gpg-pubkey-f21541eb-4a5233e7 is expected to match /^\s*gpg-pubkey-[A-Za-z0-9]+-[A-Za-z0-9]+(\s+#.*)?$/
      :run_time: 6.5873e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: gpg-pubkey-f21541eb-4a5233e7
    - :status: passed
      :code_desc: '["/etc/yum.repos.d/redhat-rhui-beta.repo.disabled", "/etc/yum.repos.d/redhat-rhui-eus.repo.disabled",
        "/etc/yum.repos.d/redhat-rhui.repo", "/etc/yum.repos.d/redhat-rhui-client-config.repo"]
        is expected not to be empty'
      :run_time: 0.002347299
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: File /etc/dnf/dnf.conf content is expected to match /^\s*gpgkey\s*=\s*.*$/
      :run_time: 0.048265459
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "[main]\ngpgcheck=1\ninstallonly_limit=3\nclean_requirements_on_remove=True\nbest=True\nskip_if_unavailable=False\n" to match /^\s*gpgkey\s*=\s*.*$/
        Diff:
        @@ -1,6 +1,11 @@
        -/^\s*gpgkey\s*=\s*.*$/
        +[main]
        +gpgcheck=1
        +installonly_limit=3
        +clean_requirements_on_remove=True
        +best=True
        +skip_if_unavailable=False
      :resource_class: file
      :resource_params: '["/etc/dnf/dnf.conf"]'
      :resource_id: "/etc/dnf/dnf.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_gpgcheck_is_globally_activated
    :title: Ensure gpgcheck is globally activated
    :desc: |-
      The gpgcheck option, found in the main section of the /etc/dnf/dnf.conf and individual /etc/yum.repos.d/* files, determines if an RPM package's signature is checked prior to its installation.

      Rationale: It is important to ensure that an RPM's package signature is always checked prior to installation to ensure that the software is obtained from a trusted source.
    :descriptions:
    - :label: default
      :data: |-
        The gpgcheck option, found in the main section of the /etc/dnf/dnf.conf and individual /etc/yum.repos.d/* files, determines if an RPM package's signature is checked prior to its installation.

        Rationale: It is important to ensure that an RPM's package signature is always checked prior to installation to ensure that the software is obtained from a trusted source.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_gpgcheck_is_globally_activated\"
      do\n  title \"Ensure gpgcheck is globally activated\"\n  desc  \"\n    The gpgcheck
      option, found in the main section of the /etc/dnf/dnf.conf and individual /etc/yum.repos.d/*
      files, determines if an RPM package's signature is checked prior to its installation.\n
      \   \n    Rationale: It is important to ensure that an RPM's package signature
      is always checked prior to installation to ensure that the software is obtained
      from a trusted source.\n  \"\n  impact 1.0\n  files = command(\"find /etc/yum.repos.d/
      -type f -regex .\\\\*/.\\\\*\").stdout.split\n  describe files.delete_if { |f|
      command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/ ||
      file(f).content =~ /^\\s*gpgcheck\\s*=\\s*1\\s*(\\s+#.*)?$/ || file(f).content
      !~ /^\\s*gpgcheck\\s*=\\s*[0-9]+\\s*(\\s+#.*)?$/ } do\n    it { should be_empty
      }\n  end\n  describe file(\"/etc/dnf/dnf.conf\") do\n    its(\"content\") {
      should match(/^\\s*gpgcheck\\s*=\\s*1\\s*(\\s+#.*)?$/) }\n  end\n  describe
      file(\"/etc/dnf/dnf.conf\") do\n    its(\"content\") { should_not match(/^\\s*gpgcheck\\s*=\\s*[^1]\\s*(\\s+#.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 409
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002495382
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: File /etc/dnf/dnf.conf content is expected to match /^\s*gpgcheck\s*=\s*1\s*(\s+#.*)?$/
      :run_time: 0.000122808
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/etc/dnf/dnf.conf"]'
      :resource_id: "/etc/dnf/dnf.conf"
    - :status: passed
      :code_desc: File /etc/dnf/dnf.conf content is expected not to match /^\s*gpgcheck\s*=\s*[^1]\s*(\s+#.*)?$/
      :run_time: 9.5045e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/etc/dnf/dnf.conf"]'
      :resource_id: "/etc/dnf/dnf.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_package_manager_repositories_are_configured
    :title: Ensure package manager repositories are configured
    :desc: |-
      Systems need to have the respective package manager repositories configured to ensure that the system is able to receive the latest patches and updates.

      Rationale: If a system's package repositories are misconfigured, important patches may not be identified or a rogue repository could introduce compromised software.
    :descriptions:
    - :label: default
      :data: |-
        Systems need to have the respective package manager repositories configured to ensure that the system is able to receive the latest patches and updates.

        Rationale: If a system's package repositories are misconfigured, important patches may not be identified or a rogue repository could introduce compromised software.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_package_manager_repositories_are_configured\"
      do\n  title \"Ensure package manager repositories are configured\"\n  desc  \"\n
      \   Systems need to have the respective package manager repositories configured
      to ensure that the system is able to receive the latest patches and updates.\n
      \   \n    Rationale: If a system's package repositories are misconfigured, important
      patches may not be identified or a rogue repository could introduce compromised
      software.\n  \"\n  impact 0.0\n  describe \"Ensure package manager repositories
      are configured\" do\n    skip \"Run the following command 'dnf repolist' to
      verify repositories are configured correctly\"\n  end\nend\n"
    :source_location:
      :line: 429
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure package manager repositories are configured
      :run_time: 1.2404e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource: ''
      :skip_message: Run the following command 'dnf repolist' to verify repositories
        are configured correctly
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure package manager repositories are configured
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_AIDE_is_installed
    :title: Ensure AIDE is installed
    :desc: |-
      Advanced Intrusion Detection Environment (AIDE) is a intrusion detection tool that uses predefined rules to check the integrity of files and directories in the Linux operating system. AIDE has its own database to check the integrity of files and directories.

      AIDE takes a snapshot of files and directories including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.

      Rationale: By monitoring the filesystem state compromised files can be detected to prevent or limit the exposure of accidental or malicious misconfigurations or modified binaries.
    :descriptions:
    - :label: default
      :data: |-
        Advanced Intrusion Detection Environment (AIDE) is a intrusion detection tool that uses predefined rules to check the integrity of files and directories in the Linux operating system. AIDE has its own database to check the integrity of files and directories.

        AIDE takes a snapshot of files and directories including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.

        Rationale: By monitoring the filesystem state compromised files can be detected to prevent or limit the exposure of accidental or malicious misconfigurations or modified binaries.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_AIDE_is_installed\"
      do\n  title \"Ensure AIDE is installed\"\n  desc  \"\n    Advanced Intrusion
      Detection Environment (AIDE) is a intrusion detection tool that uses predefined
      rules to check the integrity of files and directories in the Linux operating
      system. AIDE has its own database to check the integrity of files and directories.\n
      \   \n    AIDE takes a snapshot of files and directories including modification
      times, permissions, and file hashes which can then be used to compare against
      the current state of the filesystem to detect modifications to the system.\n
      \   \n    Rationale: By monitoring the filesystem state compromised files can
      be detected to prevent or limit the exposure of accidental or malicious misconfigurations
      or modified binaries.\n  \"\n  impact 1.0\n  describe package(\"aide\") do\n
      \   it { should be_installed }\n  end\nend\n"
    :source_location:
      :line: 442
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: System Package aide is expected to be installed
      :run_time: 0.061125754
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected that `System Package aide` is installed
      :resource_class: package
      :resource_params: '["aide"]'
      :resource_id: aide
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_filesystem_integrity_is_regularly_checked
    :title: Ensure filesystem integrity is regularly checked
    :desc: |-
      Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.

      Rationale: Periodic file checking allows the system administrator to determine on a regular basis if critical files have been changed in an unauthorized fashion.
    :descriptions:
    - :label: default
      :data: |-
        Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.

        Rationale: Periodic file checking allows the system administrator to determine on a regular basis if critical files have been changed in an unauthorized fashion.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_filesystem_integrity_is_regularly_checked\"
      do\n  title \"Ensure filesystem integrity is regularly checked\"\n  desc  \"\n
      \   Periodic checking of the filesystem integrity is needed to detect changes
      to the filesystem.\n    \n    Rationale: Periodic file checking allows the system
      administrator to determine on a regular basis if critical files have been changed
      in an unauthorized fashion.\n  \"\n  impact 1.0\n  if service('aidecheck.service').enabled?
      && service('aidecheck.timer').enabled?\n    describe service('aidecheck.service')
      do\n      it { should be_enabled }\n    end\n    describe service('aidecheck.timer')
      do\n      it { should be_enabled }\n      it { should be_running }\n    end\n
      \ else\n    describe.one do\n      describe crontab do\n        its('commands')
      { should include '/usr/sbin/aide --check' }\n      end\n      command(\"find
      /etc/cron.* /etc/crontab /var/spool/cron/ -type f\").stdout.split(\"\\n\").each
      do |f|\n        describe file(f) do\n          its('content') { should include
      'aide --check'}\n        end\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 457
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: crontab for current user commands is expected to include "/usr/sbin/aide
        --check"
      :run_time: 0.000400582
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected [] to include "/usr/sbin/aide --check"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: crontab
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: File /etc/cron.d/0hourly content is expected to include "aide --check"
      :run_time: 0.00031597
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "# Run the hourly jobs\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n01 * * * * root run-parts /etc/cron.hourly\n" to include "aide --check"
        Diff:
        @@ -1,5 +1,9 @@
        -aide --check
        +# Run the hourly jobs
        +SHELL=/bin/bash
        +PATH=/sbin:/bin:/usr/sbin:/usr/bin
        +MAILTO=root
        +01 * * * * root run-parts /etc/cron.hourly
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/cron.d/0hourly"]'
      :resource_id: "/etc/cron.d/0hourly"
    - :status: failed
      :code_desc: File /etc/cron.daily/update-client-config-packages content is expected
        to include "aide --check"
      :run_time: 0.000243933
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "#!/usr/bin/bash\n\nTOKEN=$(curl -s -X PUT \"http://169.254.169.254/latest/api/token\" -H \"X-aws-ec2...[[ $region =~ gov ]] && exit\n\nyum -q -y --disablerepo=* --enablerepo=rhui-client-config* update\n" to include "aide --check"
        Diff:
        @@ -1,7 +1,13 @@
        -aide --check
        +#!/usr/bin/bash
        +
        +TOKEN=$(curl -s -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600")
        +region=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/placement/region)
        +[[ $region =~ gov ]] && exit
        +
        +yum -q -y --disablerepo=* --enablerepo=rhui-client-config* update
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/cron.daily/update-client-config-packages"]'
      :resource_id: "/etc/cron.daily/update-client-config-packages"
    - :status: failed
      :code_desc: File /etc/cron.deny content is expected to include "aide --check"
      :run_time: 0.000132311
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected "" to include "aide --check"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/cron.deny"]'
      :resource_id: "/etc/cron.deny"
    - :status: failed
      :code_desc: File /etc/cron.hourly/0anacron content is expected to include "aide
        --check"
      :run_time: 0.000430023
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "#!/usr/bin/sh\n# Check whether 0anacron was run today already\nif test -r /var/spool/anacron/cron.da...nline=0\n        fi\n    fi\ndone\nif [ $online = 0 ]; then\n    exit 0\nfi\n/usr/sbin/anacron -s\n" to include "aide --check"
        Diff:
        @@ -1,25 +1,49 @@
        -aide --check
        +#!/usr/bin/sh
        +# Check whether 0anacron was run today already
        +if test -r /var/spool/anacron/cron.daily; then
        +    day=`cat /var/spool/anacron/cron.daily`
        +fi
        +if [ `date +%Y%m%d` = "$day" ]; then
        +    exit 0
        +fi
        +
        +# Do not run jobs when on battery power
        +online=1
        +for psupply in /sys/class/power_supply/* ; do
        +    if [ `cat "$psupply/type" 2>/dev/null`x = Mainsx ] && [ -f "$psupply/online" ]; then
        +        if [ `cat "$psupply/online" 2>/dev/null`x = 1x ]; then
        +            online=1
        +            break
        +        else
        +            online=0
        +        fi
        +    fi
        +done
        +if [ $online = 0 ]; then
        +    exit 0
        +fi
        +/usr/sbin/anacron -s
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/cron.hourly/0anacron"]'
      :resource_id: "/etc/cron.hourly/0anacron"
    - :status: failed
      :code_desc: File /etc/crontab content is expected to include "aide --check"
      :run_time: 0.000295877
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "SHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n\n# For details see man 4 crontabs...sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name  command to be executed\n\n" to include "aide --check"
        Diff:
        @@ -1,14 +1,27 @@
        -aide --check
        +SHELL=/bin/bash
        +PATH=/sbin:/bin:/usr/sbin:/usr/bin
        +MAILTO=root
        +
        +# For details see man 4 crontabs
        +
        +# Example of job definition:
        +# .---------------- minute (0 - 59)
        +# |  .------------- hour (0 - 23)
        +# |  |  .---------- day of month (1 - 31)
        +# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
        +# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
        +# |  |  |  |  |
        +# *  *  *  *  * user-name  command to be executed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_cryptographic_mechanisms_are_used_to_protect_the_integrity_of_audit_tools
    :title: Ensure cryptographic mechanisms are used to protect the integrity of audit
      tools
    :desc: |-
      Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.

      Rationale: Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.

      Attackers may replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.

      Audit tools should be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.
    :descriptions:
    - :label: default
      :data: |-
        Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.

        Rationale: Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.

        Attackers may replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.

        Audit tools should be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_cryptographic_mechanisms_are_used_to_protect_the_integrity_of_audit_tools\"
      do\n  title \"Ensure cryptographic mechanisms are used to protect the integrity
      of audit tools\"\n  desc  \"\n    Audit tools include, but are not limited to,
      vendor-provided and open source audit tools needed to successfully view and
      manipulate audit information system activity and records. Audit tools include
      custom queries and report generators.\n    \n    Rationale: Protecting the integrity
      of the tools used for auditing purposes is a critical step toward ensuring the
      integrity of audit information. Audit information includes all information (e.g.,
      audit records, audit settings, and audit reports) needed to successfully audit
      information system activity.\n    \n    Attackers may replace the audit tools
      or inject code into the existing tools with the purpose of providing the capability
      to hide or erase system activity from the audit logs.\n    \n    Audit tools
      should be cryptographically signed in order to provide the capability to identify
      when the audit tools have been modified, manipulated, or replaced. An example
      is a checksum hash of the file or files.\n  \"\n  impact 1.0\n  describe.one
      do\n    describe file(\"/etc/aide.conf\") do\n      its(\"content\") { should
      match(/^\\s*\\/sbin\\/auditctl\\s+p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      its(\"content\") { should match(/^\\s*\\/sbin\\/auditd p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      its(\"content\") { should match(/^\\s*\\/sbin\\/ausearch p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      its(\"content\") { should match(/^\\s*\\/sbin\\/aureport p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      its(\"content\") { should match(/^\\s*\\/sbin\\/autrace p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      its(\"content\") { should match(/^\\s*\\/sbin\\/augenrules p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n    end\n    command(\"find /etc/aide.conf.d/*.conf -type f\").stdout.split(\"\\n\").each
      do |f|\n      describe file(f) do\n        its(\"content\") { should match(/^\\s*\\/sbin\\/auditctl\\s+p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n        its(\"content\") { should match(/^\\s*\\/sbin\\/auditd p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n        its(\"content\") { should match(/^\\s*\\/sbin\\/ausearch p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n        its(\"content\") { should match(/^\\s*\\/sbin\\/aureport p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n        its(\"content\") { should match(/^\\s*\\/sbin\\/autrace p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n        its(\"content\") { should match(/^\\s*\\/sbin\\/augenrules p\\+i\\+n\\+u\\+g\\+s\\+b\\+acl\\+xattrs\\+sha512\\s*/)
      }\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 487
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/auditctl\s+p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 0.000178905
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/auditctl\s+p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/auditd
        p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 0.000112596
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/auditd p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/ausearch
        p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 0.000102544
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/ausearch p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/aureport
        p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 0.00010172
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/aureport p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/autrace
        p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 9.8961e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/autrace p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
    - :status: failed
      :code_desc: File /etc/aide.conf content is expected to match /^\s*\/sbin\/augenrules
        p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :run_time: 0.000109199
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*\/sbin\/augenrules p\+i\+n\+u\+g\+s\+b\+acl\+xattrs\+sha512\s*/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/aide.conf"]'
      :resource_id: "/etc/aide.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_bootloader_password_is_set
    :title: Ensure bootloader password is set
    :desc: |-
      Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters.

      Rationale: Requiring a boot password upon execution of the boot loader will prevent an unauthorized user from entering boot parameters or changing the boot partition. This prevents users from weakening security (e.g. turning off SELinux at boot time).
    :descriptions:
    - :label: default
      :data: |-
        Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters.

        Rationale: Requiring a boot password upon execution of the boot loader will prevent an unauthorized user from entering boot parameters or changing the boot partition. This prevents users from weakening security (e.g. turning off SELinux at boot time).
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_bootloader_password_is_set\"
      do\n  title \"Ensure bootloader password is set\"\n  desc  \"\n    Setting the
      boot loader password will require that anyone rebooting the system must enter
      a password before being able to set command line boot parameters.\n    \n    Rationale:
      Requiring a boot password upon execution of the boot loader will prevent an
      unauthorized user from entering boot parameters or changing the boot partition.
      This prevents users from weakening security (e.g. turning off SELinux at boot
      time).\n  \"\n  impact 1.0\n  describe file(\"/boot/grub2/user.cfg\") do\n    its(\"content\")
      { should match(/^\\s*GRUB2_PASSWORD=\\s*.+$/) }\n  end\nend\n"
    :source_location:
      :line: 521
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /boot/grub2/user.cfg content is expected to match /^\s*GRUB2_PASSWORD=\s*.+$/
      :run_time: 0.114083661
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected nil to match /^\s*GRUB2_PASSWORD=\s*.+$/
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.4.2_Ensure_permissions_on_bootloader_config_are_configured
    :title: Ensure permissions on bootloader config are configured
    :desc: |-
      The grub files contain information on boot settings and passwords for unlocking boot options.

      Rationale: Setting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.
    :descriptions:
    - :label: default
      :data: |-
        The grub files contain information on boot settings and passwords for unlocking boot options.

        Rationale: Setting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.4.2_Ensure_permissions_on_bootloader_config_are_configured\"
      do\n  title \"Ensure permissions on bootloader config are configured\"\n  desc
      \ \"\n    The grub files contain information on boot settings and passwords
      for unlocking boot options.\n    \n    Rationale: Setting the permissions to
      read and write for root only prevents non-root users from seeing the boot parameters
      or changing them. Non-root users who read the boot parameters may be able to
      identify weaknesses in security upon boot and be able to exploit them.\n  \"\n
      \ impact 1.0\n  describe file(\"/boot/grub2/grub.cfg\") do\n    it { should
      exist }\n    it { should_not be_executable.by \"group\" }\n    it { should_not
      be_readable.by \"group\" }\n    it { should_not be_writable.by \"group\" }\n
      \   its(\"gid\") { should cmp 0 }\n    it { should_not be_executable.by \"other\"
      }\n    it { should_not be_readable.by \"other\" }\n    it { should_not be_writable.by
      \"other\" }\n    its(\"uid\") { should cmp 0 }\n  end\n  describe file(\"/boot/grub2/grubenv\")
      do\n    it { should exist }\n    it { should_not be_executable.by \"group\"
      }\n    it { should_not be_readable.by \"group\" }\n    it { should_not be_writable.by
      \"group\" }\n    its(\"gid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"other\" }\n    it { should_not be_readable.by \"other\" }\n    it { should_not
      be_writable.by \"other\" }\n    its(\"uid\") { should cmp 0 }\n    it { should_not
      be_executable.by \"owner\" }\n  end\n  describe file(\"/boot/grub2/user.cfg\")
      do\n    it { should exist }\n    it { should_not be_executable.by \"group\"
      }\n    it { should_not be_readable.by \"group\" }\n    it { should_not be_writable.by
      \"group\" }\n    its(\"gid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"other\" }\n    it { should_not be_readable.by \"other\" }\n    it { should_not
      be_writable.by \"other\" }\n    its(\"uid\") { should cmp 0 }\n    it { should_not
      be_executable.by \"owner\" }\n  end\nend\n"
    :source_location:
      :line: 534
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /boot/grub2/grub.cfg is expected to exist
      :run_time: 0.058306334
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected File /boot/grub2/grub.cfg to exist
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be executable by group
      :run_time: 0.000230822
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be readable by group
      :run_time: 0.000104235
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be writable by group
      :run_time: 9.7808e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be executable by other
      :run_time: 9.0421e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be readable by other
      :run_time: 0.000200509
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/grub.cfg is expected not to be writable by other
      :run_time: 9.2344e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: failed
      :code_desc: File /boot/grub2/grub.cfg gid is expected to cmp == 0
      :run_time: 0.05886379
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: failed
      :code_desc: File /boot/grub2/grub.cfg uid is expected to cmp == 0
      :run_time: 0.0002478
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/grub.cfg"]'
      :resource_id: "/boot/grub2/grub.cfg"
    - :status: failed
      :code_desc: File /boot/grub2/grubenv is expected to exist
      :run_time: 0.057300642
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected File /boot/grub2/grubenv to exist
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be executable by group
      :run_time: 0.000279344
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be readable by group
      :run_time: 0.000113994
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be writable by group
      :run_time: 9.6739e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be executable by other
      :run_time: 8.9756e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be readable by other
      :run_time: 0.00020169
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be writable by other
      :run_time: 9.3814e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: passed
      :code_desc: File /boot/grub2/grubenv is expected not to be executable by owner
      :run_time: 0.000104621
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: failed
      :code_desc: File /boot/grub2/grubenv gid is expected to cmp == 0
      :run_time: 0.057673475
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: failed
      :code_desc: File /boot/grub2/grubenv uid is expected to cmp == 0
      :run_time: 0.000365416
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/grubenv"]'
      :resource_id: "/boot/grub2/grubenv"
    - :status: failed
      :code_desc: File /boot/grub2/user.cfg is expected to exist
      :run_time: 0.057570649
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected File /boot/grub2/user.cfg to exist
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be executable by group
      :run_time: 0.000229698
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be readable by group
      :run_time: 0.000103324
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be writable by group
      :run_time: 9.7309e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be executable by other
      :run_time: 0.000105931
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be readable by other
      :run_time: 9.2654e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be writable by other
      :run_time: 8.9458e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: passed
      :code_desc: File /boot/grub2/user.cfg is expected not to be executable by owner
      :run_time: 8.6699e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: failed
      :code_desc: File /boot/grub2/user.cfg gid is expected to cmp == 0
      :run_time: 0.000193761
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
    - :status: failed
      :code_desc: File /boot/grub2/user.cfg uid is expected to cmp == 0
      :run_time: 0.000145625
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/boot/grub2/user.cfg"]'
      :resource_id: "/boot/grub2/user.cfg"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_core_dump_storage_is_disabled
    :title: Ensure core dump storage is disabled
    :desc: |-
      A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file.

      Rationale: A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.
    :descriptions:
    - :label: default
      :data: |-
        A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file.

        Rationale: A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_core_dump_storage_is_disabled\"
      do\n  title \"Ensure core dump storage is disabled\"\n  desc  \"\n    A core
      dump is the memory of an executable program. It is generally used to determine
      why a program aborted. It can also be used to glean confidential information
      from a core file.\n    \n    Rationale: A core dump includes a memory image
      taken at the time the operating system terminates an application. The memory
      image could contain sensitive data and is generally useful only for developers
      trying to debug problems.\n  \"\n  impact 1.0\n  describe file(\"/etc/systemd/coredump.conf\")
      do\n    its(\"content\") { should match(/(?i)^\\h*storage\\h*=\\h*none\\b/)
      }\n  end\nend\n"
    :source_location:
      :line: 579
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/systemd/coredump.conf content is expected to match /(?i)^\h*storage\h*=\h*none\b/
      :run_time: 0.057567384
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or mod...Compress=yes\n#ProcessSizeMax=2G\n#ExternalSizeMax=2G\n#JournalSizeMax=767M\n#MaxUse=\n#KeepFree=\n" to match /(?i)^\h*storage\h*=\h*none\b/
        Diff:
        @@ -1,24 +1,47 @@
        -/(?i)^\h*storage\h*=\h*none\b/
        +#  This file is part of systemd.
        +#
        +#  systemd is free software; you can redistribute it and/or modify it under the
        +#  terms of the GNU Lesser General Public License as published by the Free
        +#  Software Foundation; either version 2.1 of the License, or (at your option)
        +#  any later version.
        +#
        +# Entries in this file show the compile time defaults. Local configuration
        +# should be created by either modifying this file, or by creating "drop-ins" in
        +# the coredump.conf.d/ subdirectory. The latter is generally recommended.
        +# Defaults can be restored by simply deleting this file and all drop-ins.
        +#
        +# Use 'systemd-analyze cat-config systemd/coredump.conf' to display the full config.
        +#
        +# See coredump.conf(5) for details.
        +
        +[Coredump]
        +#Storage=external
        +#Compress=yes
        +#ProcessSizeMax=2G
        +#ExternalSizeMax=2G
        +#JournalSizeMax=767M
        +#MaxUse=
        +#KeepFree=
      :resource_class: file
      :resource_params: '["/etc/systemd/coredump.conf"]'
      :resource_id: "/etc/systemd/coredump.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.5.2_Ensure_core_dump_backtraces_are_disabled
    :title: Ensure core dump backtraces are disabled
    :desc: |-
      A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file.

      Rationale: A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems, increasing the risk to the system.
    :descriptions:
    - :label: default
      :data: |-
        A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file.

        Rationale: A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems, increasing the risk to the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.5.2_Ensure_core_dump_backtraces_are_disabled\"
      do\n  title \"Ensure core dump backtraces are disabled\"\n  desc  \"\n    A
      core dump is the memory of an executable program. It is generally used to determine
      why a program aborted. It can also be used to glean confidential information
      from a core file.\n    \n    Rationale: A core dump includes a memory image
      taken at the time the operating system terminates an application. The memory
      image could contain sensitive data and is generally useful only for developers
      trying to debug problems, increasing the risk to the system.\n  \"\n  impact
      1.0\n  describe file(\"/etc/systemd/coredump.conf\") do\n    its(\"content\")
      { should match(/(?i)\\h*ProcessSizeMax\\h*=\\h*0\\b/) }\n  end\nend\n"
    :source_location:
      :line: 592
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/systemd/coredump.conf content is expected to match /(?i)\h*ProcessSizeMax\h*=\h*0\b/
      :run_time: 0.00069483
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or mod...Compress=yes\n#ProcessSizeMax=2G\n#ExternalSizeMax=2G\n#JournalSizeMax=767M\n#MaxUse=\n#KeepFree=\n" to match /(?i)\h*ProcessSizeMax\h*=\h*0\b/
        Diff:
        @@ -1,24 +1,47 @@
        -/(?i)\h*ProcessSizeMax\h*=\h*0\b/
        +#  This file is part of systemd.
        +#
        +#  systemd is free software; you can redistribute it and/or modify it under the
        +#  terms of the GNU Lesser General Public License as published by the Free
        +#  Software Foundation; either version 2.1 of the License, or (at your option)
        +#  any later version.
        +#
        +# Entries in this file show the compile time defaults. Local configuration
        +# should be created by either modifying this file, or by creating "drop-ins" in
        +# the coredump.conf.d/ subdirectory. The latter is generally recommended.
        +# Defaults can be restored by simply deleting this file and all drop-ins.
        +#
        +# Use 'systemd-analyze cat-config systemd/coredump.conf' to display the full config.
        +#
        +# See coredump.conf(5) for details.
        +
        +[Coredump]
        +#Storage=external
        +#Compress=yes
        +#ProcessSizeMax=2G
        +#ExternalSizeMax=2G
        +#JournalSizeMax=767M
        +#MaxUse=
        +#KeepFree=
      :resource_class: file
      :resource_params: '["/etc/systemd/coredump.conf"]'
      :resource_id: "/etc/systemd/coredump.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.5.3_Ensure_address_space_layout_randomization_ASLR_is_enabled
    :title: Ensure address space layout randomization (ASLR) is enabled
    :desc: |-
      Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.

      Rationale: Randomly placing virtual memory regions will make it difficult to write memory page exploits as the memory placement will be consistently shifting.
    :descriptions:
    - :label: default
      :data: |-
        Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.

        Rationale: Randomly placing virtual memory regions will make it difficult to write memory page exploits as the memory placement will be consistently shifting.
    :impact: 1.0
    :refs: []
    :tags:
      :cci: 'CCI-000366: The organization implements the security configuration settings'
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.5.3_Ensure_address_space_layout_randomization_ASLR_is_enabled\"
      do\n  title \"Ensure address space layout randomization (ASLR) is enabled\"\n
      \ desc  \"\n    Address space layout randomization (ASLR) is an exploit mitigation
      technique which randomly arranges the address space of key data areas of a process.\n
      \   \n    Rationale: Randomly placing virtual memory regions will make it difficult
      to write memory page exploits as the memory placement will be consistently shifting.\n
      \ \"\n  impact 1.0\n  tag cci: \"CCI-000366: The organization implements the
      security configuration settings\"\n  describe kernel_parameter(\"kernel.randomize_va_space\")
      do\n    its(\"value\") { should eq 2 }\n  end\n  describe.one do\n    describe
      file(\"/etc/sysctl.conf\") do\n      its(\"content\") { should match(/^\\s*kernel.randomize_va_space\\s*=\\s*2$/)
      }\n    end\n    files = command(\"find /etc/sysctl.d -type f -regex .\\\\*/.\\\\*\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*kernel.randomize_va_space\\s*=\\s*2$/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 605
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter kernel.randomize_va_space value is expected to
        eq 2
      :run_time: 0.057191809
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["kernel.randomize_va_space"]'
      :resource_id: kernel.randomize_va_space
    - :status: failed
      :code_desc: File /etc/sysctl.conf content is expected to match /^\s*kernel.randomize_va_space\s*=\s*2$/
      :run_time: 0.000547634
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: |
        expected "# sysctl settings are defined through files in\n# /usr/lib/sysctl.d/, /run/sysctl.d/, and /etc/sysct...tl.d/ and put new settings there.\n#\n# For more information, see sysctl.conf(5) and sysctl.d(5).\n" to match /^\s*kernel.randomize_va_space\s*=\s*2$/
        Diff:
        @@ -1,10 +1,19 @@
        -/^\s*kernel.randomize_va_space\s*=\s*2$/
        +# sysctl settings are defined through files in
        +# /usr/lib/sysctl.d/, /run/sysctl.d/, and /etc/sysctl.d/.
        +#
        +# Vendors settings live in /usr/lib/sysctl.d/.
        +# To override a whole file, create a new file with the same in
        +# /etc/sysctl.d/ and put new settings there. To override
        +# only specific settings, add a file with a lexically later
        +# name in /etc/sysctl.d/ and put new settings there.
        +#
        +# For more information, see sysctl.conf(5) and sysctl.d(5).
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/sysctl.conf"]'
      :resource_id: "/etc/sysctl.conf"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.00027111
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.1_Ensure_SELinux_is_installed
    :title: Ensure SELinux is installed
    :desc: |-
      SELinux provides Mandatory Access Control.

      Rationale: Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.
    :descriptions:
    - :label: default
      :data: |-
        SELinux provides Mandatory Access Control.

        Rationale: Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.1_Ensure_SELinux_is_installed\"
      do\n  title \"Ensure SELinux is installed\"\n  desc  \"\n    SELinux provides
      Mandatory Access Control.\n    \n    Rationale: Without a Mandatory Access Control
      system installed only the default Discretionary Access Control system will be
      available.\n  \"\n  impact 1.0\n  describe package(\"libselinux\") do\n    it
      { should be_installed }\n  end\nend\n"
    :source_location:
      :line: 628
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package libselinux is expected to be installed
      :run_time: 0.000478534
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: package
      :resource_params: '["libselinux"]'
      :resource_id: libselinux
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.2_Ensure_SELinux_is_not_disabled_in_bootloader_configuration
    :title: Ensure SELinux is not disabled in bootloader configuration
    :desc: |-
      Configure SELINUX to be enabled at boot time and verify that it has not been overwritten by the grub boot parameters.

      Rationale: SELinux must be enabled at boot time in your grub configuration to ensure that the controls it provides are not overridden.
    :descriptions:
    - :label: default
      :data: |-
        Configure SELINUX to be enabled at boot time and verify that it has not been overwritten by the grub boot parameters.

        Rationale: SELinux must be enabled at boot time in your grub configuration to ensure that the controls it provides are not overridden.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.2_Ensure_SELinux_is_not_disabled_in_bootloader_configuration\"
      do\n  title \"Ensure SELinux is not disabled in bootloader configuration\"\n
      \ desc  \"\n    Configure SELINUX to be enabled at boot time and verify that
      it has not been overwritten by the grub boot parameters.\n    \n    Rationale:
      SELinux must be enabled at boot time in your grub configuration to ensure that
      the controls it provides are not overridden.\n  \"\n  impact 1.0\n  describe
      command(\"grubby --info=ALL | grep -Po '(selinux|enforcing)=0'\").stdout do\n
      \   it { should eq \"\" }\n  end\nend\n"
    :source_location:
      :line: 641
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: is expected to eq ""
      :run_time: 0.000102315
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.3_Ensure_SELinux_policy_is_configured
    :title: Ensure SELinux policy is configured
    :desc: |-
      Configure SELinux to meet or exceed the default targeted policy, which constrains daemons and system software only.

      Rationale: Security configuration requirements vary from site to site. Some sites may mandate a policy that is stricter than the default policy, which is perfectly acceptable. This item is intended to ensure that at least the default recommendations are met.
    :descriptions:
    - :label: default
      :data: |-
        Configure SELinux to meet or exceed the default targeted policy, which constrains daemons and system software only.

        Rationale: Security configuration requirements vary from site to site. Some sites may mandate a policy that is stricter than the default policy, which is perfectly acceptable. This item is intended to ensure that at least the default recommendations are met.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.3_Ensure_SELinux_policy_is_configured\"
      do\n  title \"Ensure SELinux policy is configured\"\n  desc  \"\n    Configure
      SELinux to meet or exceed the default targeted policy, which constrains daemons
      and system software only.\n    \n    Rationale: Security configuration requirements
      vary from site to site. Some sites may mandate a policy that is stricter than
      the default policy, which is perfectly acceptable. This item is intended to
      ensure that at least the default recommendations are met.\n  \"\n  impact 1.0\n
      \ only_if { package('libselinux').installed? }\n  describe file('/etc/selinux/config')
      do\n    its('content') { should match(/^\\s*SELINUXTYPE\\s*=\\s*(targeted|mls)\\s*(\\s+#.*)?$/)
      }\n  end\n  describe command('sestatus') do\n    its('stdout') { should match(/^Loaded
      policy name:\\s+(targeted|mls)\\s*(\\s+#.*)?$/) }\n  end\nend\n"
    :source_location:
      :line: 654
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/selinux/config content is expected to match /^\s*SELINUXTYPE\s*=\s*(targeted|mls)\s*(\s+#.*)?$/
      :run_time: 0.057073834
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/etc/selinux/config"]'
      :resource_id: "/etc/selinux/config"
    - :status: passed
      :code_desc: 'Command: `sestatus` stdout is expected to match /^Loaded policy
        name:\s+(targeted|mls)\s*(\s+#.*)?$/'
      :run_time: 0.059852277
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: command
      :resource_params: '["sestatus"]'
      :resource_id: 'Command: `sestatus`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.4_Ensure_the_SELinux_mode_is_not_disabled
    :title: Ensure the SELinux mode is not disabled
    :desc: |-
      SELinux can run in one of three modes: disabled, permissive, or enforcing:

      * Enforcing - Is the default, and recommended, mode of operation; in enforcing mode SELinux operates normally, enforcing the loaded security policy on the entire system.
      * Permissive - The system acts as if SELinux is enforcing the loaded security policy, including labeling objects and emitting access denial entries in the logs, but it does not actually deny any operations. While not recommended for production systems, permissive mode can be helpful for SELinux policy development.
      * Disabled - Is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future
      **Note:** you can set individual domains to permissive mode while the system runs in enforcing mode. For example, to make the httpd_t domain permissive:

      # semanage permissive -a httpd_t

      Rationale: Running SELinux in disabled mode is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future.
    :descriptions:
    - :label: default
      :data: |-
        SELinux can run in one of three modes: disabled, permissive, or enforcing:

        * Enforcing - Is the default, and recommended, mode of operation; in enforcing mode SELinux operates normally, enforcing the loaded security policy on the entire system.
        * Permissive - The system acts as if SELinux is enforcing the loaded security policy, including labeling objects and emitting access denial entries in the logs, but it does not actually deny any operations. While not recommended for production systems, permissive mode can be helpful for SELinux policy development.
        * Disabled - Is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future
        **Note:** you can set individual domains to permissive mode while the system runs in enforcing mode. For example, to make the httpd_t domain permissive:

        # semanage permissive -a httpd_t

        Rationale: Running SELinux in disabled mode is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.4_Ensure_the_SELinux_mode_is_not_disabled\"
      do\n  title \"Ensure the SELinux mode is not disabled\"\n  desc  \"\n    SELinux
      can run in one of three modes: disabled, permissive, or enforcing:\n    \n    *
      Enforcing - Is the default, and recommended, mode of operation; in enforcing
      mode SELinux operates normally, enforcing the loaded security policy on the
      entire system.\n    * Permissive - The system acts as if SELinux is enforcing
      the loaded security policy, including labeling objects and emitting access denial
      entries in the logs, but it does not actually deny any operations. While not
      recommended for production systems, permissive mode can be helpful for SELinux
      policy development.\n    * Disabled - Is strongly discouraged; not only does
      the system avoid enforcing the SELinux policy, it also avoids labeling any persistent
      objects such as files, making it difficult to enable SELinux in the future\n
      \   **Note:** you can set individual domains to permissive mode while the system
      runs in enforcing mode. For example, to make the httpd_t domain permissive:\n
      \   \n    # semanage permissive -a httpd_t\n    \n    Rationale: Running SELinux
      in disabled mode is strongly discouraged; not only does the system avoid enforcing
      the SELinux policy, it also avoids labeling any persistent objects such as files,
      making it difficult to enable SELinux in the future.\n  \"\n  impact 1.0\n  only_if
      { package('libselinux').installed? }\n  describe file(\"/etc/selinux/config\")
      do\n    its(\"content\") { should match(/^\\s*SELINUX\\s*=\\s*(enforcing|permissive)\\s*(\\s+#.*)?$/)
      }\n  end\n  describe command('sestatus') do\n    its('stdout') { should match(/^Current
      mode:\\s+(enforcing|permissive)$/) }\n  end\n  describe command('sestatus')
      do\n    its('stdout') { should match(/^Mode from config file:\\s+(enforcing|permissive)$/)
      }\n  end\nend\n"
    :source_location:
      :line: 671
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/selinux/config content is expected to match /^\s*SELINUX\s*=\s*(enforcing|permissive)\s*(\s+#.*)?$/
      :run_time: 0.000257195
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: file
      :resource_params: '["/etc/selinux/config"]'
      :resource_id: "/etc/selinux/config"
    - :status: passed
      :code_desc: 'Command: `sestatus` stdout is expected to match /^Current mode:\s+(enforcing|permissive)$/'
      :run_time: 9.779e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: command
      :resource_params: '["sestatus"]'
      :resource_id: 'Command: `sestatus`'
    - :status: passed
      :code_desc: 'Command: `sestatus` stdout is expected to match /^Mode from config
        file:\s+(enforcing|permissive)$/'
      :run_time: 8.4023e-05
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: command
      :resource_params: '["sestatus"]'
      :resource_id: 'Command: `sestatus`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.6_Ensure_no_unconfined_services_exist
    :title: Ensure no unconfined services exist
    :desc: |-
      Unconfined processes run in unconfined domains

      Rationale: For unconfined processes, SELinux policy rules are applied, but policy rules exist that allow processes running in unconfined domains almost all access. Processes running in unconfined domains fall back to using DAC rules exclusively. If an unconfined process is compromised, SELinux does not prevent an attacker from gaining access to system resources and data, but of course, DAC rules are still used. SELinux is a security enhancement on top of DAC rules &#x2013; it does not replace them
    :descriptions:
    - :label: default
      :data: |-
        Unconfined processes run in unconfined domains

        Rationale: For unconfined processes, SELinux policy rules are applied, but policy rules exist that allow processes running in unconfined domains almost all access. Processes running in unconfined domains fall back to using DAC rules exclusively. If an unconfined process is compromised, SELinux does not prevent an attacker from gaining access to system resources and data, but of course, DAC rules are still used. SELinux is a security enhancement on top of DAC rules &#x2013; it does not replace them
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.6_Ensure_no_unconfined_services_exist\"
      do\n  title \"Ensure no unconfined services exist\"\n  desc  \"\n    Unconfined
      processes run in unconfined domains\n    \n    Rationale: For unconfined processes,
      SELinux policy rules are applied, but policy rules exist that allow processes
      running in unconfined domains almost all access. Processes running in unconfined
      domains fall back to using DAC rules exclusively. If an unconfined process is
      compromised, SELinux does not prevent an attacker from gaining access to system
      resources and data, but of course, DAC rules are still used. SELinux is a security
      enhancement on top of DAC rules &#x2013; it does not replace them\n  \"\n  impact
      1.0\n  describe command(\"ps -eZ | grep unconfined_service_t\") do\n    its(\"stdout\")
      { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 698
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'Command: `ps -eZ | grep unconfined_service_t` stdout is expected
        to be empty'
      :run_time: 0.069063315
      :start_time: '2024-04-04T14:52:31+00:00'
      :message: expected `"system_u:system_r:unconfined_service_t:s0 1042 ? 00:06:26
        k0s\nsystem_u:system_r:unconfined_service_...0:03:10 kube-scheduler\nsystem_u:system_r:unconfined_service_t:s0
        1548 ? 00:21:18 kube-controller\n".empty?` to be truthy, got false
      :resource_class: command
      :resource_params: '["ps -eZ | grep unconfined_service_t"]'
      :resource_id: 'Command: `ps -eZ | grep unconfined_service_t`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.6.1.8_Ensure_the_MCS_Translation_Service_mcstrans_is_not_installed
    :title: Ensure the MCS Translation Service (mcstrans) is not installed
    :desc: |-
      The mcstransd daemon provides category label information to client processes requesting information. The label translations are defined in /etc/selinux/targeted/setrans.conf

      Rationale: Since this service is not used very often, remove it to reduce the amount of potentially vulnerable code running on the system.
    :descriptions:
    - :label: default
      :data: |-
        The mcstransd daemon provides category label information to client processes requesting information. The label translations are defined in /etc/selinux/targeted/setrans.conf

        Rationale: Since this service is not used very often, remove it to reduce the amount of potentially vulnerable code running on the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.6.1.8_Ensure_the_MCS_Translation_Service_mcstrans_is_not_installed\"
      do\n  title \"Ensure the MCS Translation Service (mcstrans) is not installed\"\n
      \ desc  \"\n    The mcstransd daemon provides category label information to
      client processes requesting information. The label translations are defined
      in /etc/selinux/targeted/setrans.conf\n    \n    Rationale: Since this service
      is not used very often, remove it to reduce the amount of potentially vulnerable
      code running on the system.\n  \"\n  impact 1.0\n  describe package(\"mcstrans\")
      do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 711
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package mcstrans is expected not to be installed
      :run_time: 0.066076967
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: package
      :resource_params: '["mcstrans"]'
      :resource_id: mcstrans
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.1_Ensure_message_of_the_day_is_configured_properly
    :title: Ensure message of the day is configured properly
    :desc: |-
      The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.

      Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version

      Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.

        Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version

        Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.1_Ensure_message_of_the_day_is_configured_properly\"
      do\n  title \"Ensure message of the day is configured properly\"\n  desc  \"\n
      \   The contents of the /etc/motd file are displayed to users after login and
      function as a message of the day for authenticated users.\n    \n    Unix-based
      systems have typically displayed information about the OS release and patch
      level upon logging in to the system. This information can be useful to developers
      who are developing software for a particular OS platform. If mingetty(8) supports
      the following options, they display operating system information: \\\\m - machine
      architecture \\\\r - operating system release \\\\s - operating system name
      \\\\v - operating system version\n    \n    Rationale: Warning messages inform
      users who are attempting to login to the system of their legal status regarding
      the system and must include the name of the organization that owns the system
      and any monitoring policies that are in place. Displaying OS and patch level
      information in login banners also has the side effect of providing detailed
      system information to attackers attempting to target specific exploits of a
      system. Authorized users can easily get this information by running the \\\"
      uname -a \\\" command once they have logged in.\n  \"\n  impact 1.0\n  describe
      command(\"grep -Ei \\\"(\\\\\\\\\\\\v|\\\\\\\\\\\\r|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep
      '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\\\"//g'))\\\" /etc/motd\")
      do\n    its('stdout') { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 724
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/motd` stdout is expected to be empty'
      :run_time: 0.062534679
      :start_time: '2024-04-04T14:52:31+00:00'
      :resource_class: command
      :resource_params: '["grep -Ei \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep ''^ID=''
        /etc/os-release | cut -d= -f2 | sed -e ''s/\"//g''))\" /etc/motd"]'
      :resource_id: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/motd`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.2_Ensure_local_login_warning_banner_is_configured_properly
    :title: Ensure local login warning banner is configured properly
    :desc: |-
      The contents of the /etc/issue file are displayed to users prior to login for local terminals.

      Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version - or the operating system's name

      Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/issue file are displayed to users prior to login for local terminals.

        Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version - or the operating system's name

        Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.2_Ensure_local_login_warning_banner_is_configured_properly\"
      do\n  title \"Ensure local login warning banner is configured properly\"\n  desc
      \ \"\n    The contents of the /etc/issue file are displayed to users prior to
      login for local terminals.\n    \n    Unix-based systems have typically displayed
      information about the OS release and patch level upon logging in to the system.
      This information can be useful to developers who are developing software for
      a particular OS platform. If mingetty(8) supports the following options, they
      display operating system information: \\\\m - machine architecture \\\\r - operating
      system release \\\\s - operating system name \\\\v - operating system version
      - or the operating system's name\n    \n    Rationale: Warning messages inform
      users who are attempting to login to the system of their legal status regarding
      the system and must include the name of the organization that owns the system
      and any monitoring policies that are in place. Displaying OS and patch level
      information in login banners also has the side effect of providing detailed
      system information to attackers attempting to target specific exploits of a
      system. Authorized users can easily get this information by running the \\\"
      uname -a \\\" command once they have logged in.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/issue\") do\n    its(\"content\") { should match(/^.+$/) }\n  end\n
      \ describe command(\"grep -Ei \\\"(\\\\\\\\\\\\v|\\\\\\\\\\\\r|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep
      '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\\\"//g'))\\\" /etc/issue\")
      do\n    its('stdout') { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 739
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/issue content is expected to match /^.+$/
      :run_time: 0.059421189
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: failed
      :code_desc: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/issue` stdout is expected to be
        empty'
      :run_time: 0.061616906
      :start_time: '2024-04-04T14:52:32+00:00'
      :message: expected `"\\S\nKernel \\r on an \\m\n".empty?` to be truthy, got
        false
      :resource_class: command
      :resource_params: '["grep -Ei \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep ''^ID=''
        /etc/os-release | cut -d= -f2 | sed -e ''s/\"//g''))\" /etc/issue"]'
      :resource_id: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/issue`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.3_Ensure_remote_login_warning_banner_is_configured_properly
    :title: Ensure remote login warning banner is configured properly
    :desc: |-
      The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.

      Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version

      Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.

        Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version

        Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.3_Ensure_remote_login_warning_banner_is_configured_properly\"
      do\n  title \"Ensure remote login warning banner is configured properly\"\n
      \ desc  \"\n    The contents of the /etc/issue.net file are displayed to users
      prior to login for remote connections from configured services.\n    \n    Unix-based
      systems have typically displayed information about the OS release and patch
      level upon logging in to the system. This information can be useful to developers
      who are developing software for a particular OS platform. If mingetty(8) supports
      the following options, they display operating system information: \\\\m - machine
      architecture \\\\r - operating system release \\\\s - operating system name
      \\\\v - operating system version\n    \n    Rationale: Warning messages inform
      users who are attempting to login to the system of their legal status regarding
      the system and must include the name of the organization that owns the system
      and any monitoring policies that are in place. Displaying OS and patch level
      information in login banners also has the side effect of providing detailed
      system information to attackers attempting to target specific exploits of a
      system. Authorized users can easily get this information by running the \\\"
      uname -a \\\" command once they have logged in.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/issue.net\") do\n    its(\"content\") { should match(/^.+$/) }\n
      \ end\n  describe command(\"grep -Ei \\\"(\\\\\\\\\\\\v|\\\\\\\\\\\\r|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep
      '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\\\"//g'))\\\" /etc/issue.net\")
      do\n    its('stdout') { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 757
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/issue.net content is expected to match /^.+$/
      :run_time: 0.058909938
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: failed
      :code_desc: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/issue.net` stdout is expected to
        be empty'
      :run_time: 0.062192585
      :start_time: '2024-04-04T14:52:32+00:00'
      :message: expected `"\\S\nKernel \\r on an \\m\n".empty?` to be truthy, got
        false
      :resource_class: command
      :resource_params: '["grep -Ei \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep ''^ID=''
        /etc/os-release | cut -d= -f2 | sed -e ''s/\"//g''))\" /etc/issue.net"]'
      :resource_id: 'Command: `grep -Ei "(\\\v|\\\r|\\\m|\\\s|$(grep ''^ID='' /etc/os-release
        | cut -d= -f2 | sed -e ''s/"//g''))" /etc/issue.net`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.4_Ensure_permissions_on_etcmotd_are_configured
    :title: Ensure permissions on /etc/motd are configured
    :desc: |-
      The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.

      Rationale: If the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.

        Rationale: If the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.4_Ensure_permissions_on_etcmotd_are_configured\"
      do\n  title \"Ensure permissions on /etc/motd are configured\"\n  desc  \"\n
      \   The contents of the /etc/motd file are displayed to users after login and
      function as a message of the day for authenticated users.\n    \n    Rationale:
      If the /etc/motd file does not have the correct ownership it could be modified
      by unauthorized users with incorrect or misleading information.\n  \"\n  impact
      1.0\n  describe.one do\n    describe file(\"/etc/motd\") do\n      it { should
      exist }\n      its(\"gid\") { should cmp 0 }\n      its(\"uid\") { should cmp
      0 }\n      it { should_not be_executable.by \"owner\" }\n      it { should_not
      be_writable.by \"group\" }\n      it { should_not be_executable.by \"group\"
      }\n      it { should_not be_executable.by \"other\" }\n      it { should_not
      be_writable.by \"other\" }\n      it { should_not be_setgid }\n      it { should_not
      be_sticky }\n      it { should_not be_setuid }\n    end\n    describe file(\"/etc/motd\")
      do\n      its(\"content\") { should_not match(/^.*$/) }\n    end\n  end\nend\n"
    :source_location:
      :line: 775
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/motd is expected to exist
      :run_time: 0.000141276
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be executable by owner
      :run_time: 0.000169586
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be writable by group
      :run_time: 0.000105382
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be executable by group
      :run_time: 8.6584e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be executable by other
      :run_time: 8.6389e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be writable by other
      :run_time: 8.7283e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be setgid
      :run_time: 0.00012626
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be sticky
      :run_time: 0.000193828
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd is expected not to be setuid
      :run_time: 8.1677e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd gid is expected to cmp == 0
      :run_time: 0.000145058
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
    - :status: passed
      :code_desc: File /etc/motd uid is expected to cmp == 0
      :run_time: 0.000113368
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/motd"]'
      :resource_id: "/etc/motd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.5_Ensure_permissions_on_etcissue_are_configured
    :title: Ensure permissions on /etc/issue are configured
    :desc: |-
      The contents of the /etc/issue file are displayed to users prior to login for local terminals.

      Rationale: If the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/issue file are displayed to users prior to login for local terminals.

        Rationale: If the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.5_Ensure_permissions_on_etcissue_are_configured\"
      do\n  title \"Ensure permissions on /etc/issue are configured\"\n  desc  \"\n
      \   The contents of the /etc/issue file are displayed to users prior to login
      for local terminals.\n    \n    Rationale: If the /etc/issue file does not have
      the correct ownership it could be modified by unauthorized users with incorrect
      or misleading information.\n  \"\n  impact 1.0\n  describe file(\"/etc/issue\")
      do\n    it { should exist }\n    its(\"gid\") { should cmp 0 }\n    its(\"uid\")
      { should cmp 0 }\n    it { should_not be_executable.by \"owner\" }\n    it {
      should_not be_writable.by \"group\" }\n    it { should_not be_executable.by
      \"group\" }\n    it { should_not be_executable.by \"other\" }\n    it { should_not
      be_writable.by \"other\" }\n    it { should_not be_setgid }\n    it { should_not
      be_sticky }\n    it { should_not be_setuid }\n  end\nend\n"
    :source_location:
      :line: 803
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/issue is expected to exist
      :run_time: 0.05666323
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be executable by owner
      :run_time: 0.05899805
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be writable by group
      :run_time: 0.000231396
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be executable by group
      :run_time: 0.000108231
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be executable by other
      :run_time: 9.3029e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be writable by other
      :run_time: 9.425e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be setgid
      :run_time: 0.006456403
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be sticky
      :run_time: 0.005939253
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue is expected not to be setuid
      :run_time: 0.005993221
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue gid is expected to cmp == 0
      :run_time: 0.000201767
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
    - :status: passed
      :code_desc: File /etc/issue uid is expected to cmp == 0
      :run_time: 0.000129777
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue"]'
      :resource_id: "/etc/issue"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.7.6_Ensure_permissions_on_etcissue.net_are_configured
    :title: Ensure permissions on /etc/issue.net are configured
    :desc: |-
      The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.

      Rationale: If the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :descriptions:
    - :label: default
      :data: |-
        The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.

        Rationale: If the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.7.6_Ensure_permissions_on_etcissue.net_are_configured\"
      do\n  title \"Ensure permissions on /etc/issue.net are configured\"\n  desc
      \ \"\n    The contents of the /etc/issue.net file are displayed to users prior
      to login for remote connections from configured services.\n    \n    Rationale:
      If the /etc/issue.net file does not have the correct ownership it could be modified
      by unauthorized users with incorrect or misleading information.\n  \"\n  impact
      1.0\n  describe file(\"/etc/issue.net\") do\n    it { should exist }\n    its(\"gid\")
      { should cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"owner\" }\n    it { should_not be_writable.by \"group\" }\n    it { should_not
      be_executable.by \"group\" }\n    it { should_not be_executable.by \"other\"
      }\n    it { should_not be_writable.by \"other\" }\n    it { should_not be_setgid
      }\n    it { should_not be_sticky }\n    it { should_not be_setuid }\n  end\nend\n"
    :source_location:
      :line: 826
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/issue.net is expected to exist
      :run_time: 0.039161074
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be executable by owner
      :run_time: 0.061065794
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be writable by group
      :run_time: 0.00022862
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be executable by group
      :run_time: 0.000106771
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be executable by other
      :run_time: 9.4345e-05
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be writable by other
      :run_time: 0.000189801
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be setgid
      :run_time: 0.002640993
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be sticky
      :run_time: 0.002282195
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net is expected not to be setuid
      :run_time: 0.002209054
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net gid is expected to cmp == 0
      :run_time: 0.000195842
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
    - :status: passed
      :code_desc: File /etc/issue.net uid is expected to cmp == 0
      :run_time: 0.000137269
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/issue.net"]'
      :resource_id: "/etc/issue.net"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.2_Ensure_GDM_login_banner_is_configured
    :title: Ensure GDM login banner is configured
    :desc: |-
      GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.

      Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.
    :descriptions:
    - :label: default
      :data: |-
        GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.

        Rationale: Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.2_Ensure_GDM_login_banner_is_configured\"
      do\n  title \"Ensure GDM login banner is configured\"\n  desc  \"\n    GDM is
      the GNOME Display Manager which handles graphical login for GNOME based systems.\n
      \   \n    Rationale: Warning messages inform users who are attempting to login
      to the system of their legal status regarding the system and must include the
      name of the organization that owns the system and any monitoring policies that
      are in place.\n  \"\n  impact 1.0\n  if package('gdm').installed?\n    output
      = bash(\"l_output=\\\"\\\" l_output2=\\\"\\\"\\n# Look for existing settings
      and set variables if they exist\\nl_gdmfile=\\\"$(grep -Prils '^\\\\h*banner-message-enable\\\\b'
      /etc/dconf/db/*.d)\\\"\\nif [ -n \\\"$l_gdmfile\\\" ]; then\\n   # Set profile
      name based on dconf db directory ({PROFILE_NAME}.d)\\n   l_gdmprofile=\\\"$(awk
      -F\\\\/ '{split($(NF-1),a,\\\".\\\");print a[1]}' <<< \\\"$l_gdmfile\\\")\\\"\\n
      \  # Check if banner message is enabled\\n   if grep -Pisq '^\\\\h*banner-message-enable=true\\\\b'
      \\\"$l_gdmfile\\\"; then\\n      l_output=\\\"$l_output\\\\n - The \\\\\\\"banner-message-enable\\\\\\\"
      option is enabled in \\\\\\\"$l_gdmfile\\\\\\\"\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"banner-message-enable\\\\\\\" option is not enabled\\\"\\n   fi\\n
      \  l_lsbt=\\\"$(grep -Pios '^\\\\h*banner-message-text=.*$' \\\"$l_gdmfile\\\")\\\"\\n
      \  if [ -n \\\"$l_lsbt\\\" ]; then\\n      l_output=\\\"$l_output\\\\n - The
      \\\\\\\"banner-message-text\\\\\\\" option is set in \\\\\\\"$l_gdmfile\\\\\\\"\\\\n
      \ - banner-message-text is set to:\\\\n  - \\\\\\\"$l_lsbt\\\\\\\"\\\"\\n   else\\n
      \     l_output2=\\\"$l_output2\\\\n - The \\\\\\\"banner-message-text\\\\\\\"
      option is not set\\\"\\n   fi\\n   if grep -Pq \\\"^\\\\h*system-db:$l_gdmprofile\\\"
      /etc/dconf/profile/\\\"$l_gdmprofile\\\"; then\\n      l_output=\\\"$l_output\\\\n
      - The \\\\\\\"$l_gdmprofile\\\\\\\" profile exists\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"$l_gdmprofile\\\\\\\" profile doesn't exist\\\"\\n   fi\\n   if
      [ -f \\\"/etc/dconf/db/$l_gdmprofile\\\" ]; then\\n      l_output=\\\"$l_output\\\\n
      - The \\\\\\\"$l_gdmprofile\\\\\\\" profile exists in the dconf database\\\"\\n
      \  else\\n      l_output2=\\\"$l_output2\\\\n - The \\\\\\\"$l_gdmprofile\\\\\\\"
      profile doesn't exist in the dconf database\\\"\\n   fi\\nelse\\n   l_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"banner-message-enable\\\\\\\" option isn't configured\\\"\\nfi\\n#
      Report results. If no failures output in l_output2, we pass\\nif [ -z \\\"$l_output2\\\"
      ]; then\\n   echo -e \\\"\\\\n- Audit Result:\\\\n  ** PASS **\\\\n$l_output\\\\n\\\"\\nelse\\n
      \  echo -e \\\"\\\\n- Audit Result:\\\\n  ** FAIL **\\\\n - Reason(s) for audit
      failure:\\\\n$l_output2\\\\n\\\"\\n   [ -n \\\"$l_output\\\" ] && echo -e \\\"\\\\n-
      Correctly set:\\\\n$l_output\\\\n\\\"\\nfi\").stdout\n    describe output do\n
      \     it { should match (\"PASS\") }\n    end\n  else\n    describe package(\"gdm\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 849
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000219298
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.3_Ensure_GDM_disable-user-list_option_is_enabled
    :title: Ensure GDM disable-user-list option is enabled
    :desc: |-
      GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.

      The disable-user-list option controls if a list of users is displayed on the login screen

      Rationale: Displaying the user list eliminates half of the Userid/Password equation that an unauthorized person would need to log on.
    :descriptions:
    - :label: default
      :data: |-
        GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.

        The disable-user-list option controls if a list of users is displayed on the login screen

        Rationale: Displaying the user list eliminates half of the Userid/Password equation that an unauthorized person would need to log on.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.3_Ensure_GDM_disable-user-list_option_is_enabled\"
      do\n  title \"Ensure GDM disable-user-list option is enabled\"\n  desc  \"\n
      \   GDM is the GNOME Display Manager which handles graphical login for GNOME
      based systems.\n    \n    The disable-user-list option controls if a list of
      users is displayed on the login screen\n    \n    Rationale: Displaying the
      user list eliminates half of the Userid/Password equation that an unauthorized
      person would need to log on.\n  \"\n  impact 1.0\n  if package('gdm').installed?\n
      \   output = bash(\"output=\\\"\\\" output2=\\\"\\\"\\nl_gdmfile=\\\"$(grep
      -Pril '^\\\\h*disable-user-list\\\\h*=\\\\h*true\\\\b' /etc/dconf/db)\\\"\\nif
      [ -n \\\"$l_gdmfile\\\" ]; then\\n\\toutput=\\\"$output\\\\n - The \\\\\\\"disable-user-list\\\\\\\"
      option is enabled in \\\\\\\"$l_gdmfile\\\\\\\"\\\"\\n\\tl_gdmprofile=\\\"$(awk
      -F\\\\/ '{split($(NF-1),a,\\\".\\\");print a[1]}' <<< \\\"$l_gdmfile\\\")\\\"\\n\\tif
      grep -Pq \\\"^\\\\h*system-db:$l_gdmprofile\\\" /etc/dconf/profile/\\\"$l_gdmprofile\\\";
      then\\n\\t\\toutput=\\\"$output\\\\n - The \\\\\\\"$l_gdmprofile\\\\\\\" exists\\\"\\n\\telse\\n\\t\\toutput2=\\\"$output2\\\\n
      - The \\\\\\\"$l_gdmprofile\\\\\\\" doesn't exist\\\"\\n\\tfi\\n\\tif [ -f \\\"/etc/dconf/db/$l_gdmprofile\\\"
      ]; then\\n\\t\\toutput=\\\"$output\\\\n - The \\\\\\\"$l_gdmprofile\\\\\\\"
      profile exists in the dconf database\\\"\\n\\telse\\n\\t\\toutput2=\\\"$output2\\\\n
      - The \\\\\\\"$l_gdmprofile\\\\\\\" profile doesn't exist in the dconf database\\\"\\n\\tfi\\nelse\\n\\toutput2=\\\"$output2\\\\n
      - The \\\\\\\"disable-user-list\\\\\\\" option is not enabled\\\"\\nfi\\n# Report
      results. If no failures output in l_output2, we pass\\nif [ -z \\\"$output2\\\"
      ]; then\\n\\techo -e \\\"\\\\n- Audit result:\\\\n   *** PASS: ***\\\\n$output\\\\n\\\"\\nelse\\n\\techo
      -e \\\"\\\\n- Audit Result:\\\\n   *** FAIL: ***\\\\n$output2\\\\n\\\"\\n\\t[
      -n \\\"$output\\\" ] && echo -e \\\"$output\\\\n\\\"\\nfi\").stdout\n    describe
      output do\n      it { should match (\"PASS\") }\n    end\n  else\n    describe
      package(\"gdm\") do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 869
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000156734
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.4_Ensure_GDM_screen_locks_when_the_user_is_idle
    :title: Ensure GDM screen locks when the user is idle
    :desc: |-
      GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.

      * idle-delay=uint32 {n} - Number of seconds of inactivity before the screen goes blank
      * lock-delay=uint32 {n} - Number of seconds after the screen is blank before locking the screen
      **Example key file:**

      # Specify the dconf path
      [org/gnome/desktop/session]

      # Number of seconds of inactivity before the screen goes blank
      # Set to 0 seconds if you want to deactivate the screensaver.
      idle-delay=uint32 900

      # Specify the dconf path
      [org/gnome/desktop/screensaver]

      # Number of seconds after the screen is blank before locking the screen
      lock-delay=uint32 5

      Rationale: Setting a lock-out value reduces the window of opportunity for unauthorized user access to another user's session that has been left unattended.
    :descriptions:
    - :label: default
      :data: |-
        GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.

        * idle-delay=uint32 {n} - Number of seconds of inactivity before the screen goes blank
        * lock-delay=uint32 {n} - Number of seconds after the screen is blank before locking the screen
        **Example key file:**

        # Specify the dconf path
        [org/gnome/desktop/session]

        # Number of seconds of inactivity before the screen goes blank
        # Set to 0 seconds if you want to deactivate the screensaver.
        idle-delay=uint32 900

        # Specify the dconf path
        [org/gnome/desktop/screensaver]

        # Number of seconds after the screen is blank before locking the screen
        lock-delay=uint32 5

        Rationale: Setting a lock-out value reduces the window of opportunity for unauthorized user access to another user's session that has been left unattended.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.4_Ensure_GDM_screen_locks_when_the_user_is_idle\"
      do\n  title \"Ensure GDM screen locks when the user is idle\"\n  desc  \"\n
      \   GNOME Desktop Manager can make the screen lock automatically whenever the
      user is idle for some amount of time.\n    \n    * idle-delay=uint32 {n} - Number
      of seconds of inactivity before the screen goes blank\n    * lock-delay=uint32
      {n} - Number of seconds after the screen is blank before locking the screen\n
      \   **Example key file:**\n    \n    # Specify the dconf path\n    [org/gnome/desktop/session]\n
      \   \n    # Number of seconds of inactivity before the screen goes blank\n    #
      Set to 0 seconds if you want to deactivate the screensaver.\n    idle-delay=uint32
      900\n    \n    # Specify the dconf path\n    [org/gnome/desktop/screensaver]\n
      \   \n    # Number of seconds after the screen is blank before locking the screen\n
      \   lock-delay=uint32 5\n    \n    Rationale: Setting a lock-out value reduces
      the window of opportunity for unauthorized user access to another user's session
      that has been left unattended.\n  \"\n  impact 1.0\n  if package('gdm').installed?\n
      \   output = bash(\"l_output=\\\"\\\" l_output2=\\\"\\\"\\nl_idmv=\\\"#{max_idle_delay}\\\"
      # Set for max value for idle-delay in seconds\\nl_ldmv=\\\"#{max_lock_delay}\\\"
      # Set for max value for lock-delay in seconds\\n# Look for idle-delay to determine
      profile in use, needed for remaining tests\\nl_kfile=\\\"$(grep -Psril '^\\\\h*idle-delay\\\\h*=\\\\h*uint32\\\\h+\\\\d+\\\\b'
      /etc/dconf/db/*/)\\\" # Determine file containing idle-delay key\\nif [ -n \\\"$l_kfile\\\"
      ]; then\\n\\t# set profile name (This is the name of a dconf database)\\n\\tl_profile=\\\"$(awk
      -F'/' '{split($(NF-1),a,\\\".\\\");print a[1]}' <<< \\\"$l_kfile\\\")\\\" #Set
      the key profile name\\n\\tl_pdbdir=\\\"/etc/dconf/db/$l_profile.d\\\" # Set
      the key file dconf db directory\\n\\t# Confirm that idle-delay exists, includes
      unit32, and value is between 1 and max value for idle-delay\\n\\tl_idv=\\\"$(awk
      -F 'uint32' '/idle-delay/{print $2}' \\\"$l_kfile\\\" | xargs)\\\"\\n\\tif [
      -n \\\"$l_idv\\\" ]; then\\n\\t\\t[ \\\"$l_idv\\\" -gt \\\"0\\\" -a \\\"$l_idv\\\"
      -le \\\"$l_idmv\\\" ] && l_output=\\\"$l_output\\\\n - The \\\\\\\"idle-delay\\\\\\\"
      option is set to \\\\\\\"$l_idv\\\\\\\" seconds in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\t\\t[
      \\\"$l_idv\\\" = \\\"0\\\" ] && l_output2=\\\"$l_output2\\\\n - The \\\\\\\"idle-delay\\\\\\\"
      option is set to \\\\\\\"$l_idv\\\\\\\" (disabled) in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\t\\t[
      \\\"$l_idv\\\" -gt \\\"$l_idmv\\\" ] && l_output2=\\\"$l_output2\\\\n - The
      \\\\\\\"idle-delay\\\\\\\" option is set to \\\\\\\"$l_idv\\\\\\\" seconds (greater
      than $l_idmv) in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"idle-delay\\\\\\\" option is not set in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\tfi\\n\\t#
      Confirm that lock-delay exists, includes unit32, and value is between 0 and
      max value for lock-delay\\n\\tl_ldv=\\\"$(awk -F 'uint32' '/lock-delay/{print
      $2}' \\\"$l_kfile\\\" | xargs)\\\"\\n\\tif [ -n \\\"$l_ldv\\\" ]; then\\n\\t\\t[
      \\\"$l_ldv\\\" -ge \\\"0\\\" -a \\\"$l_ldv\\\" -le \\\"$l_ldmv\\\" ] && l_output=\\\"$l_output\\\\n
      - The \\\\\\\"lock-delay\\\\\\\" option is set to \\\\\\\"$l_ldv\\\\\\\" seconds
      in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\t\\t[ \\\"$l_ldv\\\" -gt \\\"$l_ldmv\\\"
      ] && l_output2=\\\"$l_output2\\\\n - The \\\\\\\"lock-delay\\\\\\\" option is
      set to \\\\\\\"$l_ldv\\\\\\\" seconds (greater than $l_ldmv) in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"lock-delay\\\\\\\" option is not set in \\\\\\\"$l_kfile\\\\\\\"\\\"\\n\\tfi\\n\\t#
      Confirm that dconf profile exists\\n\\tif grep -Psq \\\"^\\\\h*system-db:$l_profile\\\"
      /etc/dconf/profile/*; then\\n\\t\\tl_output=\\\"$l_output\\\\n - The \\\\\\\"$l_profile\\\\\\\"
      profile exists\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n - The \\\\\\\"$l_profile\\\\\\\"
      doesn't exist\\\"\\n\\tfi\\n\\t# Confirm that dconf profile database file exists\\n\\tif
      [ -f \\\"/etc/dconf/db/$l_profile\\\" ]; then\\n\\t\\tl_output=\\\"$l_output\\\\n
      - The \\\\\\\"$l_profile\\\\\\\" profile exists in the dconf database\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"$l_profile\\\\\\\" profile doesn't exist in the dconf database\\\"\\n\\tfi\\nelse\\n\\tl_output2=\\\"$l_output2\\\\n
      - The \\\\\\\"idle-delay\\\\\\\" option doesn't exist, remaining tests skipped\\\"\\nfi\\n\\n#
      Report results. If no failures output in l_output2, we pass\\nif [ -z \\\"$l_output2\\\"
      ]; then\\n   echo -e \\\"\\\\n- Audit Result:\\\\n  ** PASS **\\\\n$l_output\\\\n\\\"\\nelse\\n
      \  echo -e \\\"\\\\n- Audit Result:\\\\n  ** FAIL **\\\\n - Reason(s) for audit
      failure:\\\\n$l_output2\\\\n\\\"\\n   [ -n \\\"$l_output\\\" ] && echo -e \\\"\\\\n-
      Correctly set:\\\\n$l_output\\\\n\\\"\\nfi\").stdout\n    describe output do\n
      \     it { should match (\"PASS\") }\n    end\n  else\n    describe package(\"gdm\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 891
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000275038
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.5_Ensure_GDM_screen_locks_cannot_be_overridden
    :title: Ensure GDM screen locks cannot be overridden
    :desc: |-
      GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.

      By using the lockdown mode in dconf, you can prevent users from changing specific settings.

      To lock down a dconf key or subpath,  create a locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.

      **Example Lock File:**

      # Lock desktop screensaver settings
      /org/gnome/desktop/session/idle-delay
      /org/gnome/desktop/screensaver/lock-delay

      Rationale: Setting a lock-out value reduces the window of opportunity for unauthorized user access to another user's session that has been left unattended.

      Without locking down the system settings, user settings take precedence over the system settings.
    :descriptions:
    - :label: default
      :data: |-
        GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.

        By using the lockdown mode in dconf, you can prevent users from changing specific settings.

        To lock down a dconf key or subpath,  create a locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.

        **Example Lock File:**

        # Lock desktop screensaver settings
        /org/gnome/desktop/session/idle-delay
        /org/gnome/desktop/screensaver/lock-delay

        Rationale: Setting a lock-out value reduces the window of opportunity for unauthorized user access to another user's session that has been left unattended.

        Without locking down the system settings, user settings take precedence over the system settings.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.5_Ensure_GDM_screen_locks_cannot_be_overridden\"
      do\n  title \"Ensure GDM screen locks cannot be overridden\"\n  desc  \"\n    GNOME
      Desktop Manager can make the screen lock automatically whenever the user is
      idle for some amount of time.\n    \n    By using the lockdown mode in dconf,
      you can prevent users from changing specific settings.\n    \n    To lock down
      a dconf key or subpath,  create a locks subdirectory in the keyfile directory.
      The files inside this directory contain a list of keys or subpaths to lock.
      Just as with the keyfiles, you may add any number of files to this directory.\n
      \   \n    **Example Lock File:**\n    \n    # Lock desktop screensaver settings\n
      \   /org/gnome/desktop/session/idle-delay\n    /org/gnome/desktop/screensaver/lock-delay\n
      \   \n    Rationale: Setting a lock-out value reduces the window of opportunity
      for unauthorized user access to another user's session that has been left unattended.\n
      \   \n    Without locking down the system settings, user settings take precedence
      over the system settings.\n  \"\n  impact 1.0\n  if package('gdm').installed?\n
      \   output = bash(\"l_output=\\\"\\\" l_output2=\\\"\\\"\\n# Look for idle-delay
      to determine profile in use, needed for remaining tests\\nl_kfd=\\\"/etc/dconf/db/$(grep
      -Psril '^\\\\h*idle-delay\\\\h*=\\\\h*uint32\\\\h+\\\\d+\\\\b' /etc/dconf/db/*/
      | awk -F'/' '{split($(NF-1),a,\\\".\\\");print a[1]}').d\\\" #set directory
      of key file to be locked\\n# Look for lock-delay to determine profile in use,
      needed for remaining tests\\nl_kfd2=\\\"/etc/dconf/db/$(grep -Psril '^\\\\h*lock-delay\\\\h*=\\\\h*uint32\\\\h+\\\\d+\\\\b'
      /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\\\".\\\");print a[1]}').d\\\"
      #set directory of key file to be locked\\nif [ -d \\\"$l_kfd\\\" ]; then # If
      key file directory doesn't exist, options can't be locked\\n\\tif grep -Prilq
      '\\\\/org\\\\/gnome\\\\/desktop\\\\/session\\\\/idle-delay\\\\b' \\\"$l_kfd\\\";
      then\\n\\t\\tl_output=\\\"$l_output\\\\n - \\\\\\\"idle-delay\\\\\\\" is locked
      in \\\\\\\"$(grep -Pril '\\\\/org\\\\/gnome\\\\/desktop\\\\/session\\\\/idle-delay\\\\b'
      \\\"$l_kfd\\\")\\\\\\\"\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n
      - \\\\\\\"idle-delay\\\\\\\" is not locked\\\"\\n\\tfi\\nelse\\n\\tl_output2=\\\"$l_output2\\\\n
      - \\\\\\\"idle-delay\\\\\\\" is not set so it can not be locked\\\"\\nfi\\nif
      [ -d \\\"$l_kfd2\\\" ]; then # If key file directory doesn't exist, options
      can't be locked\\n\\tif grep -Prilq '\\\\/org\\\\/gnome\\\\/desktop\\\\/screensaver\\\\/lock-delay\\\\b'
      \\\"$l_kfd2\\\"; then\\n\\t\\tl_output=\\\"$l_output\\\\n - \\\\\\\"lock-delay\\\\\\\"
      is locked in \\\\\\\"$(grep -Pril '\\\\/org\\\\/gnome\\\\/desktop\\\\/screensaver\\\\/lock-delay\\\\b'
      \\\"$l_kfd2\\\")\\\\\\\"\\\"\\n\\telse\\n\\t\\tl_output2=\\\"$l_output2\\\\n
      - \\\\\\\"lock-delay\\\\\\\" is not locked\\\"\\n\\tfi\\nelse\\n\\tl_output2=\\\"$l_output2\\\\n
      - \\\\\\\"lock-delay\\\\\\\" is not set so it can not be locked\\\"\\nfi\\n#
      Report results. If no failures output in l_output2, we pass\\nif [ -z \\\"$l_output2\\\"
      ]; then\\n\\techo -e \\\"\\\\n- Audit Result:\\\\n  ** PASS **\\\\n$l_output\\\\n\\\"\\nelse\\n\\techo
      -e \\\"\\\\n- Audit Result:\\\\n  ** FAIL **\\\\n - Reason(s) for audit failure:\\\\n$l_output2\\\\n\\\"\\n\\t[
      -n \\\"$l_output\\\" ] && echo -e \\\"\\\\n- Correctly set:\\\\n$l_output\\\\n\\\"\\nfi\").stdout\n
      \   describe output do\n      it { should match (\"PASS\") }\n    end\n  else\n
      \   describe package(\"gdm\") do\n      it { should_not be_installed }\n    end\n
      \ end\nend\n"
    :source_location:
      :line: 928
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000169277
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.8_Ensure_GDM_autorun-never_is_enabled
    :title: Ensure GDM autorun-never is enabled
    :desc: |-
      The autorun-never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.

      Rationale: Malware on removable media may taking advantage of Autorun features when the media is inserted into a system and execute.
    :descriptions:
    - :label: default
      :data: |-
        The autorun-never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.

        Rationale: Malware on removable media may taking advantage of Autorun features when the media is inserted into a system and execute.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.8_Ensure_GDM_autorun-never_is_enabled\"
      do\n  title \"Ensure GDM autorun-never is enabled\"\n  desc  \"\n    The autorun-never
      setting allows the GNOME Desktop Display Manager to disable autorun through
      GDM.\n    \n    Rationale: Malware on removable media may taking advantage of
      Autorun features when the media is inserted into a system and execute.\n  \"\n
      \ impact 1.0\n  if package('gdm').installed?\n    output = bash(\"l_output=\\\"\\\"
      l_output2=\\\"\\\"\\n# Look for existing settings and set variables if they
      exist\\nl_kfile=\\\"$(grep -Prils -- '^\\\\h*autorun-never\\\\b' /etc/dconf/db/*.d)\\\"\\n#
      Set profile name based on dconf db directory ({PROFILE_NAME}.d)\\nif [ -f \\\"$l_kfile\\\"
      ]; then\\n   l_gpname=\\\"$(awk -F\\\\/ '{split($(NF-1),a,\\\".\\\");print a[1]}'
      <<< \\\"$l_kfile\\\")\\\"\\nfi\\n# If the profile name exist, continue checks\\nif
      [ -n \\\"$l_gpname\\\" ]; then\\n   l_gpdir=\\\"/etc/dconf/db/$l_gpname.d\\\"\\n
      \  # Check if profile file exists\\n   if grep -Pq -- \\\"^\\\\h*system-db:$l_gpname\\\\b\\\"
      /etc/dconf/profile/*; then\\n      l_output=\\\"$l_output\\\\n - dconf database
      profile file \\\\\\\"$(grep -Pl -- \\\"^\\\\h*system-db:$l_gpname\\\\b\\\" /etc/dconf/profile/*)\\\\\\\"
      exists\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n - dconf database
      profile isn't set\\\"\\n   fi\\n   # Check if the dconf database file exists\\n
      \  if [ -f \\\"/etc/dconf/db/$l_gpname\\\" ]; then\\n      l_output=\\\"$l_output\\\\n
      - The dconf database \\\\\\\"$l_gpname\\\\\\\" exists\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n
      - The dconf database \\\\\\\"$l_gpname\\\\\\\" doesn't exist\\\"\\n   fi\\n
      \  # check if the dconf database directory exists\\n   if [ -d \\\"$l_gpdir\\\"
      ]; then\\n      l_output=\\\"$l_output\\\\n - The dconf directory \\\\\\\"$l_gpdir\\\\\\\"
      exists\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n - The dconf directory
      \\\\\\\"$l_gpdir\\\\\\\" doesn't exist\\\"\\n   fi\\n   # check autorun-never
      setting\\n   if grep -Pqrs -- '^\\\\h*autorun-never\\\\h*=\\\\h*true\\\\b' \\\"$l_kfile\\\";
      then\\n      l_output=\\\"$l_output\\\\n - \\\\\\\"autorun-never\\\\\\\" is
      set to true in: \\\\\\\"$l_kfile\\\\\\\"\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n
      - \\\\\\\"autorun-never\\\\\\\" is not set correctly\\\"\\n   fi\\nelse\\n   #
      Settings don't exist. Nothing further to check\\n   l_output2=\\\"$l_output2\\\\n
      - \\\\\\\"autorun-never\\\\\\\" is not set\\\"\\nfi\\n# Report results. If no
      failures output in l_output2, we pass\\nif [ -z \\\"$l_output2\\\" ]; then\\n
      \  echo -e \\\"\\\\n- Audit Result:\\\\n  ** PASS **\\\\n$l_output\\\\n\\\"\\nelse\\n
      \  echo -e \\\"\\\\n- Audit Result:\\\\n  ** FAIL **\\\\n - Reason(s) for audit
      failure:\\\\n$l_output2\\\\n\\\"\\n   [ -n \\\"$l_output\\\" ] && echo -e \\\"\\\\n-
      Correctly set:\\\\n$l_output\\\\n\\\"\\nfi\").stdout\n    describe output do\n
      \     it { should match (\"PASS\") }\n    end\n  else\n    describe package(\"gdm\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 960
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000141254
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.9_Ensure_GDM_autorun-never_is_not_overridden
    :title: Ensure GDM autorun-never is not overridden
    :desc: |-
      The autorun-never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.

      By using the lockdown mode in dconf, you can prevent users from changing specific settings.

      To lock down a dconf key or subpath, create a locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.

      Example Lock File:

      # Lock desktop media-handling settings
      /org/gnome/desktop/media-handling/autorun-never

      Rationale: Malware on removable media may taking advantage of Autorun features when the media is inserted into a system and execute.
    :descriptions:
    - :label: default
      :data: |-
        The autorun-never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.

        By using the lockdown mode in dconf, you can prevent users from changing specific settings.

        To lock down a dconf key or subpath, create a locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.

        Example Lock File:

        # Lock desktop media-handling settings
        /org/gnome/desktop/media-handling/autorun-never

        Rationale: Malware on removable media may taking advantage of Autorun features when the media is inserted into a system and execute.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.9_Ensure_GDM_autorun-never_is_not_overridden\"
      do\n  title \"Ensure GDM autorun-never is not overridden\"\n  desc  \"\n    The
      autorun-never setting allows the GNOME Desktop Display Manager to disable autorun
      through GDM.\n    \n    By using the lockdown mode in dconf, you can prevent
      users from changing specific settings.\n    \n    To lock down a dconf key or
      subpath, create a locks subdirectory in the keyfile directory. The files inside
      this directory contain a list of keys or subpaths to lock. Just as with the
      keyfiles, you may add any number of files to this directory.\n    \n    Example
      Lock File:\n    \n    # Lock desktop media-handling settings\n    /org/gnome/desktop/media-handling/autorun-never\n
      \   \n    Rationale: Malware on removable media may taking advantage of Autorun
      features when the media is inserted into a system and execute.\n  \"\n  impact
      1.0\n  if package('gdm').installed?\n    output = bash(\"l_output=\\\"\\\" l_output2=\\\"\\\"\\n#
      Look for autorun-never to determine profile in use, needed for remaining tests\\nl_kfd=\\\"/etc/dconf/db/$(grep
      -Psril '^\\\\h*autorun-never\\\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\\\".\\\");print
      a[1]}').d\\\" #set directory of key file to be locked\\nif [ -d \\\"$l_kfd\\\"
      ]; then # If key file directory doesn't exist, options can't be locked\\n   if
      grep -Prsiq '^\\\\h*\\\\/org/gnome\\\\/desktop\\\\/media-handling\\\\/autorun-never\\\\b'
      \\\"$l_kfd\\\"; then\\n      l_output=\\\"$l_output\\\\n - \\\\\\\"autorun-never\\\\\\\"
      is locked in \\\\\\\"$(grep -Pril '^\\\\h*\\\\/org/gnome\\\\/desktop\\\\/media-handling\\\\/autorun-never\\\\b'
      \\\"$l_kfd\\\")\\\\\\\"\\\"\\n   else\\n      l_output2=\\\"$l_output2\\\\n
      - \\\\\\\"autorun-never\\\\\\\" is not locked\\\"\\n   fi\\nelse\\n   l_output2=\\\"$l_output2\\\\n
      - \\\\\\\"autorun-never\\\\\\\" is not set so it can not be locked\\\"\\nfi\\n#
      Report results. If no failures output in l_output2, we pass\\nif [ -z \\\"$l_output2\\\"
      ]; then\\n   echo -e \\\"\\\\n- Audit Result:\\\\n  ** PASS **\\\\n$l_output\\\\n\\\"\\nelse\\n
      \  echo -e \\\"\\\\n- Audit Result:\\\\n  ** FAIL **\\\\n - Reason(s) for audit
      failure:\\\\n$l_output2\\\\n\\\"\\n   [ -n \\\"$l_output\\\" ] && echo -e \\\"\\\\n-
      Correctly set:\\\\n$l_output\\\\n\\\"\\nfi\").stdout\n    describe output do\n
      \     it { should match (\"PASS\") }\n    end\n  else\n    describe package(\"gdm\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 980
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.00013271
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.8.10_Ensure_XDCMP_is_not_enabled
    :title: Ensure XDCMP is not enabled
    :desc: |-
      X Display Manager Control Protocol (XDMCP) is designed to provide authenticated access to display management services for remote displays

      Rationale: XDMCP is inherently insecure.

      * XDMCP is not a ciphered protocol. This may allow an attacker to capture keystrokes entered by a user
      * XDMCP is vulnerable to man-in-the-middle attacks. This may allow an attacker to steal the credentials of legitimate users by impersonating the XDMCP server.
    :descriptions:
    - :label: default
      :data: |-
        X Display Manager Control Protocol (XDMCP) is designed to provide authenticated access to display management services for remote displays

        Rationale: XDMCP is inherently insecure.

        * XDMCP is not a ciphered protocol. This may allow an attacker to capture keystrokes entered by a user
        * XDMCP is vulnerable to man-in-the-middle attacks. This may allow an attacker to steal the credentials of legitimate users by impersonating the XDMCP server.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.8.10_Ensure_XDCMP_is_not_enabled\"
      do\n  title \"Ensure XDCMP is not enabled\"\n  desc  \"\n    X Display Manager
      Control Protocol (XDMCP) is designed to provide authenticated access to display
      management services for remote displays\n    \n    Rationale: XDMCP is inherently
      insecure.\n    \n    * XDMCP is not a ciphered protocol. This may allow an attacker
      to capture keystrokes entered by a user\n    * XDMCP is vulnerable to man-in-the-middle
      attacks. This may allow an attacker to steal the credentials of legitimate users
      by impersonating the XDMCP server.\n  \"\n  impact 1.0\n  describe file(\"/etc/gdm/custom.conf\")
      do\n    its(\"content\") { should_not match(/^(?i)\\s*Enable\\s*=\\s*true\\b/)
      }\n  end\nend\n"
    :source_location:
      :line: 1009
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/gdm/custom.conf content is expected not to match /^(?i)\s*Enable\s*=\s*true\b/
      :run_time: 0.111207905
      :start_time: '2024-04-04T14:52:32+00:00'
      :resource_class: file
      :resource_params: '["/etc/gdm/custom.conf"]'
      :resource_id: "/etc/gdm/custom.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.9_Ensure_updates_patches_and_additional_security_software_are_installed
    :title: Ensure updates, patches, and additional security software are installed
    :desc: |-
      Periodically patches are released for included software either due to security flaws or to include additional functionality.

      Rationale: Newer patches may contain security enhancements that would not be available through the latest full update. As a result, it is recommended that the latest software patches be used to take advantage of the latest functionality. As with any software installation, organizations need to determine if a given update meets their requirements and verify the compatibility and supportability of any additional software against the update revision that is selected.
    :descriptions:
    - :label: default
      :data: |-
        Periodically patches are released for included software either due to security flaws or to include additional functionality.

        Rationale: Newer patches may contain security enhancements that would not be available through the latest full update. As a result, it is recommended that the latest software patches be used to take advantage of the latest functionality. As with any software installation, organizations need to determine if a given update meets their requirements and verify the compatibility and supportability of any additional software against the update revision that is selected.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.9_Ensure_updates_patches_and_additional_security_software_are_installed\"
      do\n  title \"Ensure updates, patches, and additional security software are
      installed\"\n  desc  \"\n    Periodically patches are released for included
      software either due to security flaws or to include additional functionality.\n
      \   \n    Rationale: Newer patches may contain security enhancements that would
      not be available through the latest full update. As a result, it is recommended
      that the latest software patches be used to take advantage of the latest functionality.
      As with any software installation, organizations need to determine if a given
      update meets their requirements and verify the compatibility and supportability
      of any additional software against the update revision that is selected.\n  \"\n
      \ impact 0.0\n  describe command('dnf check-update --security') do\n    its('exit_status')
      { should eq 0 }\n  end\n  describe command('dnf needs-restarting -r | grep \"Reboot
      should not be necessary.\"') do\n    its('stdout') { should include \"Reboot
      should not be necessary\" }\n  end\nend\n"
    :source_location:
      :line: 1025
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'Command: `dnf check-update --security` exit_status is expected
        to eq 0'
      :run_time: 0.598639291
      :start_time: '2024-04-04T14:52:32+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: command
      :resource_params: '["dnf check-update --security"]'
      :resource_id: 'Command: `dnf check-update --security`'
    - :status: failed
      :code_desc: 'Command: `dnf needs-restarting -r | grep "Reboot should not be
        necessary."` stdout is expected to include "Reboot should not be necessary"'
      :run_time: 0.552987813
      :start_time: '2024-04-04T14:52:33+00:00'
      :message: expected "" to include "Reboot should not be necessary"
      :resource_class: command
      :resource_params: '["dnf needs-restarting -r | grep \"Reboot should not be necessary.\""]'
      :resource_id: 'Command: `dnf needs-restarting -r | grep "Reboot should not be
        necessary."`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_1.10_Ensure_system-wide_crypto_policy_is_not_legacy
    :title: Ensure system-wide crypto policy is not legacy
    :desc: |-
      The system-wide crypto-policies followed by the crypto core components allow consistently deprecating and disabling algorithms system-wide.

      The individual policy levels (DEFAULT, LEGACY, FUTURE, and FIPS) are included in the crypto-policies(7) package.

      Rationale: If the Legacy system-wide crypto policy is selected, it includes support for TLS 1.0, TLS 1.1, and SSH2 protocols or later. The algorithms DSA, 3DES, and RC4 are allowed, while RSA and Diffie-Hellman parameters are accepted if larger than 1023-bits.

      These legacy protocols and algorithms can make the system vulnerable to attacks, including those listed in RFC 7457
    :descriptions:
    - :label: default
      :data: |-
        The system-wide crypto-policies followed by the crypto core components allow consistently deprecating and disabling algorithms system-wide.

        The individual policy levels (DEFAULT, LEGACY, FUTURE, and FIPS) are included in the crypto-policies(7) package.

        Rationale: If the Legacy system-wide crypto policy is selected, it includes support for TLS 1.0, TLS 1.1, and SSH2 protocols or later. The algorithms DSA, 3DES, and RC4 are allowed, while RSA and Diffie-Hellman parameters are accepted if larger than 1023-bits.

        These legacy protocols and algorithms can make the system vulnerable to attacks, including those listed in RFC 7457
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_1.10_Ensure_system-wide_crypto_policy_is_not_legacy\"
      do\n  title \"Ensure system-wide crypto policy is not legacy\"\n  desc  \"\n
      \   The system-wide crypto-policies followed by the crypto core components allow
      consistently deprecating and disabling algorithms system-wide.\n    \n    The
      individual policy levels (DEFAULT, LEGACY, FUTURE, and FIPS) are included in
      the crypto-policies(7) package.\n    \n    Rationale: If the Legacy system-wide
      crypto policy is selected, it includes support for TLS 1.0, TLS 1.1, and SSH2
      protocols or later. The algorithms DSA, 3DES, and RC4 are allowed, while RSA
      and Diffie-Hellman parameters are accepted if larger than 1023-bits.\n    \n
      \   These legacy protocols and algorithms can make the system vulnerable to
      attacks, including those listed in RFC 7457\n  \"\n  impact 1.0\n  describe
      file(\"/etc/crypto-policies/config\") do\n    its(\"content\") { should_not
      match(/^\\s*(?i)LEGACY\\s*(\\s+#.*)?$/) }\n  end\nend\n"
    :source_location:
      :line: 1041
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/crypto-policies/config content is expected not to match
        /^\s*(?i)LEGACY\s*(\s+#.*)?$/
      :run_time: 0.058680854
      :start_time: '2024-04-04T14:52:33+00:00'
      :resource_class: file
      :resource_params: '["/etc/crypto-policies/config"]'
      :resource_id: "/etc/crypto-policies/config"
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_time_synchronization_is_in_use
    :title: Ensure time synchronization is in use
    :desc: |-
      System time should be synchronized between all systems in an environment. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them.

      **Note:** If another method for time synchronization is being used, this section may be skipped.

      Rationale: Time synchronization is important to support time sensitive security mechanisms like Kerberos and also ensures log files have consistent time records across the enterprise, which aids in forensic investigations.
    :descriptions:
    - :label: default
      :data: |-
        System time should be synchronized between all systems in an environment. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them.

        **Note:** If another method for time synchronization is being used, this section may be skipped.

        Rationale: Time synchronization is important to support time sensitive security mechanisms like Kerberos and also ensures log files have consistent time records across the enterprise, which aids in forensic investigations.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_time_synchronization_is_in_use\"
      do\n  title \"Ensure time synchronization is in use\"\n  desc  \"\n    System
      time should be synchronized between all systems in an environment. This is typically
      done by establishing an authoritative time server or set of servers and having
      all systems synchronize their clocks to them.\n    \n    **Note:** If another
      method for time synchronization is being used, this section may be skipped.\n
      \   \n    Rationale: Time synchronization is important to support time sensitive
      security mechanisms like Kerberos and also ensures log files have consistent
      time records across the enterprise, which aids in forensic investigations.\n
      \ \"\n  impact 1.0\n  describe package(\"chrony\") do\n    it { should be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 1058
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package chrony is expected to be installed
      :run_time: 0.000644284
      :start_time: '2024-04-04T14:52:33+00:00'
      :resource_class: package
      :resource_params: '["chrony"]'
      :resource_id: chrony
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_chrony_is_configured
    :title: Ensure chrony is configured
    :desc: |-
      chrony is a daemon which implements the Network Time Protocol (NTP) and is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at [http://chrony.tuxfamily.org/](http://chrony.tuxfamily.org/) . chrony can be configured to be a client and/or a server.

      Rationale: If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.
    :descriptions:
    - :label: default
      :data: |-
        chrony is a daemon which implements the Network Time Protocol (NTP) and is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at [http://chrony.tuxfamily.org/](http://chrony.tuxfamily.org/) . chrony can be configured to be a client and/or a server.

        Rationale: If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_chrony_is_configured\"
      do\n  title \"Ensure chrony is configured\"\n  desc  \"\n    chrony is a daemon
      which implements the Network Time Protocol (NTP) and is designed to synchronize
      system clocks across a variety of systems and use a source that is highly accurate.
      More information on chrony can be found at [http://chrony.tuxfamily.org/](http://chrony.tuxfamily.org/)
      . chrony can be configured to be a client and/or a server.\n    \n    Rationale:
      If chrony is in use on the system proper configuration is vital to ensuring
      time synchronization is working properly.\n  \"\n  impact 1.0\n  if package('chrony').installed?\n
      \   describe file(\"/etc/chrony.conf\") do\n      its(\"content\") { should
      match(/^\\s*(server|pool)\\s+[^#]+\\s*(?:#.*)?$/) }\n    end\n    describe file(\"/etc/sysconfig/chronyd\")
      do\n      its(\"content\") { should match(/^\\s*OPTIONS\\s*=\\s*\"([^\"#]*\\s+)*-u\\schrony\\b[^\"#]*\"\\s*(?:#.*)?$/)
      }\n    end\n  else\n    describe package(\"chrony\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 1073
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/chrony.conf content is expected to match /^\s*(server|pool)\s+[^#]+\s*(?:#.*)?$/
      :run_time: 0.057455211
      :start_time: '2024-04-04T14:52:33+00:00'
      :resource_class: file
      :resource_params: '["/etc/chrony.conf"]'
      :resource_id: "/etc/chrony.conf"
    - :status: failed
      :code_desc: File /etc/sysconfig/chronyd content is expected to match /^\s*OPTIONS\s*=\s*"([^"#]*\s+)*-u\schrony\b[^"#]*"\s*(?:#.*)?$/
      :run_time: 0.059555829
      :start_time: '2024-04-04T14:52:33+00:00'
      :message: |
        expected "# Command-line options for chronyd\nOPTIONS=\"-F 2\"\n" to match /^\s*OPTIONS\s*=\s*"([^"#]*\s+)*-u\schrony\b[^"#]*"\s*(?:#.*)?$/
        Diff:
        @@ -1,2 +1,3 @@
        -/^\s*OPTIONS\s*=\s*"([^"#]*\s+)*-u\schrony\b[^"#]*"\s*(?:#.*)?$/
        +# Command-line options for chronyd
        +OPTIONS="-F 2"
      :resource_class: file
      :resource_params: '["/etc/sysconfig/chronyd"]'
      :resource_id: "/etc/sysconfig/chronyd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.4_Ensure_DHCP_Server_is_not_installed
    :title: Ensure DHCP Server is not installed
    :desc: |-
      The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses.

      Rationale: Unless a system is specifically set up to act as a DHCP server, it is recommended that the dhcp-server package be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses.

        Rationale: Unless a system is specifically set up to act as a DHCP server, it is recommended that the dhcp-server package be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.4_Ensure_DHCP_Server_is_not_installed\"
      do\n  title \"Ensure DHCP Server is not installed\"\n  desc  \"\n    The Dynamic
      Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically
      assigned IP addresses.\n    \n    Rationale: Unless a system is specifically
      set up to act as a DHCP server, it is recommended that the dhcp-server package
      be removed to reduce the potential attack surface.\n  \"\n  impact 1.0\n  describe
      package(\"dhcp-server\") do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1095
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package dhcp-server is expected not to be installed
      :run_time: 0.064403113
      :start_time: '2024-04-04T14:52:33+00:00'
      :resource_class: package
      :resource_params: '["dhcp-server"]'
      :resource_id: dhcp-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.5_Ensure_DNS_Server_is_not_installed
    :title: Ensure DNS Server is not installed
    :desc: |-
      The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.

      Rationale: Unless a system is specifically designated to act as a DNS server, it is recommended that the package be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.

        Rationale: Unless a system is specifically designated to act as a DNS server, it is recommended that the package be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.5_Ensure_DNS_Server_is_not_installed\"
      do\n  title \"Ensure DNS Server is not installed\"\n  desc  \"\n    The Domain
      Name System (DNS) is a hierarchical naming system that maps names to IP addresses
      for computers, services and other resources connected to a network.\n    \n
      \   Rationale: Unless a system is specifically designated to act as a DNS server,
      it is recommended that the package be removed to reduce the potential attack
      surface.\n  \"\n  impact 1.0\n  describe package(\"bind\") do\n    it { should_not
      be_installed }\n  end\nend\n"
    :source_location:
      :line: 1108
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package bind is expected not to be installed
      :run_time: 0.064086319
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["bind"]'
      :resource_id: bind
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.6_Ensure_VSFTP_Server_is_not_installed
    :title: Ensure VSFTP Server is not installed
    :desc: |-
      FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network, especially where no authentication is necessary (permits anonymous users to connect to a server).

      Rationale: Unless there is a need to run the system as a FTP server, it is recommended that the package be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network, especially where no authentication is necessary (permits anonymous users to connect to a server).

        Rationale: Unless there is a need to run the system as a FTP server, it is recommended that the package be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.6_Ensure_VSFTP_Server_is_not_installed\"
      do\n  title \"Ensure VSFTP Server is not installed\"\n  desc  \"\n    FTP (File
      Transfer Protocol) is a traditional and widely used standard tool for transferring
      files between a server and clients over a network, especially where no authentication
      is necessary (permits anonymous users to connect to a server).\n    \n    Rationale:
      Unless there is a need to run the system as a FTP server, it is recommended
      that the package be removed to reduce the potential attack surface.\n  \"\n
      \ impact 1.0\n  describe package(\"vsftpd\") do\n    it { should_not be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 1121
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package vsftpd is expected not to be installed
      :run_time: 0.065051845
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["vsftpd"]'
      :resource_id: vsftpd
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.7_Ensure_TFTP_Server_is_not_installed
    :title: Ensure TFTP Server is not installed
    :desc: |-
      Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.

      Rationale: Unless there is a need to run the system as a TFTP server, it is recommended that the package be removed to reduce the potential attack surface.

      TFTP does not have built-in encryption, access control or authentication. This makes it very easy for an attacker to exploit TFTP to gain access to files
    :descriptions:
    - :label: default
      :data: |-
        Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.

        Rationale: Unless there is a need to run the system as a TFTP server, it is recommended that the package be removed to reduce the potential attack surface.

        TFTP does not have built-in encryption, access control or authentication. This makes it very easy for an attacker to exploit TFTP to gain access to files
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.7_Ensure_TFTP_Server_is_not_installed\"
      do\n  title \"Ensure TFTP Server is not installed\"\n  desc  \"\n    Trivial
      File Transfer Protocol (TFTP) is a simple protocol for exchanging files between
      two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending
      and receiving files.\n    \n    Rationale: Unless there is a need to run the
      system as a TFTP server, it is recommended that the package be removed to reduce
      the potential attack surface.\n    \n    TFTP does not have built-in encryption,
      access control or authentication. This makes it very easy for an attacker to
      exploit TFTP to gain access to files\n  \"\n  impact 1.0\n  describe package(\"tftp-server\")
      do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1134
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package tftp-server is expected not to be installed
      :run_time: 0.065619159
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["tftp-server"]'
      :resource_id: tftp-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.8_Ensure_a_web_server_is_not_installed
    :title: Ensure a web server is not installed
    :desc: |-
      Web servers provide the ability to host web site content.

      Rationale: Unless there is a need to run the system as a web server, it is recommended that the packages be removed to reduce the potential attack surface.

      **Note:** Several http servers exist.  They should also be audited, and removed, if not required.
    :descriptions:
    - :label: default
      :data: |-
        Web servers provide the ability to host web site content.

        Rationale: Unless there is a need to run the system as a web server, it is recommended that the packages be removed to reduce the potential attack surface.

        **Note:** Several http servers exist.  They should also be audited, and removed, if not required.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.8_Ensure_a_web_server_is_not_installed\"
      do\n  title \"Ensure a web server is not installed\"\n  desc  \"\n    Web servers
      provide the ability to host web site content.\n    \n    Rationale: Unless there
      is a need to run the system as a web server, it is recommended that the packages
      be removed to reduce the potential attack surface.\n    \n    **Note:** Several
      http servers exist.  They should also be audited, and removed, if not required.\n
      \ \"\n  impact 1.0\n  describe package(\"httpd\") do\n    it { should_not be_installed
      }\n  end\n  describe package(\"nginx\") do\n    it { should_not be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 1149
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package httpd is expected not to be installed
      :run_time: 0.065910884
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["httpd"]'
      :resource_id: httpd
    - :status: passed
      :code_desc: System Package nginx is expected not to be installed
      :run_time: 0.066379038
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["nginx"]'
      :resource_id: nginx
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.9_Ensure_IMAP_and_POP3_server_is_not_installed
    :title: Ensure IMAP and POP3 server is not installed
    :desc: |-
      dovecot is an open source IMAP and POP3 server for Linux based systems.

      Rationale: Unless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed to reduce the potential attack surface.

      **Note:** Several IMAP/POP3 servers exist and can use other service names. These should also be audited and the packages removed if not required.
    :descriptions:
    - :label: default
      :data: |-
        dovecot is an open source IMAP and POP3 server for Linux based systems.

        Rationale: Unless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed to reduce the potential attack surface.

        **Note:** Several IMAP/POP3 servers exist and can use other service names. These should also be audited and the packages removed if not required.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.9_Ensure_IMAP_and_POP3_server_is_not_installed\"
      do\n  title \"Ensure IMAP and POP3 server is not installed\"\n  desc  \"\n    dovecot
      is an open source IMAP and POP3 server for Linux based systems.\n    \n    Rationale:
      Unless POP3 and/or IMAP servers are to be provided by this system, it is recommended
      that the package be removed to reduce the potential attack surface.\n    \n
      \   **Note:** Several IMAP/POP3 servers exist and can use other service names.
      These should also be audited and the packages removed if not required.\n  \"\n
      \ impact 1.0\n  describe package(\"dovecot\") do\n    it { should_not be_installed
      }\n  end\n  describe package(\"cyrus-imapd\") do\n    it { should_not be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 1167
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package dovecot is expected not to be installed
      :run_time: 0.065286618
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["dovecot"]'
      :resource_id: dovecot
    - :status: passed
      :code_desc: System Package cyrus-imapd is expected not to be installed
      :run_time: 0.065831537
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["cyrus-imapd"]'
      :resource_id: cyrus-imapd
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.10_Ensure_Samba_is_not_installed
    :title: Ensure Samba is not installed
    :desc: |-
      The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.

      Rationale: If there is no need to mount directories and file systems to Windows systems, then this package can be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.

        Rationale: If there is no need to mount directories and file systems to Windows systems, then this package can be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.10_Ensure_Samba_is_not_installed\"
      do\n  title \"Ensure Samba is not installed\"\n  desc  \"\n    The Samba daemon
      allows system administrators to configure their Linux systems to share file
      systems and directories with Windows desktops. Samba will advertise the file
      systems and directories via the Server Message Block (SMB) protocol. Windows
      desktop users will be able to mount these directories and file systems as letter
      drives on their systems.\n    \n    Rationale: If there is no need to mount
      directories and file systems to Windows systems, then this package can be removed
      to reduce the potential attack surface.\n  \"\n  impact 1.0\n  describe package(\"samba\")
      do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1185
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package samba is expected not to be installed
      :run_time: 0.065138676
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["samba"]'
      :resource_id: samba
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.11_Ensure_HTTP_Proxy_Server_is_not_installed
    :title: Ensure HTTP Proxy Server is not installed
    :desc: |-
      Squid is a standard proxy server used in many distributions and environments.

      Rationale: Unless a system is specifically set up to act as a proxy server, it is recommended that the squid package be removed to reduce the potential attack surface.

      **Note:** Several HTTP proxy servers exist. These should be checked and removed unless required.
    :descriptions:
    - :label: default
      :data: |-
        Squid is a standard proxy server used in many distributions and environments.

        Rationale: Unless a system is specifically set up to act as a proxy server, it is recommended that the squid package be removed to reduce the potential attack surface.

        **Note:** Several HTTP proxy servers exist. These should be checked and removed unless required.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.11_Ensure_HTTP_Proxy_Server_is_not_installed\"
      do\n  title \"Ensure HTTP Proxy Server is not installed\"\n  desc  \"\n    Squid
      is a standard proxy server used in many distributions and environments.\n    \n
      \   Rationale: Unless a system is specifically set up to act as a proxy server,
      it is recommended that the squid package be removed to reduce the potential
      attack surface.\n    \n    **Note:** Several HTTP proxy servers exist. These
      should be checked and removed unless required.\n  \"\n  impact 1.0\n  describe
      package(\"squid\") do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1198
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package squid is expected not to be installed
      :run_time: 0.065009072
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["squid"]'
      :resource_id: squid
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.12_Ensure_net-snmp_is_not_installed
    :title: Ensure net-snmp is not installed
    :desc: |-
      Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment, computer equipment and devices like UPSs.

      Net-SNMP is a suite of applications used to implement SNMPv1 (RFC 1157), SNMPv2 (RFCs 1901-1908), and SNMPv3 (RFCs 3411-3418) using both IPv4 and IPv6.

      Support for SNMPv2 classic (a.k.a. "SNMPv2 historic" - RFCs 1441-1452) was dropped with the 4.0 release of the UCD-snmp package.

      The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.

      Rationale: The SNMP server can communicate using SNMPv1 , which transmits data in the clear and does not require authentication to execute commands. SNMPv3 replaces the simple/clear text password sharing used in SNMPv2 with more securely encoded parameters. If the the SNMP service is not required, the net-snmp package should be removed to reduce the attack surface of the system.

      **Note:** If SNMP is required:

      *  The server should be configured for SNMP v3 only. User Authentication and Message Encryption should be configured.
      *  If SNMP v2 is **absolutely** necessary, modify the community strings' values.
    :descriptions:
    - :label: default
      :data: |-
        Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment, computer equipment and devices like UPSs.

        Net-SNMP is a suite of applications used to implement SNMPv1 (RFC 1157), SNMPv2 (RFCs 1901-1908), and SNMPv3 (RFCs 3411-3418) using both IPv4 and IPv6.

        Support for SNMPv2 classic (a.k.a. "SNMPv2 historic" - RFCs 1441-1452) was dropped with the 4.0 release of the UCD-snmp package.

        The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.

        Rationale: The SNMP server can communicate using SNMPv1 , which transmits data in the clear and does not require authentication to execute commands. SNMPv3 replaces the simple/clear text password sharing used in SNMPv2 with more securely encoded parameters. If the the SNMP service is not required, the net-snmp package should be removed to reduce the attack surface of the system.

        **Note:** If SNMP is required:

        *  The server should be configured for SNMP v3 only. User Authentication and Message Encryption should be configured.
        *  If SNMP v2 is **absolutely** necessary, modify the community strings' values.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.12_Ensure_net-snmp_is_not_installed\"
      do\n  title \"Ensure net-snmp is not installed\"\n  desc  \"\n    Simple Network
      Management Protocol (SNMP) is a widely used protocol for monitoring the health
      and welfare of network equipment, computer equipment and devices like UPSs.\n
      \   \n    Net-SNMP is a suite of applications used to implement SNMPv1 (RFC
      1157), SNMPv2 (RFCs 1901-1908), and SNMPv3 (RFCs 3411-3418) using both IPv4
      and IPv6.\n    \n    Support for SNMPv2 classic (a.k.a. \\\"SNMPv2 historic\\\"
      - RFCs 1441-1452) was dropped with the 4.0 release of the UCD-snmp package.\n
      \   \n    The Simple Network Management Protocol (SNMP) server is used to listen
      for SNMP commands from an SNMP management system, execute the commands or collect
      the information and then send results back to the requesting system.\n    \n
      \   Rationale: The SNMP server can communicate using SNMPv1 , which transmits
      data in the clear and does not require authentication to execute commands. SNMPv3
      replaces the simple/clear text password sharing used in SNMPv2 with more securely
      encoded parameters. If the the SNMP service is not required, the net-snmp package
      should be removed to reduce the attack surface of the system.\n    \n    **Note:**
      If SNMP is required:\n    \n    *  The server should be configured for SNMP
      v3 only. User Authentication and Message Encryption should be configured.\n
      \   *  If SNMP v2 is **absolutely** necessary, modify the community strings'
      values.\n  \"\n  impact 1.0\n  describe package(\"net-snmp\") do\n    it { should_not
      be_installed }\n  end\nend\n"
    :source_location:
      :line: 1213
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package net-snmp is expected not to be installed
      :run_time: 0.064835419
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["net-snmp"]'
      :resource_id: net-snmp
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.13_Ensure_telnet-server_is_not_installed
    :title: Ensure telnet-server is not installed
    :desc: |-
      The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol.

      Rationale: The telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow a user with access to sniff network traffic the ability to steal credentials. The ssh package provides an encrypted session and stronger security.
    :descriptions:
    - :label: default
      :data: |-
        The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol.

        Rationale: The telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow a user with access to sniff network traffic the ability to steal credentials. The ssh package provides an encrypted session and stronger security.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.13_Ensure_telnet-server_is_not_installed\"
      do\n  title \"Ensure telnet-server is not installed\"\n  desc  \"\n    The telnet-server
      package contains the telnet daemon, which accepts connections from users from
      other systems via the telnet protocol.\n    \n    Rationale: The telnet protocol
      is insecure and unencrypted. The use of an unencrypted transmission medium could
      allow a user with access to sniff network traffic the ability to steal credentials.
      The ssh package provides an encrypted session and stronger security.\n  \"\n
      \ impact 1.0\n  describe package(\"telnet-server\") do\n    it { should_not
      be_installed }\n  end\nend\n"
    :source_location:
      :line: 1237
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package telnet-server is expected not to be installed
      :run_time: 0.06548627
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["telnet-server"]'
      :resource_id: telnet-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.14_Ensure_dnsmasq_is_not_installed
    :title: Ensure dnsmasq is not installed
    :desc: |-
      dnsmasq is a lightweight tool that provides DNS caching, DNS forwarding and DHCP (Dynamic Host Configuration Protocol) services.

      Rationale: Unless a system is specifically designated to act as a DNS caching, DNS forwarding and/or DHCP server, it is recommended that the package be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        dnsmasq is a lightweight tool that provides DNS caching, DNS forwarding and DHCP (Dynamic Host Configuration Protocol) services.

        Rationale: Unless a system is specifically designated to act as a DNS caching, DNS forwarding and/or DHCP server, it is recommended that the package be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.14_Ensure_dnsmasq_is_not_installed\"
      do\n  title \"Ensure dnsmasq is not installed\"\n  desc  \"\n    dnsmasq is
      a lightweight tool that provides DNS caching, DNS forwarding and DHCP (Dynamic
      Host Configuration Protocol) services.\n    \n    Rationale: Unless a system
      is specifically designated to act as a DNS caching, DNS forwarding and/or DHCP
      server, it is recommended that the package be removed to reduce the potential
      attack surface.\n  \"\n  impact 1.0\n  describe package(\"dnsmasq\") do\n    it
      { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1250
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package dnsmasq is expected not to be installed
      :run_time: 0.06515338
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["dnsmasq"]'
      :resource_id: dnsmasq
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.15_Ensure_mail_transfer_agent_is_configured_for_local-only_mode
    :title: Ensure mail transfer agent is configured for local-only mode
    :desc: |-
      Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.

      Rationale: The software for all Mail Transfer Agents is complex and most have a long history of security issues. While it is important to ensure that the system can process local mail messages, it is not necessary to have the MTA's daemon listening on a port unless the server is intended to be a mail server that receives and processes mail from other systems.

      **Note:**

      * This recommendation is designed around the postfix mail server.
      * Depending on your environment you may have an alternative MTA installed such as sendmail. If this is the case consult the documentation for your installed MTA to configure the recommended state.
    :descriptions:
    - :label: default
      :data: |-
        Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.

        Rationale: The software for all Mail Transfer Agents is complex and most have a long history of security issues. While it is important to ensure that the system can process local mail messages, it is not necessary to have the MTA's daemon listening on a port unless the server is intended to be a mail server that receives and processes mail from other systems.

        **Note:**

        * This recommendation is designed around the postfix mail server.
        * Depending on your environment you may have an alternative MTA installed such as sendmail. If this is the case consult the documentation for your installed MTA to configure the recommended state.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.15_Ensure_mail_transfer_agent_is_configured_for_local-only_mode\"
      do\n  title \"Ensure mail transfer agent is configured for local-only mode\"\n
      \ desc  \"\n    Mail Transfer Agents (MTA), such as sendmail and Postfix, are
      used to listen for incoming mail and transfer the messages to the appropriate
      user or mail server. If the system is not intended to be a mail server, it is
      recommended that the MTA be configured to only process local mail.\n    \n    Rationale:
      The software for all Mail Transfer Agents is complex and most have a long history
      of security issues. While it is important to ensure that the system can process
      local mail messages, it is not necessary to have the MTA's daemon listening
      on a port unless the server is intended to be a mail server that receives and
      processes mail from other systems.\n    \n    **Note:**\n    \n    * This recommendation
      is designed around the postfix mail server.\n    * Depending on your environment
      you may have an alternative MTA installed such as sendmail. If this is the case
      consult the documentation for your installed MTA to configure the recommended
      state.\n  \"\n  impact 1.0\n  describe port(25).where { protocol =~ /.*/ &&
      address =~ /^(?!127\\.0\\.0\\.1|::1).*$/ } do\n    its(\"entries\") { should
      be_empty }\n  end\nend\n"
    :source_location:
      :line: 1263
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Port 25 with protocol =~ /.*/ address =~ /^(?!127\.0\.0\.1|::1).*$/
        entries is expected to be empty
      :run_time: 0.002650092
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: FilterTable::Table
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.16_Ensure_nfs-utils_is_not_installed_or_the__nfs-server_service_is_masked
    :title: Ensure nfs-utils is not installed or the  nfs-server service is masked
    :desc: |-
      The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.

      Rationale: If the system does not require network shares, it is recommended that the nfs-utils package be removed to reduce the attack surface of the system.
    :descriptions:
    - :label: default
      :data: |-
        The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.

        Rationale: If the system does not require network shares, it is recommended that the nfs-utils package be removed to reduce the attack surface of the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.16_Ensure_nfs-utils_is_not_installed_or_the__nfs-server_service_is_masked\"
      do\n  title \"Ensure nfs-utils is not installed or the  nfs-server service is
      masked\"\n  desc  \"\n    The Network File System (NFS) is one of the first
      and most widely distributed file systems in the UNIX environment. It provides
      the ability for systems to mount file systems of other servers through the network.\n
      \   \n    Rationale: If the system does not require network shares, it is recommended
      that the nfs-utils package be removed to reduce the attack surface of the system.\n
      \ \"\n  impact 1.0\n  describe.one do\n    describe package(\"nfs-utils\") do\n
      \     it { should_not be_installed }\n    end\n    describe service(\"nfs-server\").params
      do\n      its(\"LoadState\") { should eq \"masked\" }\n    end\n  end\nend\n"
    :source_location:
      :line: 1281
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nfs-utils is expected not to be installed
      :run_time: 0.000259231
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["nfs-utils"]'
      :resource_id: nfs-utils
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.17_Ensure_rpcbind_is_not_installed_or_the__rpcbind_services_are_masked
    :title: Ensure rpcbind is not installed or the  rpcbind services are masked
    :desc: |-
      The rpcbind utility maps RPC services to the ports on which they listen. RPC processes notify rpcbind when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The client system then contacts rpcbind on the server with a particular RPC program number. The rpcbind service redirects the client to the proper port number so it can communicate with the requested service

      Portmapper is an RPC service, which always listens on tcp and udp 111, and is used to map other RPC services (such as nfs, nlockmgr, quotad, mountd, etc.) to their corresponding port number on the server. When a remote host makes an RPC call to that server, it first consults with portmap to determine where the RPC server is listening.

      Rationale: A small request (~82 bytes via UDP) sent to the Portmapper generates a large response (7x to 28x amplification), which makes it a suitable tool for DDoS attacks. If rpcbind is not required, it is recommended that the rpcbind package be removed to reduce the attack surface of the system.
    :descriptions:
    - :label: default
      :data: |-
        The rpcbind utility maps RPC services to the ports on which they listen. RPC processes notify rpcbind when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The client system then contacts rpcbind on the server with a particular RPC program number. The rpcbind service redirects the client to the proper port number so it can communicate with the requested service

        Portmapper is an RPC service, which always listens on tcp and udp 111, and is used to map other RPC services (such as nfs, nlockmgr, quotad, mountd, etc.) to their corresponding port number on the server. When a remote host makes an RPC call to that server, it first consults with portmap to determine where the RPC server is listening.

        Rationale: A small request (~82 bytes via UDP) sent to the Portmapper generates a large response (7x to 28x amplification), which makes it a suitable tool for DDoS attacks. If rpcbind is not required, it is recommended that the rpcbind package be removed to reduce the attack surface of the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.17_Ensure_rpcbind_is_not_installed_or_the__rpcbind_services_are_masked\"
      do\n  title \"Ensure rpcbind is not installed or the  rpcbind services are masked\"\n
      \ desc  \"\n    The rpcbind utility maps RPC services to the ports on which
      they listen. RPC processes notify rpcbind when they start, registering the ports
      they are listening on and the RPC program numbers they expect to serve. The
      client system then contacts rpcbind on the server with a particular RPC program
      number. The rpcbind service redirects the client to the proper port number so
      it can communicate with the requested service\n    \n    Portmapper is an RPC
      service, which always listens on tcp and udp 111, and is used to map other RPC
      services (such as nfs, nlockmgr, quotad, mountd, etc.) to their corresponding
      port number on the server. When a remote host makes an RPC call to that server,
      it first consults with portmap to determine where the RPC server is listening.\n
      \   \n    Rationale: A small request (~82 bytes via UDP) sent to the Portmapper
      generates a large response (7x to 28x amplification), which makes it a suitable
      tool for DDoS attacks. If rpcbind is not required, it is recommended that the
      rpcbind package be removed to reduce the attack surface of the system.\n  \"\n
      \ impact 1.0\n  if package('rpcbind').installed?\n    describe service(\"rpcbind\").params
      do\n      its(\"LoadState\") { should eq \"masked\" }\n    end\n    describe
      service(\"rpcbind.socket\").params do\n      its(\"LoadState\") { should eq
      \"masked\" }\n    end\n  else\n    describe package(\"rpcbind\") do\n      it
      { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 1299
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package rpcbind is expected not to be installed
      :run_time: 0.0002822
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["rpcbind"]'
      :resource_id: rpcbind
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.2.18_Ensure_rsync-daemon_is_not_installed_or_the_rsyncd_service_is_masked
    :title: Ensure rsync-daemon is not installed or the rsyncd service is masked
    :desc: |-
      The rsyncd service can be used to synchronize files between systems over network links.

      Rationale: Unless required, the rsync-daemon package should be removed to reduce the attack surface area of the system.

      The rsyncd service presents a security risk as it uses unencrypted protocols for communication.

      Note: If a required dependency exists for the rsync-daemon package, but the rsyncd service is not required, the service should be masked.
    :descriptions:
    - :label: default
      :data: |-
        The rsyncd service can be used to synchronize files between systems over network links.

        Rationale: Unless required, the rsync-daemon package should be removed to reduce the attack surface area of the system.

        The rsyncd service presents a security risk as it uses unencrypted protocols for communication.

        Note: If a required dependency exists for the rsync-daemon package, but the rsyncd service is not required, the service should be masked.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.2.18_Ensure_rsync-daemon_is_not_installed_or_the_rsyncd_service_is_masked\"
      do\n  title \"Ensure rsync-daemon is not installed or the rsyncd service is
      masked\"\n  desc  \"\n    The rsyncd service can be used to synchronize files
      between systems over network links.\n    \n    Rationale: Unless required, the
      rsync-daemon package should be removed to reduce the attack surface area of
      the system.\n    \n    The rsyncd service presents a security risk as it uses
      unencrypted protocols for communication.\n    \n    Note: If a required dependency
      exists for the rsync-daemon package, but the rsyncd service is not required,
      the service should be masked.\n  \"\n  impact 1.0\n  describe.one do\n    describe
      service(\"rsyncd\").params do\n      its(\"LoadState\") { should eq \"masked\"
      }\n    end\n    describe package(\"rsync-daemon\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 1323
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package rsync-daemon is expected not to be installed
      :run_time: 0.00017298
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["rsync-daemon"]'
      :resource_id: rsync-daemon
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_telnet_client_is_not_installed
    :title: Ensure telnet client is not installed
    :desc: |-
      The telnet package contains the telnet client, which allows users to start connections to other systems via the telnet protocol.

      Rationale: The telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow an unauthorized user to steal credentials. The ssh package provides an encrypted session and stronger security and is included in most Linux distributions.
    :descriptions:
    - :label: default
      :data: |-
        The telnet package contains the telnet client, which allows users to start connections to other systems via the telnet protocol.

        Rationale: The telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow an unauthorized user to steal credentials. The ssh package provides an encrypted session and stronger security and is included in most Linux distributions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_telnet_client_is_not_installed\"
      do\n  title \"Ensure telnet client is not installed\"\n  desc  \"\n    The telnet
      package contains the telnet client, which allows users to start connections
      to other systems via the telnet protocol.\n    \n    Rationale: The telnet protocol
      is insecure and unencrypted. The use of an unencrypted transmission medium could
      allow an unauthorized user to steal credentials. The ssh package provides an
      encrypted session and stronger security and is included in most Linux distributions.\n
      \ \"\n  impact 1.0\n  describe package(\"telnet\") do\n    it { should_not be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 1345
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package telnet is expected not to be installed
      :run_time: 0.060562433
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["telnet"]'
      :resource_id: telnet
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_LDAP_client_is_not_installed
    :title: Ensure LDAP client is not installed
    :desc: |-
      The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.

      Rationale: If the system will not need to act as an LDAP client, it is recommended that the software be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.

        Rationale: If the system will not need to act as an LDAP client, it is recommended that the software be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_LDAP_client_is_not_installed\"
      do\n  title \"Ensure LDAP client is not installed\"\n  desc  \"\n    The Lightweight
      Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP.
      It is a service that provides a method for looking up information from a central
      database.\n    \n    Rationale: If the system will not need to act as an LDAP
      client, it is recommended that the software be removed to reduce the potential
      attack surface.\n  \"\n  impact 1.0\n  describe package(\"openldap-clients\")
      do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1358
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package openldap-clients is expected not to be installed
      :run_time: 0.065710303
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["openldap-clients"]'
      :resource_id: openldap-clients
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_TFTP_client_is_not_installed
    :title: Ensure TFTP client is not installed
    :desc: |-
      Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.

      Rationale: TFTP does not have built-in encryption, access control or authentication. This makes it very easy for an attacker to exploit TFTP to gain access to files
    :descriptions:
    - :label: default
      :data: |-
        Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.

        Rationale: TFTP does not have built-in encryption, access control or authentication. This makes it very easy for an attacker to exploit TFTP to gain access to files
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_TFTP_client_is_not_installed\"
      do\n  title \"Ensure TFTP client is not installed\"\n  desc  \"\n    Trivial
      File Transfer Protocol (TFTP) is a simple protocol for exchanging files between
      two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending
      and receiving files.\n    \n    Rationale: TFTP does not have built-in encryption,
      access control or authentication. This makes it very easy for an attacker to
      exploit TFTP to gain access to files\n  \"\n  impact 1.0\n  describe package(\"tftp\")
      do\n    it { should_not be_installed }\n  end\nend\n"
    :source_location:
      :line: 1371
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package tftp is expected not to be installed
      :run_time: 0.065253538
      :start_time: '2024-04-04T14:52:34+00:00'
      :resource_class: package
      :resource_params: '["tftp"]'
      :resource_id: tftp
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_FTP_client_is_not_installed
    :title: Ensure FTP client is not installed
    :desc: |-
      FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network, especially where no authentication is necessary (permits anonymous users to connect to a server).

      Rationale: FTP does not protect the confidentiality of data or authentication credentials. It is recommended SFTP be used if file transfer is required. Unless there is a need to run the system as a FTP server (for example, to allow anonymous downloads), it is recommended that the package be removed to reduce the potential attack surface.
    :descriptions:
    - :label: default
      :data: |-
        FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network, especially where no authentication is necessary (permits anonymous users to connect to a server).

        Rationale: FTP does not protect the confidentiality of data or authentication credentials. It is recommended SFTP be used if file transfer is required. Unless there is a need to run the system as a FTP server (for example, to allow anonymous downloads), it is recommended that the package be removed to reduce the potential attack surface.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_FTP_client_is_not_installed\"
      do\n  title \"Ensure FTP client is not installed\"\n  desc  \"\n    FTP (File
      Transfer Protocol) is a traditional and widely used standard tool for transferring
      files between a server and clients over a network, especially where no authentication
      is necessary (permits anonymous users to connect to a server).\n    \n    Rationale:
      FTP does not protect the confidentiality of data or authentication credentials.
      It is recommended SFTP be used if file transfer is required. Unless there is
      a need to run the system as a FTP server (for example, to allow anonymous downloads),
      it is recommended that the package be removed to reduce the potential attack
      surface.\n  \"\n  impact 1.0\n  describe package(\"ftp\") do\n    it { should_not
      be_installed }\n  end\nend\n"
    :source_location:
      :line: 1384
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package ftp is expected not to be installed
      :run_time: 0.065061775
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: package
      :resource_params: '["ftp"]'
      :resource_id: ftp
  - :id: xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_nonessential_services_listening_on_the_system_are_removed_or_masked
    :title: Ensure nonessential services listening on the system are removed or masked
    :desc: |-
      A network port is identified by its number, the associated IP address, and the type of the communication protocol such as TCP or UDP.

      A listening port is a network port on which an application or process listens on, acting as a communication endpoint.

      Each listening port can be open or closed (filtered) using a firewall. In general terms, an open port is a network port that accepts incoming packets from remote locations.

      Rationale: Services listening on the system pose a potential risk as an attack vector.  These services should be reviewed, and if not required, the service should be stopped, and the package containing the service should be removed.  If required packages have a dependency, the service should be stopped and masked to reduce the attack surface of the system.
    :descriptions:
    - :label: default
      :data: |-
        A network port is identified by its number, the associated IP address, and the type of the communication protocol such as TCP or UDP.

        A listening port is a network port on which an application or process listens on, acting as a communication endpoint.

        Each listening port can be open or closed (filtered) using a firewall. In general terms, an open port is a network port that accepts incoming packets from remote locations.

        Rationale: Services listening on the system pose a potential risk as an attack vector.  These services should be reviewed, and if not required, the service should be stopped, and the package containing the service should be removed.  If required packages have a dependency, the service should be stopped and masked to reduce the attack surface of the system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_nonessential_services_listening_on_the_system_are_removed_or_masked\"
      do\n  title \"Ensure nonessential services listening on the system are removed
      or masked\"\n  desc  \"\n    A network port is identified by its number, the
      associated IP address, and the type of the communication protocol such as TCP
      or UDP.\n    \n    A listening port is a network port on which an application
      or process listens on, acting as a communication endpoint.\n    \n    Each listening
      port can be open or closed (filtered) using a firewall. In general terms, an
      open port is a network port that accepts incoming packets from remote locations.\n
      \   \n    Rationale: Services listening on the system pose a potential risk
      as an attack vector.  These services should be reviewed, and if not required,
      the service should be stopped, and the package containing the service should
      be removed.  If required packages have a dependency, the service should be stopped
      and masked to reduce the attack surface of the system.\n  \"\n  impact 0.0\n
      \ describe \"Ensure nonessential services listening on the system are removed
      or masked\" do\n    skip \"Run the following command: # ss -plntu \n    Review
      the output to ensure that all services listed are required on the system. If
      a listed service is not required, remove the package containing the service.
      If the package containing the service is required, stop and mask the service.\"\n
      \ end\nend\n"
    :source_location:
      :line: 1397
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure nonessential services listening on the system are removed
        or masked
      :run_time: 9.241e-06
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource: ''
      :skip_message: "Run the following command: # ss -plntu \n    Review the output
        to ensure that all services listed are required on the system. If a listed
        service is not required, remove the package containing the service. If the
        package containing the service is required, stop and mask the service."
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure nonessential services listening on the system are removed
        or masked
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_IPv6_status_is_identified
    :title: Ensure IPv6 status is identified
    :desc: |-
      Internet Protocol Version 6 (IPv6) is the most recent version of Internet Protocol (IP). It's designed to supply IP addressing and additional security to support the predicted growth of connected devices. IPv6 is based on 128-bit addressing and can support 340 undecillion addresses, which is 340 followed by 36 zeroes.

      Features of IPv6

      * Hierarchical addressing and routing infrastructure
      * Stateful and Stateless configuration
      * Support for quality of service (QoS)
      * An ideal protocol for neighboring node interaction

      Rationale: IETF RFC 4038 recommends that applications are built with an assumption of dual stack. It is recommended that IPv6 be enabled and configured in accordance with Benchmark recommendations.

      If dual stack and IPv6 are not used in your environment, IPv6 may be disabled to reduce the attack surface of the system, and recommendations pertaining to IPv6 can be skipped.

      **Note:** It is recommended that IPv6 be enabled and configured unless this is against local site policy
    :descriptions:
    - :label: default
      :data: |-
        Internet Protocol Version 6 (IPv6) is the most recent version of Internet Protocol (IP). It's designed to supply IP addressing and additional security to support the predicted growth of connected devices. IPv6 is based on 128-bit addressing and can support 340 undecillion addresses, which is 340 followed by 36 zeroes.

        Features of IPv6

        * Hierarchical addressing and routing infrastructure
        * Stateful and Stateless configuration
        * Support for quality of service (QoS)
        * An ideal protocol for neighboring node interaction

        Rationale: IETF RFC 4038 recommends that applications are built with an assumption of dual stack. It is recommended that IPv6 be enabled and configured in accordance with Benchmark recommendations.

        If dual stack and IPv6 are not used in your environment, IPv6 may be disabled to reduce the attack surface of the system, and recommendations pertaining to IPv6 can be skipped.

        **Note:** It is recommended that IPv6 be enabled and configured unless this is against local site policy
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_IPv6_status_is_identified\"
      do\n  title \"Ensure IPv6 status is identified\"\n  desc  \"\n    Internet Protocol
      Version 6 (IPv6) is the most recent version of Internet Protocol (IP). It's
      designed to supply IP addressing and additional security to support the predicted
      growth of connected devices. IPv6 is based on 128-bit addressing and can support
      340 undecillion addresses, which is 340 followed by 36 zeroes.\n    \n    Features
      of IPv6\n    \n    * Hierarchical addressing and routing infrastructure\n    *
      Stateful and Stateless configuration\n    * Support for quality of service (QoS)\n
      \   * An ideal protocol for neighboring node interaction\n    \n    Rationale:
      IETF RFC 4038 recommends that applications are built with an assumption of dual
      stack. It is recommended that IPv6 be enabled and configured in accordance with
      Benchmark recommendations.\n    \n    If dual stack and IPv6 are not used in
      your environment, IPv6 may be disabled to reduce the attack surface of the system,
      and recommendations pertaining to IPv6 can be skipped.\n    \n    **Note:**
      It is recommended that IPv6 be enabled and configured unless this is against
      local site policy\n  \"\n  impact 0.0\n  output = bash(\"grep -Pqs '^\\\\h*0\\\\b'
      /sys/module/ipv6/parameters/disable && echo -e \\\"\\n - IPv6 is enabled\\n\\\"
      || echo -e \\\"\\n - IPv6 is not enabled\\n\\\"\").stdout\n  if(ipv6_status.casecmp(\"enabled\")==0)\n
      \   describe output do\n      it { should match (\"IPv6 is enabled\") }\n    end\n
      \ elsif(ipv6_status.casecmp(\"disabled\")==0)\n    describe output do\n      it
      { should match (\"IPv6 is not enabled\") }\n    end\n  end\nend\n"
    :source_location:
      :line: 1415
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: |2-

         - IPv6 is enabled

         is expected to match "IPv6 is enabled"
      :run_time: 0.000176173
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "- IPv6 is enabled"
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_IP_forwarding_is_disabled
    :title: Ensure IP forwarding is disabled
    :desc: |-
      The net.ipv4.ip_forward and net.ipv6.conf.all.forwarding flags are used to tell the system whether it can forward packets or not.

      Rationale: Setting the flags to 0 ensures that a system with multiple interfaces (for example, a hard proxy), will never be able to forward packets, and therefore, never serve as a router.
    :descriptions:
    - :label: default
      :data: |-
        The net.ipv4.ip_forward and net.ipv6.conf.all.forwarding flags are used to tell the system whether it can forward packets or not.

        Rationale: Setting the flags to 0 ensures that a system with multiple interfaces (for example, a hard proxy), will never be able to forward packets, and therefore, never serve as a router.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_IP_forwarding_is_disabled\"
      do\n  title \"Ensure IP forwarding is disabled\"\n  desc  \"\n    The net.ipv4.ip_forward
      and net.ipv6.conf.all.forwarding flags are used to tell the system whether it
      can forward packets or not.\n    \n    Rationale: Setting the flags to 0 ensures
      that a system with multiple interfaces (for example, a hard proxy), will never
      be able to forward packets, and therefore, never serve as a router.\n  \"\n
      \ impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.ip_forward\") do\n    its(\"value\")
      { should eq 0 }\n  end\n  files_1 = []\n  files_1 += files\n  describe files_1.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.ip_forward\\s*=\\s*0\\s*$/ } do\n    it
      { should_not be_empty }\n  end\n  ipv6 = bash(\"grep -Pqs '^\\\\h*0\\\\b' /sys/module/ipv6/parameters/disable
      && echo -e \\\"\\n - IPv6 is enabled\\n\\\" || echo -e \\\"\\n - IPv6 is not
      enabled\\n\\\"\").stdout\n  if(ipv6.match(\"IPv6 is enabled\"))\n    describe
      kernel_parameter(\"net.ipv6.conf.all.forwarding\") do\n      its(\"value\")
      { should eq 0 }\n    end\n    files_2 = []\n    files_2 += files\n    describe
      files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv6.conf.all.forwarding\\s*=\\s*0\\s*$/ } do\n
      \     it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 1446
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.ip_forward value is expected to eq 0
      :run_time: 0.059243178
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.ip_forward"]'
      :resource_id: net.ipv4.ip_forward
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002699799
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: Kernel Parameter net.ipv6.conf.all.forwarding value is expected
        to eq 0
      :run_time: 0.05655805
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.all.forwarding"]'
      :resource_id: net.ipv6.conf.all.forwarding
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002629949
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_packet_redirect_sending_is_disabled
    :title: Ensure packet redirect sending is disabled
    :desc: |-
      ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.

      Rationale: An attacker could use a compromised host to send invalid ICMP redirects to other router devices in an attempt to corrupt routing and have users access a system set up by the attacker as opposed to a valid system.
    :descriptions:
    - :label: default
      :data: |-
        ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.

        Rationale: An attacker could use a compromised host to send invalid ICMP redirects to other router devices in an attempt to corrupt routing and have users access a system set up by the attacker as opposed to a valid system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_packet_redirect_sending_is_disabled\"
      do\n  title \"Ensure packet redirect sending is disabled\"\n  desc  \"\n    ICMP
      Redirects are used to send routing information to other hosts. As a host itself
      does not act as a router (in a host only configuration), there is no need to
      send redirects.\n    \n    Rationale: An attacker could use a compromised host
      to send invalid ICMP redirects to other router devices in an attempt to corrupt
      routing and have users access a system set up by the attacker as opposed to
      a valid system.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.send_redirects\") do\n
      \   its(\"value\") { should eq 0 }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.send_redirects\")
      do\n    its(\"value\") { should eq 0 }\n  end\n  files_all_send_redirects =
      []\n  files_all_send_redirects += files\n  describe files_all_send_redirects.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.conf.all.send_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  files_default_send_redirects
      = []\n  files_default_send_redirects += files\n  describe files_default_send_redirects.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.conf.default.send_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1479
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.all.send_redirects value is expected
        to eq 0
      :run_time: 0.057562553
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.send_redirects"]'
      :resource_id: net.ipv4.conf.all.send_redirects
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.default.send_redirects value is expected
        to eq 0
      :run_time: 0.059375113
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.send_redirects"]'
      :resource_id: net.ipv4.conf.default.send_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.00266794
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002339119
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.1_Ensure_source_routed_packets_are_not_accepted
    :title: Ensure source routed packets are not accepted
    :desc: |-
      In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.

      Rationale: Setting net.ipv4.conf.all.accept_source_route , net.ipv4.conf.default.accept_source_route , net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.
    :descriptions:
    - :label: default
      :data: |-
        In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.

        Rationale: Setting net.ipv4.conf.all.accept_source_route , net.ipv4.conf.default.accept_source_route , net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.1_Ensure_source_routed_packets_are_not_accepted\"
      do\n  title \"Ensure source routed packets are not accepted\"\n  desc  \"\n
      \   In networking, source routing allows a sender to partially or fully specify
      the route packets take through a network. In contrast, non-source routed packets
      travel a path determined by routers in the network. In some cases, systems may
      not be routable or reachable from some locations (e.g. private addresses vs.
      Internet routable), and so source routed packets would need to be used.\n    \n
      \   Rationale: Setting net.ipv4.conf.all.accept_source_route , net.ipv4.conf.default.accept_source_route
      , net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route
      to 0 disables the system from accepting source routed packets. Assume this system
      was capable of routing packets to Internet routable addresses on one interface
      and private addresses on another interface. Assume that the private addresses
      were not routable to the Internet routable addresses and vice versa. Under normal
      routing circumstances, an attacker from the Internet routable addresses could
      not use the system as a way to reach the private address systems. If, however,
      source routed packets were allowed, they could be used to gain access to the
      private address systems as the route could be specified, rather than rely on
      routing protocols that did not allow this routing.\n  \"\n  impact 1.0\n  files
      = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.accept_source_route\")
      do\n    its(\"value\") { should eq 0 }\n  end\n  files_1 = []\n  files_1 +=
      files\n  describe files_1.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.all.accept_source_route\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.accept_source_route\")
      do\n    its(\"value\") { should eq 0 }\n  end\n  files_2 = []\n  files_2 +=
      files\n  describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.default.accept_source_route\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  ipv6 = bash(\"grep -Pqs '^\\\\h*0\\\\b'
      /sys/module/ipv6/parameters/disable && echo -e \\\"\\n - IPv6 is enabled\\n\\\"
      || echo -e \\\"\\n - IPv6 is not enabled\\n\\\"\").stdout\n  if(ipv6.match(\"IPv6
      is enabled\"))\n    describe kernel_parameter(\"net.ipv6.conf.all.accept_source_route\")
      do\n      its(\"value\") { should eq 0 }\n    end\n    files_3 = []\n    files_3
      += files\n    describe files_3.delete_if { |f| command(\"file #{f} | cut -d:
      -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv6.conf.all.accept_source_route\\s*=\\s*0\\s*$/
      } do\n      it { should_not be_empty }\n    end\n    describe kernel_parameter(\"net.ipv6.conf.default.accept_source_route\")
      do\n      its(\"value\") { should eq 0 }\n    end\n    files_4 = []\n    files_4
      += files\n    describe files_4.delete_if { |f| command(\"file #{f} | cut -d:
      -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv6.conf.default.accept_source_route\\s*=\\s*0\\s*$/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 1509
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.conf.all.accept_source_route value is
        expected to eq 0
      :run_time: 0.053599921
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.accept_source_route"]'
      :resource_id: net.ipv4.conf.all.accept_source_route
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002610425
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.conf.default.accept_source_route value
        is expected to eq 0
      :run_time: 0.057013172
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.accept_source_route"]'
      :resource_id: net.ipv4.conf.default.accept_source_route
    - :status: passed
      :code_desc: '["/usr/lib/sysctl.d/50-default.conf", "/lib/sysctl.d/50-default.conf"]
        is expected not to be empty'
      :run_time: 0.002578225
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: Kernel Parameter net.ipv6.conf.all.accept_source_route value is
        expected to eq 0
      :run_time: 0.056487329
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.all.accept_source_route"]'
      :resource_id: net.ipv6.conf.all.accept_source_route
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.00280682
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: Kernel Parameter net.ipv6.conf.default.accept_source_route value
        is expected to eq 0
      :run_time: 0.055986627
      :start_time: '2024-04-04T14:52:35+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.default.accept_source_route"]'
      :resource_id: net.ipv6.conf.default.accept_source_route
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002754199
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.2_Ensure_ICMP_redirects_are_not_accepted
    :title: Ensure ICMP redirects are not accepted
    :desc: |-
      ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.

      Rationale: Attackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.
    :descriptions:
    - :label: default
      :data: |-
        ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.

        Rationale: Attackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.2_Ensure_ICMP_redirects_are_not_accepted\"
      do\n  title \"Ensure ICMP redirects are not accepted\"\n  desc  \"\n    ICMP
      redirect messages are packets that convey routing information and tell your
      host (acting as a router) to send packets via an alternate path. It is a way
      of allowing an outside routing device to update your system routing tables.
      By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects
      to 0, the system will not accept any ICMP redirect messages, and therefore,
      won't allow outsiders to update the system's routing tables.\n    \n    Rationale:
      Attackers could use bogus ICMP redirect messages to maliciously alter the system
      routing tables and get them to send packets to incorrect networks and allow
      your system packets to be captured.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n
      \ [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.accept_redirects\") do\n
      \   its(\"value\") { should eq 0 }\n  end\n  files_1 = []\n  files_1 += files\n
      \ describe files_1.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.all.accept_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.accept_redirects\")
      do\n    its(\"value\") { should eq 0 }\n  end\n  files_2 = []\n  files_2 +=
      files\n  describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.default.accept_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  ipv6 = bash(\"grep -Pqs '^\\\\h*0\\\\b'
      /sys/module/ipv6/parameters/disable && echo -e \\\"\\n - IPv6 is enabled\\n\\\"
      || echo -e \\\"\\n - IPv6 is not enabled\\n\\\"\").stdout\n  if(ipv6.match(\"IPv6
      is enabled\"))\n    describe kernel_parameter(\"net.ipv6.conf.all.accept_redirects\")
      do\n      its(\"value\") { should eq 0 }\n    end\n    files_3 = []\n    files_3
      += files\n    describe files_3.delete_if { |f| command(\"file #{f} | cut -d:
      -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv6.conf.all.accept_redirects\\s*=\\s*0\\s*$/
      } do\n      it { should_not be_empty }\n    end\n    describe kernel_parameter(\"net.ipv6.conf.default.accept_redirects\")
      do\n      its(\"value\") { should eq 0 }\n    end\n    files_4 = []\n    files_4
      += files\n    describe files_4.delete_if { |f| command(\"file #{f} | cut -d:
      -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv6.conf.default.accept_redirects\\s*=\\s*0\\s*$/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 1558
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.all.accept_redirects value is expected
        to eq 0
      :run_time: 0.056295462
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.accept_redirects"]'
      :resource_id: net.ipv4.conf.all.accept_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002783292
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.default.accept_redirects value is
        expected to eq 0
      :run_time: 0.05631515
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.accept_redirects"]'
      :resource_id: net.ipv4.conf.default.accept_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002820545
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv6.conf.all.accept_redirects value is expected
        to eq 0
      :run_time: 0.056182569
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.all.accept_redirects"]'
      :resource_id: net.ipv6.conf.all.accept_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002713578
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv6.conf.default.accept_redirects value is
        expected to eq 0
      :run_time: 0.05616027
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.default.accept_redirects"]'
      :resource_id: net.ipv6.conf.default.accept_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002663584
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.3_Ensure_secure_ICMP_redirects_are_not_accepted
    :title: Ensure secure ICMP redirects are not accepted
    :desc: |-
      Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.

      Rationale: It is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects and net.ipv4.conf.default.secure_redirects to 0 protects the system from routing table updates by possibly compromised known gateways.
    :descriptions:
    - :label: default
      :data: |-
        Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.

        Rationale: It is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects and net.ipv4.conf.default.secure_redirects to 0 protects the system from routing table updates by possibly compromised known gateways.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.3_Ensure_secure_ICMP_redirects_are_not_accepted\"
      do\n  title \"Ensure secure ICMP redirects are not accepted\"\n  desc  \"\n
      \   Secure ICMP redirects are the same as ICMP redirects, except they come from
      gateways listed on the default gateway list. It is assumed that these gateways
      are known to your system, and that they are likely to be secure.\n    \n    Rationale:
      It is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects
      and net.ipv4.conf.default.secure_redirects to 0 protects the system from routing
      table updates by possibly compromised known gateways.\n  \"\n  impact 1.0\n
      \ files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.secure_redirects\") do\n
      \   its(\"value\") { should eq 0 }\n  end\n  files_1 = []\n  files_1 += files\n
      \ describe files_1.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.all.secure_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.secure_redirects\")
      do\n    its(\"value\") { should eq 0 }\n  end\n  files_2 = []\n  files_2 +=
      files\n  describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.default.secure_redirects\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1607
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.all.secure_redirects value is expected
        to eq 0
      :run_time: 0.056245787
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.secure_redirects"]'
      :resource_id: net.ipv4.conf.all.secure_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002636168
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.default.secure_redirects value is
        expected to eq 0
      :run_time: 0.056216718
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.secure_redirects"]'
      :resource_id: net.ipv4.conf.default.secure_redirects
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002717472
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.4_Ensure_suspicious_packets_are_logged
    :title: Ensure suspicious packets are logged
    :desc: |-
      When enabled, this feature logs packets with un-routable source addresses to the kernel log.

      Rationale: Enabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.
    :descriptions:
    - :label: default
      :data: |-
        When enabled, this feature logs packets with un-routable source addresses to the kernel log.

        Rationale: Enabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.4_Ensure_suspicious_packets_are_logged\"
      do\n  title \"Ensure suspicious packets are logged\"\n  desc  \"\n    When enabled,
      this feature logs packets with un-routable source addresses to the kernel log.\n
      \   \n    Rationale: Enabling this feature and logging these packets allows
      an administrator to investigate the possibility that an attacker is sending
      spoofed packets to their system.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n
      \ [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.log_martians\") do\n
      \   its(\"value\") { should eq 1 }\n  end\n  files_1 = []\n  files_1 += files\n
      \ describe files_1.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.all.log_martians\\s*=\\s*1\\s*$/
      } do\n    it { should_not be_empty }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.log_martians\")
      do\n    its(\"value\") { should eq 1 }\n  end\n  files_2 = []\n  files_2 +=
      files\n  describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.default.log_martians\\s*=\\s*1\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1637
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.all.log_martians value is expected
        to eq 1
      :run_time: 0.056420406
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 1
             got: 0

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.log_martians"]'
      :resource_id: net.ipv4.conf.all.log_martians
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002690702
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.default.log_martians value is expected
        to eq 1
      :run_time: 0.055867221
      :start_time: '2024-04-04T14:52:35+00:00'
      :message: |2

        expected: 1
             got: 0

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.log_martians"]'
      :resource_id: net.ipv4.conf.default.log_martians
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002662706
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.5_Ensure_broadcast_ICMP_requests_are_ignored
    :title: Ensure broadcast ICMP requests are ignored
    :desc: |-
      Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.

      Rationale: Accepting ICMP echo and timestamp requests with broadcast or multicast destinations for your network could be used to trick your host into starting (or participating) in a Smurf attack. A Smurf attack relies on an attacker sending large amounts of ICMP broadcast messages with a spoofed source address. All hosts receiving this message and responding would send echo-reply messages back to the spoofed address, which is probably not routable. If many hosts respond to the packets, the amount of traffic on the network could be significantly multiplied.
    :descriptions:
    - :label: default
      :data: |-
        Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.

        Rationale: Accepting ICMP echo and timestamp requests with broadcast or multicast destinations for your network could be used to trick your host into starting (or participating) in a Smurf attack. A Smurf attack relies on an attacker sending large amounts of ICMP broadcast messages with a spoofed source address. All hosts receiving this message and responding would send echo-reply messages back to the spoofed address, which is probably not routable. If many hosts respond to the packets, the amount of traffic on the network could be significantly multiplied.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.5_Ensure_broadcast_ICMP_requests_are_ignored\"
      do\n  title \"Ensure broadcast ICMP requests are ignored\"\n  desc  \"\n    Setting
      net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all
      ICMP echo and timestamp requests to broadcast and multicast addresses.\n    \n
      \   Rationale: Accepting ICMP echo and timestamp requests with broadcast or
      multicast destinations for your network could be used to trick your host into
      starting (or participating) in a Smurf attack. A Smurf attack relies on an attacker
      sending large amounts of ICMP broadcast messages with a spoofed source address.
      All hosts receiving this message and responding would send echo-reply messages
      back to the spoofed address, which is probably not routable. If many hosts respond
      to the packets, the amount of traffic on the network could be significantly
      multiplied.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.icmp_echo_ignore_broadcasts\")
      do\n    its(\"value\") { should eq 1 }\n  end\n  describe files.delete_if {
      |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.icmp_echo_ignore_broadcasts\\s*=\\s*1\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1667
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.icmp_echo_ignore_broadcasts value is expected
        to eq 1
      :run_time: 0.055819253
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.icmp_echo_ignore_broadcasts"]'
      :resource_id: net.ipv4.icmp_echo_ignore_broadcasts
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002744881
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.6_Ensure_bogus_ICMP_responses_are_ignored
    :title: Ensure bogus ICMP responses are ignored
    :desc: |-
      Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.

      Rationale: Some routers (and some attackers) will send responses that violate RFC-1122 and attempt to fill up a log file system with many useless error messages.
    :descriptions:
    - :label: default
      :data: |-
        Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.

        Rationale: Some routers (and some attackers) will send responses that violate RFC-1122 and attempt to fill up a log file system with many useless error messages.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.6_Ensure_bogus_ICMP_responses_are_ignored\"
      do\n  title \"Ensure bogus ICMP responses are ignored\"\n  desc  \"\n    Setting
      icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus
      responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems
      from filling up with useless log messages.\n    \n    Rationale: Some routers
      (and some attackers) will send responses that violate RFC-1122 and attempt to
      fill up a log file system with many useless error messages.\n  \"\n  impact
      1.0\n  files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.icmp_ignore_bogus_error_responses\")
      do\n    its(\"value\") { should eq 1 }\n  end\n  describe files.delete_if {
      |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.icmp_ignore_bogus_error_responses\\s*=\\s*1\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1687
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.icmp_ignore_bogus_error_responses value
        is expected to eq 1
      :run_time: 0.055803871
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.icmp_ignore_bogus_error_responses"]'
      :resource_id: net.ipv4.icmp_ignore_bogus_error_responses
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002714169
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.7_Ensure_Reverse_Path_Filtering_is_enabled
    :title: Ensure Reverse Path Filtering is enabled
    :desc: |-
      Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).

      Rationale: Setting these flags is a good way to deter attackers from sending your system bogus packets that cannot be responded to. One instance where this feature breaks down is if asymmetrical routing is employed. This would occur when using dynamic routing protocols (bgp, ospf, etc) on your system. If you are using asymmetrical routing on your system, you will not be able to enable this feature without breaking the routing.
    :descriptions:
    - :label: default
      :data: |-
        Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).

        Rationale: Setting these flags is a good way to deter attackers from sending your system bogus packets that cannot be responded to. One instance where this feature breaks down is if asymmetrical routing is employed. This would occur when using dynamic routing protocols (bgp, ospf, etc) on your system. If you are using asymmetrical routing on your system, you will not be able to enable this feature without breaking the routing.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.7_Ensure_Reverse_Path_Filtering_is_enabled\"
      do\n  title \"Ensure Reverse Path Filtering is enabled\"\n  desc  \"\n    Setting
      net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces
      the Linux kernel to utilize reverse path filtering on a received packet to determine
      if the packet was valid. Essentially, with reverse path filtering, if the return
      packet does not go out the same interface that the corresponding source packet
      came from, the packet is dropped (and logged if log_martians is set).\n    \n
      \   Rationale: Setting these flags is a good way to deter attackers from sending
      your system bogus packets that cannot be responded to. One instance where this
      feature breaks down is if asymmetrical routing is employed. This would occur
      when using dynamic routing protocols (bgp, ospf, etc) on your system. If you
      are using asymmetrical routing on your system, you will not be able to enable
      this feature without breaking the routing.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n
      \ [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.conf.all.rp_filter\") do\n    its(\"value\")
      { should eq 1 }\n  end\n  files_1 = []\n  files_1 += files\n  describe files_1.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv4.conf.all.rp_filter\\s*=\\s*1\\s*$/ } do\n
      \   it { should_not be_empty }\n  end\n  describe kernel_parameter(\"net.ipv4.conf.default.rp_filter\")
      do\n    its(\"value\") { should eq 1 }\n  end\n  files_2 = []\n  files_2 +=
      files\n  describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv4.conf.default.rp_filter\\s*=\\s*1\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1707
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv4.conf.all.rp_filter value is expected to
        eq 1
      :run_time: 0.056155399
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: |2

        expected: 1
             got: 0

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.all.rp_filter"]'
      :resource_id: net.ipv4.conf.all.rp_filter
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002744828
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.conf.default.rp_filter value is expected
        to eq 1
      :run_time: 0.055442853
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.conf.default.rp_filter"]'
      :resource_id: net.ipv4.conf.default.rp_filter
    - :status: passed
      :code_desc: '["/usr/lib/sysctl.d/50-redhat.conf", "/lib/sysctl.d/50-redhat.conf"]
        is expected not to be empty'
      :run_time: 0.002598504
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.8_Ensure_TCP_SYN_Cookies_is_enabled
    :title: Ensure TCP SYN Cookies is enabled
    :desc: |-
      When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with the specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.

      Rationale: Attackers use SYN flood attacks to perform a denial of service attacked on a system by sending many SYN packets without completing the three way handshake. This will quickly use up slots in the kernel's half-open connection queue and prevent legitimate connections from succeeding. SYN cookies allow the system to keep accepting valid connections, even if under a denial of service attack.
    :descriptions:
    - :label: default
      :data: |-
        When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with the specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.

        Rationale: Attackers use SYN flood attacks to perform a denial of service attacked on a system by sending many SYN packets without completing the three way handshake. This will quickly use up slots in the kernel's half-open connection queue and prevent legitimate connections from succeeding. SYN cookies allow the system to keep accepting valid connections, even if under a denial of service attack.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.8_Ensure_TCP_SYN_Cookies_is_enabled\"
      do\n  title \"Ensure TCP SYN Cookies is enabled\"\n  desc  \"\n    When tcp_syncookies
      is set, the kernel will handle TCP SYN packets normally until the half-open
      connection queue is full, at which time, the SYN cookie functionality kicks
      in. SYN cookies work by not using the SYN queue at all. Instead, the kernel
      simply replies to the SYN with a SYN|ACK, but will include a specially crafted
      TCP sequence number that encodes the source and destination IP address and port
      number and the time the packet was sent. A legitimate connection would send
      the ACK packet of the three way handshake with the specially crafted sequence
      number. This allows the system to verify that it has received a valid response
      to a SYN cookie and allow the connection, even though there is no corresponding
      SYN in the queue.\n    \n    Rationale: Attackers use SYN flood attacks to perform
      a denial of service attacked on a system by sending many SYN packets without
      completing the three way handshake. This will quickly use up slots in the kernel's
      half-open connection queue and prevent legitimate connections from succeeding.
      SYN cookies allow the system to keep accepting valid connections, even if under
      a denial of service attack.\n  \"\n  impact 1.0\n  files = [\"/etc/sysctl.conf\"]\n
      \ [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter(\"net.ipv4.tcp_syncookies\") do\n    its(\"value\")
      { should eq 1 }\n  end\n  describe files.delete_if { |f| command(\"file #{f}
      | cut -d: -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~
      /^\\s*net.ipv4.tcp_syncookies\\s*=\\s*1\\s*$/ } do\n    it { should_not be_empty
      }\n  end\nend\n"
    :source_location:
      :line: 1737
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Kernel Parameter net.ipv4.tcp_syncookies value is expected to eq
        1
      :run_time: 0.056273462
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv4.tcp_syncookies"]'
      :resource_id: net.ipv4.tcp_syncookies
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002630801
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.3.9_Ensure_IPv6_router_advertisements_are_not_accepted
    :title: Ensure IPv6 router advertisements are not accepted
    :desc: |-
      This setting disables the system's ability to accept IPv6 router advertisements.

      Rationale: It is recommended that systems do not accept router advertisements as they could be tricked into routing traffic to compromised machines. Setting hard routes within the system (usually a single default route to a trusted router) protects the system from bad routes.
    :descriptions:
    - :label: default
      :data: |-
        This setting disables the system's ability to accept IPv6 router advertisements.

        Rationale: It is recommended that systems do not accept router advertisements as they could be tricked into routing traffic to compromised machines. Setting hard routes within the system (usually a single default route to a trusted router) protects the system from bad routes.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.3.9_Ensure_IPv6_router_advertisements_are_not_accepted\"
      do\n  title \"Ensure IPv6 router advertisements are not accepted\"\n  desc  \"\n
      \   This setting disables the system's ability to accept IPv6 router advertisements.\n
      \   \n    Rationale: It is recommended that systems do not accept router advertisements
      as they could be tricked into routing traffic to compromised machines. Setting
      hard routes within the system (usually a single default route to a trusted router)
      protects the system from bad routes.\n  \"\n  impact 1.0\n  ipv6 = bash(\"grep
      -Pqs '^\\\\h*0\\\\b' /sys/module/ipv6/parameters/disable && echo -e \\\"\\n
      - IPv6 is enabled\\n\\\" || echo -e \\\"\\n - IPv6 is not enabled\\n\\\"\").stdout\n
      \ only_if('This recommendation applies only if IPV6 is enabled on the system.')
      { ipv6.match(\"IPv6 is enabled\") }\n  files = [\"/etc/sysctl.conf\"]\n  [\"/run/sysctl.d/*.conf\",\"/etc/sysctl.d/*.conf\",\"/usr/local/lib/sysctl.d/*.conf\",\"/usr/lib/sysctl.d/*.conf\",\"/lib/sysctl.d/*.conf\"].each
      do | location |\n    files += command(\"find #{location} -type f\").stdout.split\n
      \ end\n  describe kernel_parameter('net.ipv6.conf.all.accept_ra') do\n    its('value')
      { should eq 0 }\n  end\n  files_1 = []\n  files_1 += files\n  describe files_1.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*net.ipv6.conf.all.accept_ra\\s*=\\s*0\\s*$/ } do\n
      \   it { should_not be_empty }\n  end\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra')
      do\n    its('value') { should eq 0 }\n  end\n  files_2 = []\n  files_2 += files\n
      \ describe files_2.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*net.ipv6.conf.default.accept_ra\\s*=\\s*0\\s*$/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 1757
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Kernel Parameter net.ipv6.conf.all.accept_ra value is expected to
        eq 0
      :run_time: 0.055653199
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.all.accept_ra"]'
      :resource_id: net.ipv6.conf.all.accept_ra
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.00263717
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: Kernel Parameter net.ipv6.conf.default.accept_ra value is expected
        to eq 0
      :run_time: 0.055839925
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: kernel_parameter
      :resource_params: '["net.ipv6.conf.default.accept_ra"]'
      :resource_id: net.ipv6.conf.default.accept_ra
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002686042
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.1.1_Ensure_nftables_is_installed
    :title: Ensure nftables is installed
    :desc: |-
      nftables provides a new in-kernel packet classification framework that is based on a network-specific Virtual Machine (VM) and a new nft userspace command line tool.

      nftables reuses the existing Netfilter subsystems such as the existing hook infrastructure, the connection tracking system, NAT, userspace queuing and logging subsystem.

      Rationale: nftables is a subsystem of the Linux kernel that can protect against threats originating from within a corporate network to include malicious mobile code and poorly configured software on a host.
    :descriptions:
    - :label: default
      :data: |-
        nftables provides a new in-kernel packet classification framework that is based on a network-specific Virtual Machine (VM) and a new nft userspace command line tool.

        nftables reuses the existing Netfilter subsystems such as the existing hook infrastructure, the connection tracking system, NAT, userspace queuing and logging subsystem.

        Rationale: nftables is a subsystem of the Linux kernel that can protect against threats originating from within a corporate network to include malicious mobile code and poorly configured software on a host.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.1.1_Ensure_nftables_is_installed\"
      do\n  title \"Ensure nftables is installed\"\n  desc  \"\n    nftables provides
      a new in-kernel packet classification framework that is based on a network-specific
      Virtual Machine (VM) and a new nft userspace command line tool.\n    \n    nftables
      reuses the existing Netfilter subsystems such as the existing hook infrastructure,
      the connection tracking system, NAT, userspace queuing and logging subsystem.\n
      \   \n    Rationale: nftables is a subsystem of the Linux kernel that can protect
      against threats originating from within a corporate network to include malicious
      mobile code and poorly configured software on a host.\n  \"\n  impact 1.0\n
      \ describe.one do\n    describe package('firewalld') do\n      it { should be_installed
      }\n    end\n    describe package('nftables') do\n      it { should be_installed
      }\n    end\n    describe package('iptables') do\n      it { should be_installed
      }\n    end\n  end\nend\n"
    :source_location:
      :line: 1789
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: System Package firewalld is expected to be installed
      :run_time: 0.000277119
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package firewalld` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["firewalld"]'
      :resource_id: firewalld
    - :status: failed
      :code_desc: System Package nftables is expected to be installed
      :run_time: 0.000165546
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package nftables` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: failed
      :code_desc: System Package iptables is expected to be installed
      :run_time: 0.000171363
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package iptables` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["iptables"]'
      :resource_id: iptables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.1.2_Ensure_a_single_firewall_configuration_utility_is_in_use
    :title: Ensure a single firewall configuration utility is in use
    :desc: |-
      FirewallD - Is a firewall service daemon that provides a dynamic customizable host-based firewall with a D-Bus interface. Being dynamic, it enables creating, changing, and deleting the rules without the necessity to restart the firewall daemon each time the rules are changed

      NFTables - Includes the nft utility for configuration of the nftables subsystem of the Linux kernel

      **Note:** firewalld with nftables backend does not support passing custom nftables rules to firewalld, using the --direct option.

      Rationale: In order to configure firewall rules for nftables, a firewall utility needs to be installed and active of the system. The use of more than one firewall utility may produce unexpected results.
    :descriptions:
    - :label: default
      :data: |-
        FirewallD - Is a firewall service daemon that provides a dynamic customizable host-based firewall with a D-Bus interface. Being dynamic, it enables creating, changing, and deleting the rules without the necessity to restart the firewall daemon each time the rules are changed

        NFTables - Includes the nft utility for configuration of the nftables subsystem of the Linux kernel

        **Note:** firewalld with nftables backend does not support passing custom nftables rules to firewalld, using the --direct option.

        Rationale: In order to configure firewall rules for nftables, a firewall utility needs to be installed and active of the system. The use of more than one firewall utility may produce unexpected results.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.1.2_Ensure_a_single_firewall_configuration_utility_is_in_use\"
      do\n  title \"Ensure a single firewall configuration utility is in use\"\n  desc
      \ \"\n    FirewallD - Is a firewall service daemon that provides a dynamic customizable
      host-based firewall with a D-Bus interface. Being dynamic, it enables creating,
      changing, and deleting the rules without the necessity to restart the firewall
      daemon each time the rules are changed\n    \n    NFTables - Includes the nft
      utility for configuration of the nftables subsystem of the Linux kernel\n    \n
      \   **Note:** firewalld with nftables backend does not support passing custom
      nftables rules to firewalld, using the --direct option.\n    \n    Rationale:
      In order to configure firewall rules for nftables, a firewall utility needs
      to be installed and active of the system. The use of more than one firewall
      utility may produce unexpected results.\n  \"\n  impact 1.0\n  describe.one
      do\n    describe package(\"iptables\") do\n      it { should be_installed }\n
      \   end\n    describe package(\"iptables-services\") do\n      it { should be_installed
      }\n    end\n    describe package(\"firewalld\") do\n      it { should be_installed
      }\n    end\n    describe package(\"nftables\") do\n      it { should be_installed
      }\n    end\n  end\nend\n"
    :source_location:
      :line: 1812
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: System Package iptables is expected to be installed
      :run_time: 0.000163308
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package iptables` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["iptables"]'
      :resource_id: iptables
    - :status: failed
      :code_desc: System Package iptables-services is expected to be installed
      :run_time: 0.000264267
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package iptables-services` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["iptables-services"]'
      :resource_id: iptables-services
    - :status: failed
      :code_desc: System Package firewalld is expected to be installed
      :run_time: 0.000158471
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package firewalld` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["firewalld"]'
      :resource_id: firewalld
    - :status: failed
      :code_desc: System Package nftables is expected to be installed
      :run_time: 0.000148861
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package nftables` is installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.1_Ensure_firewalld_default_zone_is_set
    :title: Ensure firewalld default zone is set
    :desc: |-
      A firewall zone defines the trust level for a connection, interface or source address binding. This is a one to many relation, which means that a connection, interface or source can only be part of one zone, but a zone can be used for many network connections, interfaces and sources.

      * The default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone.
      * If no zone assigned to a connection, interface or source, only the default zone is used.
      * The default zone is not always listed as being used for an interface or source as it will be used for it either way. This depends on the manager of the interfaces.
      Connections handled by NetworkManager are listed as NetworkManager requests to add the zone binding for the interface used by the connection. Also interfaces under control of the network service are listed also because the service requests it.

      **Note:**

      *  A firewalld zone configuration file contains the information for a zone. * These are the zone description, services, ports, protocols, icmp-blocks, masquerade, forward-ports and rich language rules in an XML file format.
      *  The file name has to be zone_name.xml where length of zone_name is currently limited to 17 chars.
      * NetworkManager binds interfaces to zones automatically

      Rationale: Because the default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone, if FirewallD is being used, it is important for the default zone to set
    :descriptions:
    - :label: default
      :data: |-
        A firewall zone defines the trust level for a connection, interface or source address binding. This is a one to many relation, which means that a connection, interface or source can only be part of one zone, but a zone can be used for many network connections, interfaces and sources.

        * The default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone.
        * If no zone assigned to a connection, interface or source, only the default zone is used.
        * The default zone is not always listed as being used for an interface or source as it will be used for it either way. This depends on the manager of the interfaces.
        Connections handled by NetworkManager are listed as NetworkManager requests to add the zone binding for the interface used by the connection. Also interfaces under control of the network service are listed also because the service requests it.

        **Note:**

        *  A firewalld zone configuration file contains the information for a zone. * These are the zone description, services, ports, protocols, icmp-blocks, masquerade, forward-ports and rich language rules in an XML file format.
        *  The file name has to be zone_name.xml where length of zone_name is currently limited to 17 chars.
        * NetworkManager binds interfaces to zones automatically

        Rationale: Because the default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone, if FirewallD is being used, it is important for the default zone to set
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.1_Ensure_firewalld_default_zone_is_set\"
      do\n  title \"Ensure firewalld default zone is set\"\n  desc  \"\n    A firewall
      zone defines the trust level for a connection, interface or source address binding.
      This is a one to many relation, which means that a connection, interface or
      source can only be part of one zone, but a zone can be used for many network
      connections, interfaces and sources.\n    \n    * The default zone is the zone
      that is used for everything that is not explicitly bound/assigned to another
      zone.\n    * If no zone assigned to a connection, interface or source, only
      the default zone is used.\n    * The default zone is not always listed as being
      used for an interface or source as it will be used for it either way. This depends
      on the manager of the interfaces.\n    Connections handled by NetworkManager
      are listed as NetworkManager requests to add the zone binding for the interface
      used by the connection. Also interfaces under control of the network service
      are listed also because the service requests it.\n    \n    **Note:**\n    \n
      \   *  A firewalld zone configuration file contains the information for a zone.
      * These are the zone description, services, ports, protocols, icmp-blocks, masquerade,
      forward-ports and rich language rules in an XML file format.\n    *  The file
      name has to be zone_name.xml where length of zone_name is currently limited
      to 17 chars.\n    * NetworkManager binds interfaces to zones automatically\n
      \   \n    Rationale: Because the default zone is the zone that is used for everything
      that is not explicitly bound/assigned to another zone, if FirewallD is being
      used, it is important for the default zone to set\n  \"\n  impact 1.0\n  describe.one
      do\n    describe file(\"/etc/firewalld/firewalld.conf\") do\n      its(\"content\")
      { should match(/^\\s*DefaultZone=\\S+/) }\n    end\n    describe package(\"firewalld\")
      do\n      it { should_not be_installed }\n    end\n    describe service(\"firewalld\")
      do\n      it { should_not be_enabled }\n    end\n  end\nend\n"
    :source_location:
      :line: 1840
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package firewalld is expected not to be installed
      :run_time: 0.0001423
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["firewalld"]'
      :resource_id: firewalld
    - :status: passed
      :code_desc: Service firewalld is expected not to be enabled
      :run_time: 0.000133314
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["firewalld"]'
      :resource_id: firewalld
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.2_Ensure_at_least_one_nftables_table_exists
    :title: Ensure at least one nftables table exists
    :desc: |-
      Tables hold chains. Each table only has one address family and only applies to packets of this family.  Tables can have one of five families.

      Rationale: Without a table, nftables will not filter network traffic.
    :descriptions:
    - :label: default
      :data: |-
        Tables hold chains. Each table only has one address family and only applies to packets of this family.  Tables can have one of five families.

        Rationale: Without a table, nftables will not filter network traffic.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.2_Ensure_at_least_one_nftables_table_exists\"
      do\n  title \"Ensure at least one nftables table exists\"\n  desc  \"\n    Tables
      hold chains. Each table only has one address family and only applies to packets
      of this family.  Tables can have one of five families.\n    \n    Rationale:
      Without a table, nftables will not filter network traffic.\n  \"\n  impact 1.0\n
      \ describe.one do\n    describe command('nft list tables') do\n      its('stdout')
      { should match(/^table\\s+\\S+\\s+\\S+/) }\n      its('exit_status') { should
      eq 0 }\n    end\n    describe package('nftables') do\n      it { should_not
      be_installed }\n    end\n    describe service('nftables') do\n      it { should_not
      be_enabled }\n    end\n  end\nend\n"
    :source_location:
      :line: 1872
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nftables is expected not to be installed
      :run_time: 0.000142964
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: passed
      :code_desc: Service nftables is expected not to be enabled
      :run_time: 9.2126e-05
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.3_Ensure_nftables_base_chains_exist
    :title: Ensure nftables base chains exist
    :desc: |-
      Chains are containers for rules. They exist in two kinds, base chains and regular chains. A base chain is an  entry  point  for packets from the networking stack, a regular chain may be used as jump target and is used for better rule organization.

      Rationale: If a base chain doesn't exist with a hook for input, forward, and delete, packets that would flow through those chains will not be touched by nftables.
    :descriptions:
    - :label: default
      :data: |-
        Chains are containers for rules. They exist in two kinds, base chains and regular chains. A base chain is an  entry  point  for packets from the networking stack, a regular chain may be used as jump target and is used for better rule organization.

        Rationale: If a base chain doesn't exist with a hook for input, forward, and delete, packets that would flow through those chains will not be touched by nftables.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.3_Ensure_nftables_base_chains_exist\"
      do\n  title \"Ensure nftables base chains exist\"\n  desc  \"\n    Chains are
      containers for rules. They exist in two kinds, base chains and regular chains.
      A base chain is an  entry  point  for packets from the networking stack, a regular
      chain may be used as jump target and is used for better rule organization.\n
      \   \n    Rationale: If a base chain doesn't exist with a hook for input, forward,
      and delete, packets that would flow through those chains will not be touched
      by nftables.\n  \"\n  impact 1.0\n  if package('nftables').installed? && service('nftables').enabled?\n
      \   describe command('nft list ruleset') do\n      its('stdout') { should match(/^\\s*\\S+\\s+\\S+\\s+hook\\s+input/)
      }\n      its('stdout') { should match(/^\\s*\\S+\\s+\\S+\\s+hook\\s+forward/)
      }\n      its('stdout') { should match(/^\\s*\\S+\\s+\\S+\\s+hook\\s+output/)
      }\n      its('exit_status') { should eq 0 }\n    end\n  else\n    describe.one
      do\n      describe package('nftables') do\n        it { should_not be_installed
      }\n      end\n      describe service('nftables') do\n        it { should_not
      be_enabled }\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 1894
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nftables is expected not to be installed
      :run_time: 0.000130874
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: passed
      :code_desc: Service nftables is expected not to be enabled
      :run_time: 0.000169405
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.4_Ensure_host_based_firewall_loopback_traffic_is_configured
    :title: Ensure host based firewall loopback traffic is configured
    :desc: |-
      Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network

      Rationale: Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure.
    :descriptions:
    - :label: default
      :data: |-
        Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network

        Rationale: Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.4_Ensure_host_based_firewall_loopback_traffic_is_configured\"
      do\n  title \"Ensure host based firewall loopback traffic is configured\"\n
      \ desc  \"\n    Configure the loopback interface to accept traffic. Configure
      all other interfaces to deny traffic to the loopback network\n    \n    Rationale:
      Loopback traffic is generated between processes on machine and is typically
      critical to operation of the system. The loopback interface is the only place
      that loopback network traffic should be seen, all other interfaces should ignore
      traffic on this network as an anti-spoofing measure.\n  \"\n  impact 1.0\n  if
      package('nftables').installed? && service('nftables').enabled?\n    describe
      command(\"nft list ruleset | awk '/hook input/,/}/' | grep 'iif \\\"lo\\\" accept'\")
      do\n      its('stdout') { should match(/^\\s*iif\\s+\"lo\"\\s+accept/) }\n      its('exit_status')
      { should eq 0 }\n    end\n    describe command(\"nft list ruleset | awk '/hook
      input/,/}/' | grep 'ip saddr'\") do\n      its('stdout') { should match(/^\\s*ip\\s+saddr\\s+127\\.0\\.0\\.0\\/8\\s+counter\\s+packets\\s+0\\s+bytes\\s+0\\s+drop/)
      }\n      its('exit_status') { should eq 0 }\n    end\n    if command(\"ip -6
      addr\").stdout.strip != \"\"\n      describe command(\"nft list ruleset | awk
      '/hook input/,/}/' | grep 'ip6 saddr'\") do\n        its('stdout') { should
      match(/^\\s*ip6\\s+saddr\\s+\\:\\:1\\s+counter\\s+packets\\s+0\\s+bytes\\s+0\\s+drop/)
      }\n        its('exit_status') { should eq 0 }\n      end\n    else\n      describe
      command(\"ip -6 addr\") do\n        its('stdout') { should be_empty }\n      end\n
      \   end\n  else\n    describe.one do\n      describe package('nftables') do\n
      \       it { should_not be_installed }\n      end\n      describe service('nftables')
      do\n        it { should_not be_enabled }\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 1921
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nftables is expected not to be installed
      :run_time: 0.000147564
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: passed
      :code_desc: Service nftables is expected not to be enabled
      :run_time: 8.7972e-05
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.5_Ensure_firewalld_drops_unnecessary_services_and_ports
    :title: Ensure firewalld drops unnecessary services and ports
    :desc: |-
      Services and ports can be accepted or explicitly rejected or dropped by a zone.

      For every zone, you can set a default behavior that handles incoming traffic that is not further specified. Such behavior is defined by setting the target of the zone. There are three options - default, ACCEPT, REJECT, and DROP.

      * ACCEPT - you accept all incoming packets except those disabled by a specific rule.
      * REJECT - you disable all incoming packets except those that you have allowed in specific rules and the source machine is informed about the rejection.
      * DROP - you disable all incoming packets except those that you have allowed in specific rules and no information sent to the source machine.

      Rationale: To reduce the attack surface of a system, all services and ports should be blocked unless required
    :descriptions:
    - :label: default
      :data: |-
        Services and ports can be accepted or explicitly rejected or dropped by a zone.

        For every zone, you can set a default behavior that handles incoming traffic that is not further specified. Such behavior is defined by setting the target of the zone. There are three options - default, ACCEPT, REJECT, and DROP.

        * ACCEPT - you accept all incoming packets except those disabled by a specific rule.
        * REJECT - you disable all incoming packets except those that you have allowed in specific rules and the source machine is informed about the rejection.
        * DROP - you disable all incoming packets except those that you have allowed in specific rules and no information sent to the source machine.

        Rationale: To reduce the attack surface of a system, all services and ports should be blocked unless required
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.5_Ensure_firewalld_drops_unnecessary_services_and_ports\"
      do\n  title \"Ensure firewalld drops unnecessary services and ports\"\n  desc
      \ \"\n    Services and ports can be accepted or explicitly rejected or dropped
      by a zone.\n    \n    For every zone, you can set a default behavior that handles
      incoming traffic that is not further specified. Such behavior is defined by
      setting the target of the zone. There are three options - default, ACCEPT, REJECT,
      and DROP.\n    \n    * ACCEPT - you accept all incoming packets except those
      disabled by a specific rule.\n    * REJECT - you disable all incoming packets
      except those that you have allowed in specific rules and the source machine
      is informed about the rejection.\n    * DROP - you disable all incoming packets
      except those that you have allowed in specific rules and no information sent
      to the source machine.\n    \n    Rationale: To reduce the attack surface of
      a system, all services and ports should be blocked unless required\n  \"\n  impact
      0.0\n  describe \"Ensure_firewalld_drops_unnecessary_services_and_ports\" do\n
      \   skip \"Run the following command and review output to ensure that listed
      services and ports follow site policy. : # firewall-cmd --get-active-zones |
      awk '!/:/ {print $1}' | while read ZN; do firewall-cmd --list-all --zone=$ZN;
      done \"\n  end\nend\n"
    :source_location:
      :line: 1960
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure_firewalld_drops_unnecessary_services_and_ports
      :run_time: 5.244e-06
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource: ''
      :skip_message: 'Run the following command and review output to ensure that listed
        services and ports follow site policy. : # firewall-cmd --get-active-zones
        | awk ''!/:/ {print $1}'' | while read ZN; do firewall-cmd --list-all --zone=$ZN;
        done '
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure_firewalld_drops_unnecessary_services_and_ports
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.6_Ensure_nftables_established_connections_are_configured
    :title: Ensure nftables established connections are configured
    :desc: |-
      Configure the firewall rules for new outbound and established connections

      Rationale: If rules are not in place for established connections, all packets will be dropped by the default policy preventing network usage.
    :descriptions:
    - :label: default
      :data: |-
        Configure the firewall rules for new outbound and established connections

        Rationale: If rules are not in place for established connections, all packets will be dropped by the default policy preventing network usage.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.6_Ensure_nftables_established_connections_are_configured\"
      do\n  title \"Ensure nftables established connections are configured\"\n  desc
      \ \"\n    Configure the firewall rules for new outbound and established connections\n
      \   \n    Rationale: If rules are not in place for established connections,
      all packets will be dropped by the default policy preventing network usage.\n
      \ \"\n  impact 0.0\n  if package('nftables').installed? && service('nftables').enabled?\n
      \   ruleset_options = [\"input\",\"output\"]\n    ruleset_options.each do |option|\n
      \     rulesets = command(\"nft list ruleset | awk '/hook #{option}/,/}/' | grep
      -E 'ip protocol (tcp|udp|icmp) ct state'\").stdout.scan(/.+/)\n      describe
      rulesets do\n        its(\"length\") { should be > 0 }\n      end\n      describe.one
      do\n        rulesets.each do |entry|\n          describe entry do\n            it
      { should match(entry) }\n          end\n        end\n      end\n    end\n  else\n
      \   describe.one do\n      describe package('nftables') do\n        it { should_not
      be_installed }\n      end\n      describe service('nftables') do\n        it
      { should_not be_enabled }\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 1979
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nftables is expected not to be installed
      :run_time: 0.000127066
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: passed
      :code_desc: Service nftables is expected not to be enabled
      :run_time: 8.5265e-05
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_3.4.2.7_Ensure_nftables_default_deny_firewall_policy
    :title: Ensure nftables default deny firewall policy
    :desc: |-
      Base chain policy is the default verdict that will be applied to packets reaching the end of the chain.

      Rationale: There are two policies: accept (Default) and drop.  If the policy is set to accept , the firewall will accept any packet that is not configured to be denied and the packet will continue traversing the network stack.

      It is easier to explicitly permit acceptable usage than to deny unacceptable usage.

      **Note:** Changing firewall settings while connected over the network can result in being locked out of the system.
    :descriptions:
    - :label: default
      :data: |-
        Base chain policy is the default verdict that will be applied to packets reaching the end of the chain.

        Rationale: There are two policies: accept (Default) and drop.  If the policy is set to accept , the firewall will accept any packet that is not configured to be denied and the packet will continue traversing the network stack.

        It is easier to explicitly permit acceptable usage than to deny unacceptable usage.

        **Note:** Changing firewall settings while connected over the network can result in being locked out of the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_3.4.2.7_Ensure_nftables_default_deny_firewall_policy\"
      do\n  title \"Ensure nftables default deny firewall policy\"\n  desc  \"\n    Base
      chain policy is the default verdict that will be applied to packets reaching
      the end of the chain.\n    \n    Rationale: There are two policies: accept (Default)
      and drop.  If the policy is set to accept , the firewall will accept any packet
      that is not configured to be denied and the packet will continue traversing
      the network stack.\n    \n    It is easier to explicitly permit acceptable usage
      than to deny unacceptable usage.\n    \n    **Note:** Changing firewall settings
      while connected over the network can result in being locked out of the system.\n
      \ \"\n  impact 1.0\n  if package('nftables').installed? && service('nftables').enabled?\n
      \   describe command(\"nft list ruleset | grep 'hook input'\") do\n      its('stdout')
      { should match(/^.*policy\\s*drop;$/) }\n      its('exit_status') { should eq
      0 }\n    end\n    describe command(\"nft list ruleset | grep 'hook forward'\")
      do\n      its('stdout') { should match(/^.*policy\\s*drop;$/) }\n      its('exit_status')
      { should eq 0 }\n    end\n    describe command(\"nft list ruleset | grep 'hook
      output'\") do\n      its('stdout') { should match(/^.*policy\\s*drop;$/) }\n
      \     its('exit_status') { should eq 0 }\n    end\n  else\n    describe.one
      do\n      describe package('nftables') do\n        it { should_not be_installed
      }\n      end\n      describe service('nftables') do\n        it { should_not
      be_enabled }\n      end\n    end\n  end\nend\n"
    :source_location:
      :line: 2014
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package nftables is expected not to be installed
      :run_time: 0.00012074
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["nftables"]'
      :resource_id: nftables
    - :status: passed
      :code_desc: Service nftables is expected not to be enabled
      :run_time: 8.4381e-05
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["nftables"]'
      :resource_id: nftables
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.1_Ensure_rsyslog_is_installed
    :title: Ensure rsyslog is installed
    :desc: |-
      The rsyslog software is recommended in environments where journald does not meet operation requirements.

      Rationale: The security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server) justify installing and configuring the package.
    :descriptions:
    - :label: default
      :data: |-
        The rsyslog software is recommended in environments where journald does not meet operation requirements.

        Rationale: The security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server) justify installing and configuring the package.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.1_Ensure_rsyslog_is_installed\"
      do\n  title \"Ensure rsyslog is installed\"\n  desc  \"\n    The rsyslog software
      is recommended in environments where journald does not meet operation requirements.\n
      \   \n    Rationale: The security enhancements of rsyslog such as connection-oriented
      (i.e. TCP) transmission of logs, the option to log to database formats, and
      the encryption of log data en route to a central logging server) justify installing
      and configuring the package.\n  \"\n  impact 1.0\n  describe package(\"rsyslog\")
      do\n    it { should be_installed }\n  end\nend\n"
    :source_location:
      :line: 2051
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package rsyslog is expected to be installed
      :run_time: 0.058558821
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: package
      :resource_params: '["rsyslog"]'
      :resource_id: rsyslog
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.2_Ensure_rsyslog_service_is_enabled
    :title: Ensure rsyslog service is enabled
    :desc: |-
      Once the rsyslog package is installed, ensure that the service is enabled.

      Rationale: If the rsyslog service is not enabled to start on boot, the system will not capture logging events.
    :descriptions:
    - :label: default
      :data: |-
        Once the rsyslog package is installed, ensure that the service is enabled.

        Rationale: If the rsyslog service is not enabled to start on boot, the system will not capture logging events.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.2_Ensure_rsyslog_service_is_enabled\"
      do\n  title \"Ensure rsyslog service is enabled\"\n  desc  \"\n    Once the
      rsyslog package is installed, ensure that the service is enabled.\n    \n    Rationale:
      If the rsyslog service is not enabled to start on boot, the system will not
      capture logging events.\n  \"\n  impact 1.0\n  describe service(\"rsyslog\")
      do\n    it { should be_enabled }\n  end\nend\n"
    :source_location:
      :line: 2064
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Service rsyslog is expected to be enabled
      :run_time: 0.191882502
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: service
      :resource_params: '["rsyslog"]'
      :resource_id: rsyslog
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.3_Ensure_journald_is_configured_to_send_logs_to_rsyslog
    :title: Ensure journald is configured to send logs to rsyslog
    :desc: |-
      Data from journald may be stored in volatile memory or persisted locally on the server.  Utilities exist to accept remote export of journald logs, however, use of the RSyslog service provides a consistent means of log collection and export.

      Rationale: **IF** RSyslog is the preferred method for capturing logs, all logs of the system should be sent to it for further processing.

      **Note:** This recommendation only applies if rsyslog is the chosen method for client side logging. Do not apply this recommendation if journald is used.
    :descriptions:
    - :label: default
      :data: |-
        Data from journald may be stored in volatile memory or persisted locally on the server.  Utilities exist to accept remote export of journald logs, however, use of the RSyslog service provides a consistent means of log collection and export.

        Rationale: **IF** RSyslog is the preferred method for capturing logs, all logs of the system should be sent to it for further processing.

        **Note:** This recommendation only applies if rsyslog is the chosen method for client side logging. Do not apply this recommendation if journald is used.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.3_Ensure_journald_is_configured_to_send_logs_to_rsyslog\"
      do\n  title \"Ensure journald is configured to send logs to rsyslog\"\n  desc
      \ \"\n    Data from journald may be stored in volatile memory or persisted locally
      on the server.  Utilities exist to accept remote export of journald logs, however,
      use of the RSyslog service provides a consistent means of log collection and
      export.\n    \n    Rationale: **IF** RSyslog is the preferred method for capturing
      logs, all logs of the system should be sent to it for further processing.\n
      \   \n    **Note:** This recommendation only applies if rsyslog is the chosen
      method for client side logging. Do not apply this recommendation if journald
      is used.\n  \"\n  impact 0.0\n  describe file(\"/etc/systemd/journald.conf\")
      do\n    its(\"content\") { should match(/^\\s*(?i)ForwardToSyslog\\s*=\\s*yes(\\s+#.*)*$/)
      }\n  end\nend\n"
    :source_location:
      :line: 2077
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/systemd/journald.conf content is expected to match /^\s*(?i)ForwardToSyslog\s*=\s*yes(\s+#.*)*$/
      :run_time: 0.060724615
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: |
        expected "#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or mod...LevelKMsg=notice\n#MaxLevelConsole=info\n#MaxLevelWall=emerg\n#LineMax=48K\n#ReadKMsg=yes\nAudit=\n" to match /^\s*(?i)ForwardToSyslog\s*=\s*yes(\s+#.*)*$/
        Diff:
        @@ -1,47 +1,93 @@
        -/^\s*(?i)ForwardToSyslog\s*=\s*yes(\s+#.*)*$/
        +#  This file is part of systemd.
        +#
        +#  systemd is free software; you can redistribute it and/or modify it under the
        +#  terms of the GNU Lesser General Public License as published by the Free
        +#  Software Foundation; either version 2.1 of the License, or (at your option)
        +#  any later version.
        +#
        +# Entries in this file show the compile time defaults. Local configuration
        +# should be created by either modifying this file, or by creating "drop-ins" in
        +# the journald.conf.d/ subdirectory. The latter is generally recommended.
        +# Defaults can be restored by simply deleting this file and all drop-ins.
        +#
        +# Use 'systemd-analyze cat-config systemd/journald.conf' to display the full config.
        +#
        +# See journald.conf(5) for details.
        +
        +[Journal]
        +#Storage=auto
        +#Compress=yes
        +#Seal=yes
        +#SplitMode=uid
        +#SyncIntervalSec=5m
        +#RateLimitIntervalSec=30s
        +#RateLimitBurst=10000
        +#SystemMaxUse=
        +#SystemKeepFree=
        +#SystemMaxFileSize=
        +#SystemMaxFiles=100
        +#RuntimeMaxUse=
        +#RuntimeKeepFree=
        +#RuntimeMaxFileSize=
        +#RuntimeMaxFiles=100
        +#MaxRetentionSec=
        +#MaxFileSec=1month
        +#ForwardToSyslog=no
        +#ForwardToKMsg=no
        +#ForwardToConsole=no
        +#ForwardToWall=yes
        +#TTYPath=/dev/console
        +#MaxLevelStore=debug
        +#MaxLevelSyslog=debug
        +#MaxLevelKMsg=notice
        +#MaxLevelConsole=info
        +#MaxLevelWall=emerg
        +#LineMax=48K
        +#ReadKMsg=yes
        +Audit=
      :resource_class: file
      :resource_params: '["/etc/systemd/journald.conf"]'
      :resource_id: "/etc/systemd/journald.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.4_Ensure_rsyslog_default_file_permissions_are_configured
    :title: Ensure rsyslog default file permissions are configured
    :desc: |-
      RSyslog will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files.

      Rationale: It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.
    :descriptions:
    - :label: default
      :data: |-
        RSyslog will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files.

        Rationale: It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.4_Ensure_rsyslog_default_file_permissions_are_configured\"
      do\n  title \"Ensure rsyslog default file permissions are configured\"\n  desc
      \ \"\n    RSyslog will create logfiles that do not already exist on the system.
      This setting controls what permissions will be applied to these newly created
      files.\n    \n    Rationale: It is important to ensure that log files have the
      correct permissions to ensure that sensitive data is archived and protected.\n
      \ \"\n  impact 1.0\n  describe.one do\n    describe file(\"/etc/rsyslog.conf\")
      do\n      its(\"content\") { should match(/(?i)^\\h*\\$FileCreateMode\\s+0[6420][40]0\\b/)
      }\n    end\n    files = command(\"find /etc/rsyslog.d/ -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /(?i)^\\h*\\$FileCreateMode\\s+0[6420][40]0\\b/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 2092
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/rsyslog.conf content is expected to match /(?i)^\h*\$FileCreateMode\s+0[6420][40]0\b/
      :run_time: 0.000858438
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: "expected \"# rsyslog configuration file\\n\\n# For more information
        see /usr/share/doc/rsyslog-*/rsyslog_conf.htm....g. 192.168.0.1, port optional
        e.g. 10514\\n#Target=\\\"remote_host\\\" Port=\\\"XXX\\\" Protocol=\\\"tcp\\\")\\n\"
        to match /(?i)^\\h*\\$FileCreateMode\\s+0[6420][40]0\\b/\nDiff:\n@@ -1,80
        +1,159 @@\n-/(?i)^\\h*\\$FileCreateMode\\s+0[6420][40]0\\b/\n+# rsyslog configuration
        file\n+\n+# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html\n+#
        or latest version online at http://www.rsyslog.com/doc/rsyslog_conf.html \n+#
        If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html\n+\n+####
        GLOBAL DIRECTIVES ####\n+\n+# Where to place auxiliary files\n+global(workDirectory=\"/var/lib/rsyslog\")\n+\n+#
        Use default timestamp format\n+module(load=\"builtin:omfile\" Template=\"RSYSLOG_TraditionalFileFormat\")\n+\n+####
        MODULES ####\n+\n+module(load=\"imuxsock\" \t  # provides support for local
        system logging (e.g. via logger command)\n+       SysSock.Use=\"off\") # Turn
        off message reception via local log socket; \n+\t\t\t  # local messages are
        retrieved through imjournal now.\n+module(load=\"imjournal\" \t    # provides
        access to the systemd journal\n+       UsePid=\"system\" # PID nummber is
        retrieved as the ID of the process the journal entry originates from\n+       StateFile=\"imjournal.state\")
        # File to store the position in the journal\n+#module(load=\"imklog\") # reads
        kernel messages (the same are read from journald)\n+#module(load=\"immark\")
        # provides --MARK-- message capability\n+\n+# Include all config files in
        /etc/rsyslog.d/\n+include(file=\"/etc/rsyslog.d/*.conf\" mode=\"optional\")\n+\n+#
        Provides UDP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imudp.html\n+#module(load=\"imudp\")
        # needs to be done just once\n+#input(type=\"imudp\" port=\"514\")\n+\n+#
        Provides TCP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imtcp.html\n+#module(load=\"imtcp\")
        # needs to be done just once\n+#input(type=\"imtcp\" port=\"514\")\n+\n+####
        RULES ####\n+\n+# Log all kernel messages to the console.\n+# Logging much
        else clutters up the screen.\n+#kern.*                                                 /dev/console\n+\n+#
        Log anything (except mail) of level info or higher.\n+# Don't log private
        authentication messages!\n+*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n+\n+#
        The authpriv file has restricted access.\n+authpriv.*                                              /var/log/secure\n+\n+#
        Log all the mail messages in one place.\n+mail.*                                                  -/var/log/maillog\n+\n+\n+#
        Log cron stuff\n+cron.*                                                  /var/log/cron\n+\n+#
        Everybody gets emergency messages\n+*.emerg                                                 :omusrmsg:*\n+\n+#
        Save news errors of level crit and higher in a special file.\n+uucp,news.crit
        \                                         /var/log/spooler\n+\n+# Save boot
        messages also to boot.log\n+local7.*                                                /var/log/boot.log\n+\n+\n+#
        ### sample forwarding rule ###\n+#action(type=\"omfwd\"  \n+# # An on-disk
        queue is created for this action. If the remote host is\n+# # down, messages
        are spooled to disk and sent when it is up again.\n+#queue.filename=\"fwdRule1\"
        \      # unique name prefix for spool files\n+#queue.maxdiskspace=\"1g\"         #
        1gb space limit (use as much as possible)\n+#queue.saveonshutdown=\"on\"       #
        save messages to disk on shutdown\n+#queue.type=\"LinkedList\"         # run
        asynchronously\n+#action.resumeRetryCount=\"-1\"    # infinite retries if
        host is down\n+# # Remote Logging (we use TCP for reliable delivery)\n+# #
        remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514\n+#Target=\"remote_host\"
        Port=\"XXX\" Protocol=\"tcp\")\n"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000204536
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.5_Ensure_logging_is_configured
    :title: Ensure logging is configured
    :desc: |-
      The /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files specifies rules for logging and which files are to be used to log certain classes of messages.

      Rationale: A great deal of important security-related information is sent via rsyslog (e.g., successful and failed su attempts, failed login attempts, root login attempts, etc.).
    :descriptions:
    - :label: default
      :data: |-
        The /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files specifies rules for logging and which files are to be used to log certain classes of messages.

        Rationale: A great deal of important security-related information is sent via rsyslog (e.g., successful and failed su attempts, failed login attempts, root login attempts, etc.).
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.5_Ensure_logging_is_configured\"
      do\n  title \"Ensure logging is configured\"\n  desc  \"\n    The /etc/rsyslog.conf
      and /etc/rsyslog.d/*.conf files specifies rules for logging and which files
      are to be used to log certain classes of messages.\n    \n    Rationale: A great
      deal of important security-related information is sent via rsyslog (e.g., successful
      and failed su attempts, failed login attempts, root login attempts, etc.).\n
      \ \"\n  impact 0.0\n  describe \"Ensure logging is configured\" do\n    skip
      \"Review the contents of /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files to
      ensure appropriate logging is set. In addition, run the following command and
      verify that the log files are logging information as expected: # ls -l /var/log/\"\n
      \ end\nend\n"
    :source_location:
      :line: 2111
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure logging is configured
      :run_time: 5.707e-06
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource: ''
      :skip_message: 'Review the contents of /etc/rsyslog.conf and /etc/rsyslog.d/*.conf
        files to ensure appropriate logging is set. In addition, run the following
        command and verify that the log files are logging information as expected:
        # ls -l /var/log/'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure logging is configured
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.6_Ensure_rsyslog_is_configured_to_send_logs_to_a_remote_log_host
    :title: Ensure rsyslog is configured to send logs to a remote log host
    :desc: |-
      RSyslog supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

      Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :descriptions:
    - :label: default
      :data: |-
        RSyslog supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

        Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.6_Ensure_rsyslog_is_configured_to_send_logs_to_a_remote_log_host\"
      do\n  title \"Ensure rsyslog is configured to send logs to a remote log host\"\n
      \ desc  \"\n    RSyslog supports the ability to send log events it gathers to
      a remote log host or to receive messages from remote hosts, thus enabling centralized
      log management.\n    \n    Rationale: Storing log data on a remote host protects
      log integrity from local attacks. If an attacker gains root access on the local
      system, they could tamper with or remove log data that is stored on the local
      system.\n  \"\n  impact 0.0\n  describe.one do\n    describe file(\"/etc/rsyslog.conf\")
      do\n      its(\"content\") { should match(/^\\s*\\*\\.\\*\\s+@/) }\n    end\n
      \   files = command(\"find /etc/rsyslog.d/ -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*\\*\\.\\*\\s+@/ }
      do\n      it { should_not be_empty }\n    end\n    describe file(\"/etc/rsyslog.conf\")
      do\n      its(\"content\") { should match(/^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\\"?[^#\"]+\\\"?\\b/)
      }\n    end\n    files = command(\"find /etc/rsyslog.d/ -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\\"?[^#\"]+\\\"?\\b/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 2124
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/rsyslog.conf content is expected to match /^\s*\*\.\*\s+@/
      :run_time: 0.00074254
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: "expected \"# rsyslog configuration file\\n\\n# For more information
        see /usr/share/doc/rsyslog-*/rsyslog_conf.htm....g. 192.168.0.1, port optional
        e.g. 10514\\n#Target=\\\"remote_host\\\" Port=\\\"XXX\\\" Protocol=\\\"tcp\\\")\\n\"
        to match /^\\s*\\*\\.\\*\\s+@/\nDiff:\n@@ -1,80 +1,159 @@\n-/^\\s*\\*\\.\\*\\s+@/\n+#
        rsyslog configuration file\n+\n+# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html\n+#
        or latest version online at http://www.rsyslog.com/doc/rsyslog_conf.html \n+#
        If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html\n+\n+####
        GLOBAL DIRECTIVES ####\n+\n+# Where to place auxiliary files\n+global(workDirectory=\"/var/lib/rsyslog\")\n+\n+#
        Use default timestamp format\n+module(load=\"builtin:omfile\" Template=\"RSYSLOG_TraditionalFileFormat\")\n+\n+####
        MODULES ####\n+\n+module(load=\"imuxsock\" \t  # provides support for local
        system logging (e.g. via logger command)\n+       SysSock.Use=\"off\") # Turn
        off message reception via local log socket; \n+\t\t\t  # local messages are
        retrieved through imjournal now.\n+module(load=\"imjournal\" \t    # provides
        access to the systemd journal\n+       UsePid=\"system\" # PID nummber is
        retrieved as the ID of the process the journal entry originates from\n+       StateFile=\"imjournal.state\")
        # File to store the position in the journal\n+#module(load=\"imklog\") # reads
        kernel messages (the same are read from journald)\n+#module(load=\"immark\")
        # provides --MARK-- message capability\n+\n+# Include all config files in
        /etc/rsyslog.d/\n+include(file=\"/etc/rsyslog.d/*.conf\" mode=\"optional\")\n+\n+#
        Provides UDP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imudp.html\n+#module(load=\"imudp\")
        # needs to be done just once\n+#input(type=\"imudp\" port=\"514\")\n+\n+#
        Provides TCP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imtcp.html\n+#module(load=\"imtcp\")
        # needs to be done just once\n+#input(type=\"imtcp\" port=\"514\")\n+\n+####
        RULES ####\n+\n+# Log all kernel messages to the console.\n+# Logging much
        else clutters up the screen.\n+#kern.*                                                 /dev/console\n+\n+#
        Log anything (except mail) of level info or higher.\n+# Don't log private
        authentication messages!\n+*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n+\n+#
        The authpriv file has restricted access.\n+authpriv.*                                              /var/log/secure\n+\n+#
        Log all the mail messages in one place.\n+mail.*                                                  -/var/log/maillog\n+\n+\n+#
        Log cron stuff\n+cron.*                                                  /var/log/cron\n+\n+#
        Everybody gets emergency messages\n+*.emerg                                                 :omusrmsg:*\n+\n+#
        Save news errors of level crit and higher in a special file.\n+uucp,news.crit
        \                                         /var/log/spooler\n+\n+# Save boot
        messages also to boot.log\n+local7.*                                                /var/log/boot.log\n+\n+\n+#
        ### sample forwarding rule ###\n+#action(type=\"omfwd\"  \n+# # An on-disk
        queue is created for this action. If the remote host is\n+# # down, messages
        are spooled to disk and sent when it is up again.\n+#queue.filename=\"fwdRule1\"
        \      # unique name prefix for spool files\n+#queue.maxdiskspace=\"1g\"         #
        1gb space limit (use as much as possible)\n+#queue.saveonshutdown=\"on\"       #
        save messages to disk on shutdown\n+#queue.type=\"LinkedList\"         # run
        asynchronously\n+#action.resumeRetryCount=\"-1\"    # infinite retries if
        host is down\n+# # Remote Logging (we use TCP for reliable delivery)\n+# #
        remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514\n+#Target=\"remote_host\"
        Port=\"XXX\" Protocol=\"tcp\")\n"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.017012152
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: File /etc/rsyslog.conf content is expected to match /^\s*([^#]+\s+)?action\(([^#]+\s+)?\btarget=\"?[^#"]+\"?\b/
      :run_time: 0.001199991
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: "expected \"# rsyslog configuration file\\n\\n# For more information
        see /usr/share/doc/rsyslog-*/rsyslog_conf.htm....g. 192.168.0.1, port optional
        e.g. 10514\\n#Target=\\\"remote_host\\\" Port=\\\"XXX\\\" Protocol=\\\"tcp\\\")\\n\"
        to match /^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\\"?[^#\"]+\\\"?\\b/\nDiff:\n@@
        -1,80 +1,159 @@\n-/^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\\"?[^#\"]+\\\"?\\b/\n+#
        rsyslog configuration file\n+\n+# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html\n+#
        or latest version online at http://www.rsyslog.com/doc/rsyslog_conf.html \n+#
        If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html\n+\n+####
        GLOBAL DIRECTIVES ####\n+\n+# Where to place auxiliary files\n+global(workDirectory=\"/var/lib/rsyslog\")\n+\n+#
        Use default timestamp format\n+module(load=\"builtin:omfile\" Template=\"RSYSLOG_TraditionalFileFormat\")\n+\n+####
        MODULES ####\n+\n+module(load=\"imuxsock\" \t  # provides support for local
        system logging (e.g. via logger command)\n+       SysSock.Use=\"off\") # Turn
        off message reception via local log socket; \n+\t\t\t  # local messages are
        retrieved through imjournal now.\n+module(load=\"imjournal\" \t    # provides
        access to the systemd journal\n+       UsePid=\"system\" # PID nummber is
        retrieved as the ID of the process the journal entry originates from\n+       StateFile=\"imjournal.state\")
        # File to store the position in the journal\n+#module(load=\"imklog\") # reads
        kernel messages (the same are read from journald)\n+#module(load=\"immark\")
        # provides --MARK-- message capability\n+\n+# Include all config files in
        /etc/rsyslog.d/\n+include(file=\"/etc/rsyslog.d/*.conf\" mode=\"optional\")\n+\n+#
        Provides UDP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imudp.html\n+#module(load=\"imudp\")
        # needs to be done just once\n+#input(type=\"imudp\" port=\"514\")\n+\n+#
        Provides TCP syslog reception\n+# for parameters see http://www.rsyslog.com/doc/imtcp.html\n+#module(load=\"imtcp\")
        # needs to be done just once\n+#input(type=\"imtcp\" port=\"514\")\n+\n+####
        RULES ####\n+\n+# Log all kernel messages to the console.\n+# Logging much
        else clutters up the screen.\n+#kern.*                                                 /dev/console\n+\n+#
        Log anything (except mail) of level info or higher.\n+# Don't log private
        authentication messages!\n+*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n+\n+#
        The authpriv file has restricted access.\n+authpriv.*                                              /var/log/secure\n+\n+#
        Log all the mail messages in one place.\n+mail.*                                                  -/var/log/maillog\n+\n+\n+#
        Log cron stuff\n+cron.*                                                  /var/log/cron\n+\n+#
        Everybody gets emergency messages\n+*.emerg                                                 :omusrmsg:*\n+\n+#
        Save news errors of level crit and higher in a special file.\n+uucp,news.crit
        \                                         /var/log/spooler\n+\n+# Save boot
        messages also to boot.log\n+local7.*                                                /var/log/boot.log\n+\n+\n+#
        ### sample forwarding rule ###\n+#action(type=\"omfwd\"  \n+# # An on-disk
        queue is created for this action. If the remote host is\n+# # down, messages
        are spooled to disk and sent when it is up again.\n+#queue.filename=\"fwdRule1\"
        \      # unique name prefix for spool files\n+#queue.maxdiskspace=\"1g\"         #
        1gb space limit (use as much as possible)\n+#queue.saveonshutdown=\"on\"       #
        save messages to disk on shutdown\n+#queue.type=\"LinkedList\"         # run
        asynchronously\n+#action.resumeRetryCount=\"-1\"    # infinite retries if
        host is down\n+# # Remote Logging (we use TCP for reliable delivery)\n+# #
        remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514\n+#Target=\"remote_host\"
        Port=\"XXX\" Protocol=\"tcp\")\n"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000176973
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.1.7_Ensure_rsyslog_is_not_configured_to_receive_logs_from_a_remote_client
    :title: Ensure rsyslog is not configured to receive logs from a remote client
    :desc: |-
      RSyslog supports the ability to receive messages from remote hosts, thus acting as a log server. Clients should not receive data from other hosts.

      Rationale: If a client is configured to also receive data, thus turning it into a server, the client system is acting outside its operational boundary.
    :descriptions:
    - :label: default
      :data: |-
        RSyslog supports the ability to receive messages from remote hosts, thus acting as a log server. Clients should not receive data from other hosts.

        Rationale: If a client is configured to also receive data, thus turning it into a server, the client system is acting outside its operational boundary.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.1.7_Ensure_rsyslog_is_not_configured_to_receive_logs_from_a_remote_client\"
      do\n  title \"Ensure rsyslog is not configured to receive logs from a remote
      client\"\n  desc  \"\n    RSyslog supports the ability to receive messages from
      remote hosts, thus acting as a log server. Clients should not receive data from
      other hosts.\n    \n    Rationale: If a client is configured to also receive
      data, thus turning it into a server, the client system is acting outside its
      operational boundary.\n  \"\n  impact 1.0\n  describe file(\"/etc/rsyslog.conf\")
      do\n    its(\"content\") { should_not match(/\\$ModLoad imtcp/) }\n    its(\"content\")
      { should_not match(/\\$InputTCPServerRun/) }\n  end\n  files = command(\"find
      /etc/rsyslog.d/ -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n
      \ describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /\\$ModLoad imtcp/ } do\n
      \   it { should be_empty }\n  end\n  files = command(\"find /etc/rsyslog.d/
      -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n  describe files.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /\\$InputTCPServerRun/ } do\n    it { should be_empty
      }\n  end\n  describe file(\"/etc/rsyslog.conf\") do\n    its(\"content\") {
      should_not match(/^\\s*module\\(load=\"imtcp\"\\)\\s*$/) }\n    its(\"content\")
      { should_not match(/^\\s*input\\(type=\"imtcp\" port=\"514\"\\)\\s*$/) }\n  end\n
      \ files = command(\"find /etc/rsyslog.d/ -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n
      \ describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^\\s*module\\(load=\"imtcp\"\\)\\s*$/
      } do\n    it { should be_empty }\n  end\n  files = command(\"find /etc/rsyslog.d/
      -type f -regex .\\\\*/.\\\\*\\\\\\\\.conf\").stdout.split\n  describe files.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*input\\(type=\"imtcp\" port=\"514\"\\)\\s*$/ } do\n
      \   it { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 2150
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/rsyslog.conf content is expected not to match /\$ModLoad
        imtcp/
      :run_time: 0.000112355
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: passed
      :code_desc: File /etc/rsyslog.conf content is expected not to match /\$InputTCPServerRun/
      :run_time: 7.9651e-05
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002485574
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002230615
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: File /etc/rsyslog.conf content is expected not to match /^\s*module\(load="imtcp"\)\s*$/
      :run_time: 0.000223214
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: passed
      :code_desc: File /etc/rsyslog.conf content is expected not to match /^\s*input\(type="imtcp"
        port="514"\)\s*$/
      :run_time: 0.00020533
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: file
      :resource_params: '["/etc/rsyslog.conf"]'
      :resource_id: "/etc/rsyslog.conf"
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.00219855
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002482195
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.1_Ensure_systemd-journal-remote_is_installed
    :title: Ensure systemd-journal-remote is installed
    :desc: |-
      Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

      Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :descriptions:
    - :label: default
      :data: |-
        Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

        Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.1_Ensure_systemd-journal-remote_is_installed\"
      do\n  title \"Ensure systemd-journal-remote is installed\"\n  desc  \"\n    Journald
      (via systemd-journal-remote ) supports the ability to send log events it gathers
      to a remote log host or to receive messages from remote hosts, thus enabling
      centralized log management.\n    \n    Rationale: Storing log data on a remote
      host protects log integrity from local attacks. If an attacker gains root access
      on the local system, they could tamper with or remove log data that is stored
      on the local system.\n  \"\n  impact 0.0\n  describe package(\"systemd-journal-remote\")
      do\n    it { should be_installed }\n  end\nend\n"
    :source_location:
      :line: 2184
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: System Package systemd-journal-remote is expected to be installed
      :run_time: 0.032953572
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `System Package systemd-journal-remote` is installed
      :resource_class: package
      :resource_params: '["systemd-journal-remote"]'
      :resource_id: systemd-journal-remote
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.2_Ensure_systemd-journal-remote_is_configured
    :title: Ensure systemd-journal-remote is configured
    :desc: |-
      Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

      Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :descriptions:
    - :label: default
      :data: |-
        Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

        Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.2_Ensure_systemd-journal-remote_is_configured\"
      do\n  title \"Ensure systemd-journal-remote is configured\"\n  desc  \"\n    Journald
      (via systemd-journal-remote ) supports the ability to send log events it gathers
      to a remote log host or to receive messages from remote hosts, thus enabling
      centralized log management.\n    \n    Rationale: Storing log data on a remote
      host protects log integrity from local attacks. If an attacker gains root access
      on the local system, they could tamper with or remove log data that is stored
      on the local system.\n  \"\n  impact 0.0\n  describe \"Ensure systemd-journal-remote
      is configured\" do\n    skip \"Verify systemd-journal-remote is configured.\n
      \ \n        Run the following command:        \n        # grep -P \\\"^ *URL=|^
      *ServerKeyFile=|^ *ServerCertificateFile=|^ *TrustedCertificateFile=\\\" /etc/systemd/journal-upload.conf\n
      \       \n        Verify the output matches per your environments certificate
      locations and the URL of the log server. Example:\n        \n        URL=192.168.50.42\n
      \       ServerKeyFile=/etc/ssl/private/journal-upload.pem\n        ServerCertificateFile=/etc/ssl/certs/journal-upload.pem\n
      \       TrustedCertificateFile=/etc/ssl/ca/trusted.pem\"\n  end\nend\n"
    :source_location:
      :line: 2197
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure systemd-journal-remote is configured
      :run_time: 8.049e-06
      :start_time: '2024-04-04T14:52:36+00:00'
      :resource: ''
      :skip_message: "Verify systemd-journal-remote is configured.\n  \n        Run
        the following command:        \n        # grep -P \"^ *URL=|^ *ServerKeyFile=|^
        *ServerCertificateFile=|^ *TrustedCertificateFile=\" /etc/systemd/journal-upload.conf\n
        \       \n        Verify the output matches per your environments certificate
        locations and the URL of the log server. Example:\n        \n        URL=192.168.50.42\n
        \       ServerKeyFile=/etc/ssl/private/journal-upload.pem\n        ServerCertificateFile=/etc/ssl/certs/journal-upload.pem\n
        \       TrustedCertificateFile=/etc/ssl/ca/trusted.pem"
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure systemd-journal-remote is configured
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.3_Ensure_systemd-journal-remote_is_enabled
    :title: Ensure systemd-journal-remote is enabled
    :desc: |-
      Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

      Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :descriptions:
    - :label: default
      :data: |-
        Journald (via systemd-journal-remote ) supports the ability to send log events it gathers to a remote log host or to receive messages from remote hosts, thus enabling centralized log management.

        Rationale: Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.3_Ensure_systemd-journal-remote_is_enabled\"
      do\n  title \"Ensure systemd-journal-remote is enabled\"\n  desc  \"\n    Journald
      (via systemd-journal-remote ) supports the ability to send log events it gathers
      to a remote log host or to receive messages from remote hosts, thus enabling
      centralized log management.\n    \n    Rationale: Storing log data on a remote
      host protects log integrity from local attacks. If an attacker gains root access
      on the local system, they could tamper with or remove log data that is stored
      on the local system.\n  \"\n  impact 0.0\n  describe service(\"systemd-journal-upload\")
      do\n    it { should be_enabled }\n  end\nend\n"
    :source_location:
      :line: 2220
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: Service systemd-journal-upload is expected to be enabled
      :run_time: 0.19077905
      :start_time: '2024-04-04T14:52:36+00:00'
      :message: expected that `Service systemd-journal-upload` is enabled
      :resource_class: service
      :resource_params: '["systemd-journal-upload"]'
      :resource_id: systemd-journal-upload
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.4_Ensure_journald_is_not_configured_to_receive_logs_from_a_remote_client
    :title: Ensure journald is not configured to receive logs from a remote client
    :desc: |-
      Journald supports the ability to receive messages from remote hosts, thus acting as a log server. Clients should not receive data from other hosts.

      **NOTE:**

      *  The same package, systemd-journal-remote , is used for both sending logs to remote hosts and receiving incoming logs.
      *  With regards to receiving logs, there are two services; systemd-journal-remote.socket and systemd-journal-remote.service .

      Rationale: If a client is configured to also receive data, thus turning it into a server, the client system is acting outside it's operational boundary.
    :descriptions:
    - :label: default
      :data: |-
        Journald supports the ability to receive messages from remote hosts, thus acting as a log server. Clients should not receive data from other hosts.

        **NOTE:**

        *  The same package, systemd-journal-remote , is used for both sending logs to remote hosts and receiving incoming logs.
        *  With regards to receiving logs, there are two services; systemd-journal-remote.socket and systemd-journal-remote.service .

        Rationale: If a client is configured to also receive data, thus turning it into a server, the client system is acting outside it's operational boundary.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.1.4_Ensure_journald_is_not_configured_to_receive_logs_from_a_remote_client\"
      do\n  title \"Ensure journald is not configured to receive logs from a remote
      client\"\n  desc  \"\n    Journald supports the ability to receive messages
      from remote hosts, thus acting as a log server. Clients should not receive data
      from other hosts.\n    \n    **NOTE:**\n    \n    *  The same package, systemd-journal-remote
      , is used for both sending logs to remote hosts and receiving incoming logs.\n
      \   *  With regards to receiving logs, there are two services; systemd-journal-remote.socket
      and systemd-journal-remote.service .\n    \n    Rationale: If a client is configured
      to also receive data, thus turning it into a server, the client system is acting
      outside it's operational boundary.\n  \"\n  impact 1.0\n  describe service(\"systemd-journal-remote.socket\").params
      do\n    its(\"UnitFileState\") { should eq \"masked\" }\n  end\nend\n"
    :source_location:
      :line: 2233
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: '#<Hashie::Mash Accept="no" AccessSELinuxContext="" ActivationDetails="[unprintable]"
        ActiveEnterTimestamp="" ActiveEnterTimestampMonotonic="0" ActiveExitTimestamp=""
        ActiveExitTimestampMonotonic="0" ActiveState="inactive" After="" AllowIsolate="no"
        AllowedCPUs="" AllowedMemoryNodes="" AmbientCapabilities="" AppArmorProfile=""
        AssertResult="no" AssertTimestamp="" AssertTimestampMonotonic="0" Asserts="[unprintable]"
        Backlog="4096" Before="" BindIPv6Only="default" BindPaths="" BindReadOnlyPaths=""
        BindToDevice="" BindsTo="" BlockIOAccounting="no" BlockIOWeight="[not set]"
        BoundBy="" Broadcast="no" CPUAccounting="yes" CPUAffinity="" CPUAffinityFromNUMA="no"
        CPUQuotaPerSecUSec="infinity" CPUQuotaPeriodUSec="infinity" CPUSchedulingPolicy="0"
        CPUSchedulingPriority="0" CPUSchedulingResetOnFork="no" CPUShares="[not set]"
        CPUUsageNSec="[not set]" CPUWeight="[not set]" CacheDirectory="" CacheDirectoryMode="0755"
        CanClean="" CanFreeze="no" CanIsolate="no" CanReload="no" CanStart="no" CanStop="yes"
        CapabilityBoundingSet="cap_chown cap_dac_override cap_dac_read_search cap_fowner
        cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable
        cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock
        cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct
        cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config
        cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override
        cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon
        cap_bpf cap_checkpoint_restore" CollectMode="inactive" ConditionResult="no"
        ConditionTimestamp="" ConditionTimestampMonotonic="0" Conditions="[unprintable]"
        ConfigurationDirectory="" ConfigurationDirectoryMode="0755" ConflictedBy=""
        Conflicts="" ConsistsOf="" ControlGroup="" ControlGroupId="0" ControlPID="0"
        CoredumpFilter="0x33" DefaultDependencies="yes" DefaultMemoryLow="0" DefaultMemoryMin="0"
        DeferAcceptUSec="0" Delegate="no" DelegateControllers="" Description="systemd-journal-remote.socket"
        DevicePolicy="auto" DirectoryMode="0755" DisableControllers="" Documentation=""
        DropInPaths="" DynamicUser="no" EffectiveCPUs="" EffectiveMemoryNodes="" Environment=""
        ExecPaths="" ExecSearchPath="" ExtensionDirectories="" ExtensionImages=""
        FailureAction="none" FailureActionExitStatus="[not set]" FileDescriptorName="systemd-journal-remote.socket"
        FinalKillSignal="9" FlushPending="no" Following="" FragmentPath="" FreeBind="no"
        FreezerState="running" GID="[not set]" Group="" IOAccounting="no" IOReadBytes="18446744073709551615"
        IOReadOperations="18446744073709551615" IOSchedulingClass="2" IOSchedulingPriority="4"
        IOWeight="[not set]" IOWriteBytes="18446744073709551615" IOWriteOperations="18446744073709551615"
        IPAccounting="no" IPAddressAllow="" IPAddressDeny="" IPCNamespacePath="" IPEgressBytes="[no
        data]" IPEgressFilterPath="" IPEgressPackets="[no data]" IPIngressBytes="[no
        data]" IPIngressFilterPath="" IPIngressPackets="[no data]" IPTOS="-1" IPTTL="-1"
        Id="systemd-journal-remote.socket" IgnoreOnIsolate="no" IgnoreSIGPIPE="yes"
        InaccessiblePaths="" InactiveEnterTimestamp="" InactiveEnterTimestampMonotonic="0"
        InactiveExitTimestamp="" InactiveExitTimestampMonotonic="0" InvocationID=""
        Job="" JobRunningTimeoutUSec="infinity" JobTimeoutAction="none" JobTimeoutRebootArgument=""
        JobTimeoutUSec="infinity" JoinsNamespaceOf="" KeepAlive="no" KeepAliveIntervalUSec="0"
        KeepAliveProbes="0" KeepAliveTimeUSec="0" KeyringMode="shared" KillMode="control-group"
        KillSignal="15" LimitAS="infinity" LimitASSoft="infinity" LimitCORE="infinity"
        LimitCORESoft="infinity" LimitCPU="infinity" LimitCPUSoft="infinity" LimitDATA="infinity"
        LimitDATASoft="infinity" LimitFSIZE="infinity" LimitFSIZESoft="infinity" LimitLOCKS="infinity"
        LimitLOCKSSoft="infinity" LimitMEMLOCK="2012184576" LimitMEMLOCKSoft="2012184576"
        LimitMSGQUEUE="819200" LimitMSGQUEUESoft="819200" LimitNICE="0" LimitNICESoft="0"
        LimitNOFILE="1073741816" LimitNOFILESoft="1073741816" LimitNPROC="61097" LimitNPROCSoft="61097"
        LimitRSS="infinity" LimitRSSSoft="infinity" LimitRTPRIO="0" LimitRTPRIOSoft="0"
        LimitRTTIME="infinity" LimitRTTIMESoft="infinity" LimitSIGPENDING="61097"
        LimitSIGPENDINGSoft="61097" LimitSTACK="infinity" LimitSTACKSoft="8388608"
        LoadCredential="[unprintable]" LoadCredentialEncrypted="[unprintable]" LoadError="org.freedesktop.systemd1.NoSuchUnit
        \"Unit systemd-journal-remote.socket not found.\"" LoadState="not-found" LockPersonality="no"
        LogExtraFields="" LogLevelMax="-1" LogNamespace="" LogRateLimitBurst="0" LogRateLimitIntervalUSec="0"
        LogsDirectory="" LogsDirectoryMode="0755" ManagedOOMMemoryPressure="auto"
        ManagedOOMMemoryPressureLimit="0" ManagedOOMPreference="none" ManagedOOMSwap="auto"
        Mark="-1" Markers="" MaxConnections="64" MaxConnectionsPerSource="0" MemoryAccounting="yes"
        MemoryAvailable="infinity" MemoryCurrent="[not set]" MemoryDenyWriteExecute="no"
        MemoryHigh="infinity" MemoryLimit="infinity" MemoryLow="0" MemoryMax="infinity"
        MemoryMin="0" MemorySwapMax="infinity" MessageQueueMaxMessages="0" MessageQueueMessageSize="0"
        MountAPIVFS="no" MountFlags="" MountImages="" NAccepted="0" NConnections="0"
        NRefused="0" NUMAMask="" NUMAPolicy="n/a" Names="systemd-journal-remote.socket"
        NeedDaemonReload="no" NetworkNamespacePath="" Nice="0" NoDelay="no" NoExecPaths=""
        NoNewPrivileges="no" NonBlocking="no" OOMScoreAdjust="0" OnFailure="" OnFailureJobMode="replace"
        OnFailureOf="" OnSuccess="" OnSuccessJobMode="fail" OnSuccessOf="" PAMName=""
        PartOf="" PassCredentials="no" PassEnvironment="" PassPacketInfo="no" PassSecurity="no"
        Perpetual="no" Personality="" PipeSize="0" Priority="-1" PrivateDevices="no"
        PrivateIPC="no" PrivateMounts="no" PrivateNetwork="no" PrivateTmp="no" PrivateUsers="no"
        ProcSubset="all" PropagatesReloadTo="" PropagatesStopTo="" ProtectClock="no"
        ProtectControlGroups="no" ProtectHome="no" ProtectHostname="no" ProtectKernelLogs="no"
        ProtectKernelModules="no" ProtectKernelTunables="no" ProtectProc="default"
        ProtectSystem="no" ReadOnlyPaths="" ReadWritePaths="" RebootArgument="" ReceiveBuffer="0"
        Refs="" RefuseManualStart="no" RefuseManualStop="no" ReloadPropagatedFrom=""
        RemoveIPC="no" RemoveOnStop="no" RequiredBy="" Requires="" RequiresMountsFor=""
        Requisite="" RequisiteOf="" RestartKillSignal="15" RestrictAddressFamilies="~"
        RestrictFileSystems="~" RestrictNamespaces="no" RestrictNetworkInterfaces="~"
        RestrictRealtime="no" RestrictSUIDSGID="no" Result="success" ReusePort="no"
        RootDirectory="" RootHash="" RootHashPath="" RootHashSignature="" RootHashSignaturePath=""
        RootImage="" RootImageOptions="[unprintable]" RootVerity="" RuntimeDirectory=""
        RuntimeDirectoryMode="0755" RuntimeDirectoryPreserve="no" SELinuxContext=""
        SameProcessGroup="no" SecureBits="0" SendBuffer="0" SendSIGHUP="no" SendSIGKILL="yes"
        SetCredential="[unprintable]" SetCredentialEncrypted="[unprintable]" Slice=""
        SliceOf="" SmackLabel="" SmackLabelIPIn="" SmackLabelIPOut="" SmackProcessLabel=""
        SocketGroup="" SocketMode="0666" SocketProtocol="0" SocketUser="" SourcePath=""
        StandardError="inherit" StandardErrorFileDescriptorName="" StandardInput="null"
        StandardInputData="" StandardInputFileDescriptorName="" StandardOutput="journal"
        StandardOutputFileDescriptorName="" StartLimitAction="none" StartLimitBurst="5"
        StartLimitIntervalUSec="10s" StartupAllowedCPUs="" StartupAllowedMemoryNodes=""
        StartupBlockIOWeight="[not set]" StartupCPUShares="[not set]" StartupCPUWeight="[not
        set]" StartupIOWeight="[not set]" StateChangeTimestamp="" StateChangeTimestampMonotonic="0"
        StateDirectory="" StateDirectoryMode="0755" StopPropagatedFrom="" StopWhenUnneeded="no"
        SubState="dead" SuccessAction="none" SuccessActionExitStatus="[not set]" SupplementaryGroups=""
        Symlinks="" SyslogFacility="3" SyslogIdentifier="" SyslogLevel="6" SyslogLevelPrefix="yes"
        SyslogPriority="30" SystemCallArchitectures="" SystemCallErrorNumber="2147483646"
        SystemCallFilter="~" SystemCallLog="~" TCPCongestion="" TTYColumns="[unprintable]"
        TTYPath="" TTYReset="no" TTYRows="[unprintable]" TTYVHangup="no" TTYVTDisallocate="no"
        TasksAccounting="yes" TasksCurrent="[not set]" TasksMax="97755" TemporaryFileSystem=""
        TimeoutCleanUSec="infinity" TimeoutUSec="1min 30s" TimerSlackNSec="50000"
        Timestamping="off" Transient="no" Transparent="no" TriggerLimitBurst="4294967295"
        TriggerLimitIntervalUSec="infinity" TriggeredBy="" Triggers="" UID="[not set]"
        UMask="0022" UnitFilePreset="" UnitFileState="" UnsetEnvironment="" UpheldBy=""
        Upholds="" User="" UtmpIdentifier="" UtmpMode="init" WantedBy="" Wants=""
        WatchdogSignal="6" WorkingDirectory="" Writable="no"> UnitFileState is expected
        to eq "masked"'
      :run_time: 0.00025322
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: |2

        expected: "masked"
             got: ""

        (compared using ==)
      :resource_class: Hashie::Hash
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.2_Ensure_journald_service_is_enabled
    :title: Ensure journald service is enabled
    :desc: |-
      Ensure that the systemd-journald service is enabled to allow capturing of logging events.

      Rationale: If the systemd-journald service is not enabled to start on boot, the system will not capture logging events.
    :descriptions:
    - :label: default
      :data: |-
        Ensure that the systemd-journald service is enabled to allow capturing of logging events.

        Rationale: If the systemd-journald service is not enabled to start on boot, the system will not capture logging events.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.2_Ensure_journald_service_is_enabled\"
      do\n  title \"Ensure journald service is enabled\"\n  desc  \"\n    Ensure that
      the systemd-journald service is enabled to allow capturing of logging events.\n
      \   \n    Rationale: If the systemd-journald service is not enabled to start
      on boot, the system will not capture logging events.\n  \"\n  impact 1.0\n  describe
      service(\"systemd-journald\").params do\n    its(\"UnitFileState\") { should
      eq \"static\" }\n  end\nend\n"
    :source_location:
      :line: 2251
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: '#<Hashie::Mash AccessSELinuxContext="system_u:object_r:systemd_unit_file_t:s0"
        ActivationDetails="[unprintable]" ActiveEnterTimestamp="Mon 2024-04-01 13:22:32
        UTC" ActiveEnterTimestampMonotonic="16673926" ActiveExitTimestamp="Mon 2024-04-01
        13:22:32 UTC" ActiveExitTimestampMonotonic="16493608" ActiveState="active"
        After="system.slice systemd-journald-dev-log.socket syslog.socket -.mount
        systemd-journald.socket" AllowIsolate="no" AllowedCPUs="" AllowedMemoryNodes=""
        AmbientCapabilities="" AppArmorProfile="" AssertResult="yes" AssertTimestamp="Mon
        2024-04-01 13:22:32 UTC" AssertTimestampMonotonic="16556964" Asserts="[unprintable]"
        Before="systemd-tmpfiles-setup.service systemd-journal-flush.service sysinit.target"
        BindPaths="" BindReadOnlyPaths="" BindsTo="" BlockIOAccounting="no" BlockIOWeight="[not
        set]" BoundBy="" BusName="" CPUAccounting="yes" CPUAffinity="" CPUAffinityFromNUMA="no"
        CPUQuotaPerSecUSec="infinity" CPUQuotaPeriodUSec="infinity" CPUSchedulingPolicy="0"
        CPUSchedulingPriority="0" CPUSchedulingResetOnFork="no" CPUShares="[not set]"
        CPUUsageNSec="30365680000" CPUWeight="[not set]" CacheDirectory="" CacheDirectoryMode="0755"
        CanClean="runtime" CanFreeze="yes" CanIsolate="no" CanReload="no" CanStart="yes"
        CanStop="yes" CapabilityBoundingSet="cap_chown cap_dac_override cap_dac_read_search
        cap_fowner cap_setgid cap_setuid cap_sys_ptrace cap_sys_admin cap_audit_control
        cap_mac_override cap_syslog cap_audit_read" CleanResult="success" CollectMode="inactive"
        ConditionResult="yes" ConditionTimestamp="Mon 2024-04-01 13:22:32 UTC" ConditionTimestampMonotonic="16556963"
        Conditions="[unprintable]" ConfigurationDirectory="" ConfigurationDirectoryMode="0755"
        ConflictedBy="" Conflicts="" ConsistsOf="" ControlGroup="/system.slice/systemd-journald.service"
        ControlGroupId="1667" ControlPID="0" CoredumpFilter="0x33" DefaultDependencies="no"
        DefaultMemoryLow="0" DefaultMemoryMin="0" Delegate="no" DelegateControllers=""
        Description="Journal Service" DeviceAllow="char-* rw" DevicePolicy="auto"
        DisableControllers="" Documentation="\"man:systemd-journald.service(8)\" \"man:journald.conf(5)\""
        DropInPaths="" DynamicUser="no" EffectiveCPUs="0-3" EffectiveMemoryNodes="0"
        Environment="" ExecMainCode="0" ExecMainExitTimestamp="" ExecMainExitTimestampMonotonic="0"
        ExecMainPID="572" ExecMainStartTimestamp="Mon 2024-04-01 13:22:32 UTC" ExecMainStartTimestampMonotonic="16562114"
        ExecMainStatus="0" ExecPaths="" ExecSearchPath="" ExecStart="{ path=/usr/lib/systemd/systemd-journald
        ; argv[]=/usr/lib/systemd/systemd-journald ; ignore_errors=no ; start_time=[n/a]
        ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }" ExecStartEx="{ path=/usr/lib/systemd/systemd-journald
        ; argv[]=/usr/lib/systemd/systemd-journald ; flags= ; start_time=[n/a] ; stop_time=[n/a]
        ; pid=0 ; code=(null) ; status=0/0 }" ExitType="main" ExtensionDirectories=""
        ExtensionImages="" FailureAction="none" FailureActionExitStatus="[not set]"
        FileDescriptorStoreMax="4224" FinalKillSignal="9" Following="" FragmentPath="/usr/lib/systemd/system/systemd-journald.service"
        FreezerState="running" GID="[not set]" Group="" GuessMainPID="yes" IOAccounting="no"
        IOReadBytes="18446744073709551615" IOReadOperations="18446744073709551615"
        IOSchedulingClass="2" IOSchedulingPriority="4" IOWeight="[not set]" IOWriteBytes="18446744073709551615"
        IOWriteOperations="18446744073709551615" IPAccounting="no" IPAddressAllow=""
        IPAddressDeny="0.0.0.0/0 ::/0" IPCNamespacePath="" IPEgressBytes="[no data]"
        IPEgressFilterPath="" IPEgressPackets="[no data]" IPIngressBytes="[no data]"
        IPIngressFilterPath="" IPIngressPackets="[no data]" Id="systemd-journald.service"
        IgnoreOnIsolate="yes" IgnoreSIGPIPE="yes" InaccessiblePaths="" InactiveEnterTimestamp="Mon
        2024-04-01 13:22:32 UTC" InactiveEnterTimestampMonotonic="16556512" InactiveExitTimestamp="Mon
        2024-04-01 13:22:32 UTC" InactiveExitTimestampMonotonic="16562162" InvocationID="7f9e9906bca74f7d82505e071b4ee306"
        Job="" JobRunningTimeoutUSec="infinity" JobTimeoutAction="none" JobTimeoutRebootArgument=""
        JobTimeoutUSec="infinity" JoinsNamespaceOf="" KeyringMode="private" KillMode="control-group"
        KillSignal="15" LimitAS="infinity" LimitASSoft="infinity" LimitCORE="infinity"
        LimitCORESoft="0" LimitCPU="infinity" LimitCPUSoft="infinity" LimitDATA="infinity"
        LimitDATASoft="infinity" LimitFSIZE="infinity" LimitFSIZESoft="infinity" LimitLOCKS="infinity"
        LimitLOCKSSoft="infinity" LimitMEMLOCK="8388608" LimitMEMLOCKSoft="8388608"
        LimitMSGQUEUE="819200" LimitMSGQUEUESoft="819200" LimitNICE="0" LimitNICESoft="0"
        LimitNOFILE="524288" LimitNOFILESoft="524288" LimitNPROC="61097" LimitNPROCSoft="61097"
        LimitRSS="infinity" LimitRSSSoft="infinity" LimitRTPRIO="0" LimitRTPRIOSoft="0"
        LimitRTTIME="infinity" LimitRTTIMESoft="infinity" LimitSIGPENDING="61097"
        LimitSIGPENDINGSoft="61097" LimitSTACK="infinity" LimitSTACKSoft="8388608"
        LoadCredential="[unprintable]" LoadCredentialEncrypted="[unprintable]" LoadError=""
        LoadState="loaded" LockPersonality="yes" LogExtraFields="" LogLevelMax="-1"
        LogNamespace="" LogRateLimitBurst="0" LogRateLimitIntervalUSec="0" LogsDirectory=""
        LogsDirectoryMode="0755" MainPID="572" ManagedOOMMemoryPressure="auto" ManagedOOMMemoryPressureLimit="0"
        ManagedOOMPreference="none" ManagedOOMSwap="auto" Markers="" MemoryAccounting="yes"
        MemoryAvailable="infinity" MemoryCurrent="72196096" MemoryDenyWriteExecute="yes"
        MemoryHigh="infinity" MemoryLimit="infinity" MemoryLow="0" MemoryMax="infinity"
        MemoryMin="0" MemorySwapMax="infinity" MountAPIVFS="no" MountFlags="" MountImages=""
        NFileDescriptorStore="10" NRestarts="1" NUMAMask="" NUMAPolicy="n/a" Names="systemd-journald.service"
        NeedDaemonReload="no" NetworkNamespacePath="" Nice="0" NoExecPaths="" NoNewPrivileges="yes"
        NonBlocking="no" NotifyAccess="main" OOMPolicy="stop" OOMScoreAdjust="-250"
        OnFailure="" OnFailureJobMode="replace" OnFailureOf="" OnSuccess="" OnSuccessJobMode="fail"
        OnSuccessOf="" PAMName="" PIDFile="" PartOf="" PassEnvironment="" Perpetual="no"
        Personality="" PrivateDevices="no" PrivateIPC="no" PrivateMounts="no" PrivateNetwork="no"
        PrivateTmp="no" PrivateUsers="no" ProcSubset="all" PropagatesReloadTo="" PropagatesStopTo=""
        ProtectClock="yes" ProtectControlGroups="no" ProtectHome="no" ProtectHostname="no"
        ProtectKernelLogs="no" ProtectKernelModules="no" ProtectKernelTunables="no"
        ProtectProc="default" ProtectSystem="no" ReadOnlyPaths="" ReadWritePaths=""
        RebootArgument="" Refs="" RefuseManualStart="no" RefuseManualStop="no" ReloadPropagatedFrom=""
        ReloadResult="success" RemainAfterExit="no" RemoveIPC="no" RequiredBy="" Requires="-.mount
        system.slice systemd-journald.socket" RequiresMountsFor="/run/systemd/journal"
        Requisite="" RequisiteOf="" Restart="always" RestartForceExitStatus="" RestartKillSignal="15"
        RestartPreventExitStatus="" RestartUSec="0" RestrictAddressFamilies="AF_NETLINK
        AF_UNIX" RestrictFileSystems="~" RestrictNamespaces="yes" RestrictNetworkInterfaces="~"
        RestrictRealtime="yes" RestrictSUIDSGID="yes" Result="success" RootDirectory=""
        RootDirectoryStartOnly="no" RootHash="" RootHashPath="" RootHashSignature=""
        RootHashSignaturePath="" RootImage="" RootImageOptions="[unprintable]" RootVerity=""
        RuntimeDirectory="systemd/journal" RuntimeDirectoryMode="0755" RuntimeDirectoryPreserve="yes"
        RuntimeMaxUSec="infinity" RuntimeRandomizedExtraUSec="0" SELinuxContext=""
        SameProcessGroup="no" SecureBits="0" SendSIGHUP="no" SendSIGKILL="yes" SetCredential="[unprintable]"
        SetCredentialEncrypted="[unprintable]" Slice="system.slice" SliceOf="" SmackProcessLabel=""
        SourcePath="" StandardError="inherit" StandardErrorFileDescriptorName="" StandardInput="null"
        StandardInputData="" StandardInputFileDescriptorName="" StandardOutput="null"
        StandardOutputFileDescriptorName="" StartLimitAction="none" StartLimitBurst="5"
        StartLimitIntervalUSec="10s" StartupAllowedCPUs="" StartupAllowedMemoryNodes=""
        StartupBlockIOWeight="[not set]" StartupCPUShares="[not set]" StartupCPUWeight="[not
        set]" StartupIOWeight="[not set]" StateChangeTimestamp="Mon 2024-04-01 13:22:32
        UTC" StateChangeTimestampMonotonic="16673926" StateDirectory="" StateDirectoryMode="0755"
        StatusErrno="0" StatusText="Processing requests..." StopPropagatedFrom=""
        StopWhenUnneeded="no" SubState="running" SuccessAction="none" SuccessActionExitStatus="[not
        set]" SuccessExitStatus="" SupplementaryGroups="" SyslogFacility="3" SyslogIdentifier=""
        SyslogLevel="6" SyslogLevelPrefix="yes" SyslogPriority="30" SystemCallArchitectures="native"
        SystemCallErrorNumber="1" SystemCallFilter="_llseek _newselect accept accept4
        access add_key alarm arch_prctl bind brk cacheflush capget capset chdir chmod
        chown chown32 clock_getres clock_getres_time64 clock_gettime clock_gettime64
        clock_nanosleep clock_nanosleep_time64 clone clone3 close close_range connect
        copy_file_range creat dup dup2 dup3 epoll_create epoll_create1 epoll_ctl epoll_ctl_old
        epoll_pwait epoll_pwait2 epoll_wait epoll_wait_old eventfd eventfd2 execve
        execveat exit exit_group faccessat faccessat2 fadvise64 fadvise64_64 fallocate
        fchdir fchmod fchmodat fchown fchown32 fchownat fcntl fcntl64 fdatasync fgetxattr
        flistxattr flock fork fremovexattr fsetxattr fstat fstat64 fstatat64 fstatfs
        fstatfs64 fsync ftruncate ftruncate64 futex futex_time64 futimesat get_mempolicy
        get_robust_list get_thread_area getcpu getcwd getdents getdents64 getegid
        getegid32 geteuid geteuid32 getgid getgid32 getgroups getgroups32 getitimer
        getpeername getpgid getpgrp getpid getppid getpriority getrandom getresgid
        getresgid32 getresuid getresuid32 getrlimit getrusage getsid getsockname getsockopt
        gettid gettimeofday getuid getuid32 getxattr inotify_add_watch inotify_init
        inotify_init1 inotify_rm_watch io_cancel io_destroy io_getevents io_pgetevents
        io_pgetevents_time64 io_setup io_submit io_uring_enter io_uring_register io_uring_setup
        ioctl ioprio_get ioprio_set ipc kcmp keyctl kill lchown lchown32 lgetxattr
        link linkat listen listxattr llistxattr lremovexattr lseek lsetxattr lstat
        lstat64 madvise mbind membarrier memfd_create migrate_pages mkdir mkdirat
        mknod mknodat mlock mlock2 mlockall mmap mmap2 move_pages mprotect mq_getsetattr
        mq_notify mq_open mq_timedreceive mq_timedreceive_time64 mq_timedsend mq_timedsend_time64
        mq_unlink mremap msgctl msgget msgrcv msgsnd msync munlock munlockall munmap
        name_to_handle_at nanosleep newfstatat nice oldfstat oldlstat oldolduname
        oldstat olduname open openat openat2 pause personality pidfd_open pidfd_send_signal
        pipe pipe2 poll ppoll ppoll_time64 prctl pread64 preadv preadv2 prlimit64
        process_madvise process_vm_readv process_vm_writev pselect6 pselect6_time64
        pwrite64 pwritev pwritev2 read readahead readdir readlink readlinkat readv
        recv recvfrom recvmmsg recvmmsg_time64 recvmsg remap_file_pages removexattr
        rename renameat renameat2 request_key restart_syscall riscv_flush_icache rmdir
        rseq rt_sigaction rt_sigpending rt_sigprocmask rt_sigqueueinfo rt_sigreturn
        rt_sigsuspend rt_sigtimedwait rt_sigtimedwait_time64 rt_tgsigqueueinfo sched_get_priority_max
        sched_get_priority_min sched_getaffinity sched_getattr sched_getparam sched_getscheduler
        sched_rr_get_interval sched_rr_get_interval_time64 sched_setaffinity sched_setattr
        sched_setparam sched_setscheduler sched_yield select semctl semget semop semtimedop
        semtimedop_time64 send sendfile sendfile64 sendmmsg sendmsg sendto set_mempolicy
        set_robust_list set_thread_area set_tid_address set_tls setfsgid setfsgid32
        setfsuid setfsuid32 setgid setgid32 setgroups setgroups32 setitimer setns
        setpgid setpriority setregid setregid32 setresgid setresgid32 setresuid setresuid32
        setreuid setreuid32 setrlimit setsid setsockopt setuid setuid32 setxattr shmat
        shmctl shmdt shmget shutdown sigaction sigaltstack signal signalfd signalfd4
        sigpending sigprocmask sigreturn sigsuspend socket socketcall socketpair splice
        stat stat64 statfs statfs64 statx swapcontext symlink symlinkat sync sync_file_range
        sync_file_range2 syncfs sysinfo tee tgkill time timer_create timer_delete
        timer_getoverrun timer_gettime timer_gettime64 timer_settime timer_settime64
        timerfd_create timerfd_gettime timerfd_gettime64 timerfd_settime timerfd_settime64
        times tkill truncate truncate64 ugetrlimit umask uname unlink unlinkat unshare
        userfaultfd utime utimensat utimensat_time64 utimes vfork vmsplice wait4 waitid
        waitpid write writev" SystemCallLog="~" TTYColumns="[unprintable]" TTYPath=""
        TTYReset="no" TTYRows="[unprintable]" TTYVHangup="no" TTYVTDisallocate="no"
        TasksAccounting="yes" TasksCurrent="1" TasksMax="97755" TemporaryFileSystem=""
        TimeoutAbortUSec="1min 30s" TimeoutCleanUSec="infinity" TimeoutStartFailureMode="terminate"
        TimeoutStartUSec="1min 30s" TimeoutStopFailureMode="terminate" TimeoutStopUSec="1min
        30s" TimerSlackNSec="50000" Transient="no" TriggeredBy="systemd-journald-dev-log.socket
        systemd-journald.socket" Triggers="" Type="notify" UID="[not set]" UMask="0022"
        USBFunctionDescriptors="" USBFunctionStrings="" UnitFilePreset="disabled"
        UnitFileState="static" UnsetEnvironment="" UpheldBy="" Upholds="" User=""
        UtmpIdentifier="" UtmpMode="init" WantedBy="initrd-switch-root.target systemd-journal-flush.service
        sysinit.target" Wants="systemd-journald-dev-log.socket systemd-journald.socket"
        WatchdogSignal="6" WatchdogTimestamp="Thu 2024-04-04 14:51:03 UTC" WatchdogTimestampMonotonic="264527652997"
        WatchdogUSec="3min" WorkingDirectory=""> UnitFileState is expected to eq "static"'
      :run_time: 0.000108441
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: Hashie::Hash
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.3_Ensure_journald_is_configured_to_compress_large_log_files
    :title: Ensure journald is configured to compress large log files
    :desc: |-
      The journald system includes the capability of compressing overly large files to avoid filling up the system with logs or making the logs unmanageably large.

      Rationale: Uncompressed large files may unexpectedly fill a filesystem leading to resource unavailability.  Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.
    :descriptions:
    - :label: default
      :data: |-
        The journald system includes the capability of compressing overly large files to avoid filling up the system with logs or making the logs unmanageably large.

        Rationale: Uncompressed large files may unexpectedly fill a filesystem leading to resource unavailability.  Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.3_Ensure_journald_is_configured_to_compress_large_log_files\"
      do\n  title \"Ensure journald is configured to compress large log files\"\n
      \ desc  \"\n    The journald system includes the capability of compressing overly
      large files to avoid filling up the system with logs or making the logs unmanageably
      large.\n    \n    Rationale: Uncompressed large files may unexpectedly fill
      a filesystem leading to resource unavailability.  Compressing logs prior to
      write can prevent sudden, unexpected filesystem impacts.\n  \"\n  impact 1.0\n
      \ describe file(\"/etc/systemd/journald.conf\") do\n    its(\"content\") { should
      match(/^\\s*(?i)Compress\\s*=\\s*yes(\\s+#.*)*$/) }\n  end\nend\n"
    :source_location:
      :line: 2264
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/systemd/journald.conf content is expected to match /^\s*(?i)Compress\s*=\s*yes(\s+#.*)*$/
      :run_time: 0.000997328
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: |
        expected "#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or mod...LevelKMsg=notice\n#MaxLevelConsole=info\n#MaxLevelWall=emerg\n#LineMax=48K\n#ReadKMsg=yes\nAudit=\n" to match /^\s*(?i)Compress\s*=\s*yes(\s+#.*)*$/
        Diff:
        @@ -1,47 +1,93 @@
        -/^\s*(?i)Compress\s*=\s*yes(\s+#.*)*$/
        +#  This file is part of systemd.
        +#
        +#  systemd is free software; you can redistribute it and/or modify it under the
        +#  terms of the GNU Lesser General Public License as published by the Free
        +#  Software Foundation; either version 2.1 of the License, or (at your option)
        +#  any later version.
        +#
        +# Entries in this file show the compile time defaults. Local configuration
        +# should be created by either modifying this file, or by creating "drop-ins" in
        +# the journald.conf.d/ subdirectory. The latter is generally recommended.
        +# Defaults can be restored by simply deleting this file and all drop-ins.
        +#
        +# Use 'systemd-analyze cat-config systemd/journald.conf' to display the full config.
        +#
        +# See journald.conf(5) for details.
        +
        +[Journal]
        +#Storage=auto
        +#Compress=yes
        +#Seal=yes
        +#SplitMode=uid
        +#SyncIntervalSec=5m
        +#RateLimitIntervalSec=30s
        +#RateLimitBurst=10000
        +#SystemMaxUse=
        +#SystemKeepFree=
        +#SystemMaxFileSize=
        +#SystemMaxFiles=100
        +#RuntimeMaxUse=
        +#RuntimeKeepFree=
        +#RuntimeMaxFileSize=
        +#RuntimeMaxFiles=100
        +#MaxRetentionSec=
        +#MaxFileSec=1month
        +#ForwardToSyslog=no
        +#ForwardToKMsg=no
        +#ForwardToConsole=no
        +#ForwardToWall=yes
        +#TTYPath=/dev/console
        +#MaxLevelStore=debug
        +#MaxLevelSyslog=debug
        +#MaxLevelKMsg=notice
        +#MaxLevelConsole=info
        +#MaxLevelWall=emerg
        +#LineMax=48K
        +#ReadKMsg=yes
        +Audit=
      :resource_class: file
      :resource_params: '["/etc/systemd/journald.conf"]'
      :resource_id: "/etc/systemd/journald.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.4_Ensure_journald_is_configured_to_write_logfiles_to_persistent_disk
    :title: Ensure journald is configured to write logfiles to persistent disk
    :desc: |-
      Data from journald may be stored in volatile memory or persisted locally on the server.  Logs in memory will be lost upon a system reboot.  By persisting logs to local disk on the server they are protected from loss due to a reboot.

      Rationale: Writing log data to disk will provide the ability to forensically reconstruct events which may have impacted the operations or security of a system even after a system crash or reboot.
    :descriptions:
    - :label: default
      :data: |-
        Data from journald may be stored in volatile memory or persisted locally on the server.  Logs in memory will be lost upon a system reboot.  By persisting logs to local disk on the server they are protected from loss due to a reboot.

        Rationale: Writing log data to disk will provide the ability to forensically reconstruct events which may have impacted the operations or security of a system even after a system crash or reboot.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.4_Ensure_journald_is_configured_to_write_logfiles_to_persistent_disk\"
      do\n  title \"Ensure journald is configured to write logfiles to persistent
      disk\"\n  desc  \"\n    Data from journald may be stored in volatile memory
      or persisted locally on the server.  Logs in memory will be lost upon a system
      reboot.  By persisting logs to local disk on the server they are protected from
      loss due to a reboot.\n    \n    Rationale: Writing log data to disk will provide
      the ability to forensically reconstruct events which may have impacted the operations
      or security of a system even after a system crash or reboot.\n  \"\n  impact
      1.0\n  describe file(\"/etc/systemd/journald.conf\") do\n    its(\"content\")
      { should match(/^\\s*(?i)Storage\\s*=\\s*persistent(\\s+#.*)*$/) }\n  end\nend\n"
    :source_location:
      :line: 2277
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/systemd/journald.conf content is expected to match /^\s*(?i)Storage\s*=\s*persistent(\s+#.*)*$/
      :run_time: 0.000610194
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: |
        expected "#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or mod...LevelKMsg=notice\n#MaxLevelConsole=info\n#MaxLevelWall=emerg\n#LineMax=48K\n#ReadKMsg=yes\nAudit=\n" to match /^\s*(?i)Storage\s*=\s*persistent(\s+#.*)*$/
        Diff:
        @@ -1,47 +1,93 @@
        -/^\s*(?i)Storage\s*=\s*persistent(\s+#.*)*$/
        +#  This file is part of systemd.
        +#
        +#  systemd is free software; you can redistribute it and/or modify it under the
        +#  terms of the GNU Lesser General Public License as published by the Free
        +#  Software Foundation; either version 2.1 of the License, or (at your option)
        +#  any later version.
        +#
        +# Entries in this file show the compile time defaults. Local configuration
        +# should be created by either modifying this file, or by creating "drop-ins" in
        +# the journald.conf.d/ subdirectory. The latter is generally recommended.
        +# Defaults can be restored by simply deleting this file and all drop-ins.
        +#
        +# Use 'systemd-analyze cat-config systemd/journald.conf' to display the full config.
        +#
        +# See journald.conf(5) for details.
        +
        +[Journal]
        +#Storage=auto
        +#Compress=yes
        +#Seal=yes
        +#SplitMode=uid
        +#SyncIntervalSec=5m
        +#RateLimitIntervalSec=30s
        +#RateLimitBurst=10000
        +#SystemMaxUse=
        +#SystemKeepFree=
        +#SystemMaxFileSize=
        +#SystemMaxFiles=100
        +#RuntimeMaxUse=
        +#RuntimeKeepFree=
        +#RuntimeMaxFileSize=
        +#RuntimeMaxFiles=100
        +#MaxRetentionSec=
        +#MaxFileSec=1month
        +#ForwardToSyslog=no
        +#ForwardToKMsg=no
        +#ForwardToConsole=no
        +#ForwardToWall=yes
        +#TTYPath=/dev/console
        +#MaxLevelStore=debug
        +#MaxLevelSyslog=debug
        +#MaxLevelKMsg=notice
        +#MaxLevelConsole=info
        +#MaxLevelWall=emerg
        +#LineMax=48K
        +#ReadKMsg=yes
        +Audit=
      :resource_class: file
      :resource_params: '["/etc/systemd/journald.conf"]'
      :resource_id: "/etc/systemd/journald.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.5_Ensure_journald_is_not_configured_to_send_logs_to_rsyslog
    :title: Ensure journald is not configured to send logs to rsyslog
    :desc: |-
      Data from journald should be kept in the confines of the service and not forwarded on to other services.

      Rationale: **IF** journald is the method for capturing logs, all logs of the system should be handled by journald and not forwarded to other logging mechanisms.

      **Note:** This recommendation only applies if journald is the chosen method for client side logging. Do not apply this recommendation if rsyslog is used.
    :descriptions:
    - :label: default
      :data: |-
        Data from journald should be kept in the confines of the service and not forwarded on to other services.

        Rationale: **IF** journald is the method for capturing logs, all logs of the system should be handled by journald and not forwarded to other logging mechanisms.

        **Note:** This recommendation only applies if journald is the chosen method for client side logging. Do not apply this recommendation if rsyslog is used.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.5_Ensure_journald_is_not_configured_to_send_logs_to_rsyslog\"
      do\n  title \"Ensure journald is not configured to send logs to rsyslog\"\n
      \ desc  \"\n    Data from journald should be kept in the confines of the service
      and not forwarded on to other services.\n    \n    Rationale: **IF** journald
      is the method for capturing logs, all logs of the system should be handled by
      journald and not forwarded to other logging mechanisms.\n    \n    **Note:**
      This recommendation only applies if journald is the chosen method for client
      side logging. Do not apply this recommendation if rsyslog is used.\n  \"\n  impact
      0.0\n  describe file(\"/etc/systemd/journald.conf\") do\n    its(\"content\")
      { should_not match(/(?i)^\\h*ForwardToSyslog\\h*=\\h*yes\\b\\h*(#.*)?$/) }\n
      \ end\nend\n"
    :source_location:
      :line: 2290
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/systemd/journald.conf content is expected not to match
        /(?i)^\h*ForwardToSyslog\h*=\h*yes\b\h*(#.*)?$/
      :run_time: 0.000154975
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/systemd/journald.conf"]'
      :resource_id: "/etc/systemd/journald.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.6_Ensure_journald_log_rotation_is_configured_per_site_policy
    :title: Ensure journald log rotation is configured per site policy
    :desc: |-
      Journald includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageably large. The file /etc/systemd/journald.conf is the configuration file used to specify how logs generated by Journald should be rotated.

      Rationale: By keeping the log files smaller and more manageable, a system administrator can easily archive these files to another system and spend less time looking through inordinately large log files.
    :descriptions:
    - :label: default
      :data: |-
        Journald includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageably large. The file /etc/systemd/journald.conf is the configuration file used to specify how logs generated by Journald should be rotated.

        Rationale: By keeping the log files smaller and more manageable, a system administrator can easily archive these files to another system and spend less time looking through inordinately large log files.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.6_Ensure_journald_log_rotation_is_configured_per_site_policy\"
      do\n  title \"Ensure journald log rotation is configured per site policy\"\n
      \ desc  \"\n    Journald includes the capability of rotating log files regularly
      to avoid filling up the system with logs or making the logs unmanageably large.
      The file /etc/systemd/journald.conf is the configuration file used to specify
      how logs generated by Journald should be rotated.\n    \n    Rationale: By keeping
      the log files smaller and more manageable, a system administrator can easily
      archive these files to another system and spend less time looking through inordinately
      large log files.\n  \"\n  impact 0.0\n  describe \"Ensure journald log rotation
      is configured per site policy\" do\n    skip \"Review /etc/systemd/journald.conf
      and verify logs are rotated according to site policy\"\n  end\nend\n"
    :source_location:
      :line: 2305
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure journald log rotation is configured per site policy
      :run_time: 5.743e-06
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource: ''
      :skip_message: Review /etc/systemd/journald.conf and verify logs are rotated
        according to site policy
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure journald log rotation is configured per site policy
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.2.7_Ensure_journald_default_file_permissions_configured
    :title: Ensure journald default file permissions configured
    :desc: |-
      Journald will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files.

      Rationale: It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.
    :descriptions:
    - :label: default
      :data: |-
        Journald will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files.

        Rationale: It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.2.7_Ensure_journald_default_file_permissions_configured\"
      do\n  title \"Ensure journald default file permissions configured\"\n  desc
      \ \"\n    Journald will create logfiles that do not already exist on the system.
      This setting controls what permissions will be applied to these newly created
      files.\n    \n    Rationale: It is important to ensure that log files have the
      correct permissions to ensure that sensitive data is archived and protected.\n
      \ \"\n  impact 0.0\n  describe \"Ensure journald default file permissions configured\"
      do\n    skip \"First see if there is an override file /etc/tmpfiles.d/systemd.conf.
      If so, this file will override all default settings as defined in /usr/lib/tmpfiles.d/systemd.conf
      and should be inspected.If there is no override file, inspect the default /usr/lib/tmpfiles.d/systemd.conf
      against the site specific requirements.Ensure that file permissions are 0640.
      Should a site policy dictate less restrictive permissions, ensure to follow
      said policy. NOTE: More restrictive permissions such as 0600 is implicitly sufficient.\"\n
      \ end\nend\n"
    :source_location:
      :line: 2318
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure journald default file permissions configured
      :run_time: 3.476e-06
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource: ''
      :skip_message: 'First see if there is an override file /etc/tmpfiles.d/systemd.conf.
        If so, this file will override all default settings as defined in /usr/lib/tmpfiles.d/systemd.conf
        and should be inspected.If there is no override file, inspect the default
        /usr/lib/tmpfiles.d/systemd.conf against the site specific requirements.Ensure
        that file permissions are 0640. Should a site policy dictate less restrictive
        permissions, ensure to follow said policy. NOTE: More restrictive permissions
        such as 0600 is implicitly sufficient.'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure journald default file permissions configured
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_all_logfiles_have_appropriate_permissions_and_ownership
    :title: Ensure all logfiles have appropriate permissions and ownership
    :desc: |-
      Log files contain information from many services on the local system, or in the event of a centralized log server, others system&#x2019;s logs as well. In general log files are found in /var/log/ , although application can be configured to store logs elsewhere. Should your application store its logs in another location, ensure to run the same test on that location.

      Rationale: It is important that log files have the correct permissions to ensure that sensitive data is protected and that only the appropriate users / groups have access to them.
    :descriptions:
    - :label: default
      :data: |-
        Log files contain information from many services on the local system, or in the event of a centralized log server, others system&#x2019;s logs as well. In general log files are found in /var/log/ , although application can be configured to store logs elsewhere. Should your application store its logs in another location, ensure to run the same test on that location.

        Rationale: It is important that log files have the correct permissions to ensure that sensitive data is protected and that only the appropriate users / groups have access to them.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_all_logfiles_have_appropriate_permissions_and_ownership\"
      do\n  title \"Ensure all logfiles have appropriate permissions and ownership\"\n
      \ desc  \"\n    Log files contain information from many services on the local
      system, or in the event of a centralized log server, others system&#x2019;s
      logs as well. In general log files are found in /var/log/ , although application
      can be configured to store logs elsewhere. Should your application store its
      logs in another location, ensure to run the same test on that location.\n    \n
      \   Rationale: It is important that log files have the correct permissions to
      ensure that sensitive data is protected and that only the appropriate users
      / groups have access to them.\n  \"\n  impact 1.0\n  if package('gdm').installed?\n
      \   var_log_files = command('find /var/log -type f').stdout.strip.split(\"\\n\")\n
      \   var_log_files.each do |file_path|\n      file_name = command(\"basename
      #{file_path}\").stdout.strip\n      case file_name\n      when /(lastlog|wtmp|btmp)/\n
      \       describe file(file_path.to_s) do\n          it { should exist }\n          its('owner')
      { should match(/root/) }\n          its('group') { should match(/\\s*(root|utmp)\\s*$/)
      }\n          it { should_not be_executable.by 'owner' }\n          it { should_not
      be_executable.by 'group' }\n          it { should_not be_writable.by 'other'
      }\n          it { should_not be_executable.by 'other' }\n        end\n      when
      /(secure|auth.log|syslog|messages)/\n        describe file(file_path.to_s) do\n
      \         it { should exist }\n          its('owner') { should match(/(syslog|root)/)
      }\n          its('group') { should match(/\\s*(adm|root)\\s*$/) }\n          it
      { should_not be_executable.by 'owner' }\n          it { should_not be_writable.by
      'group' }\n          it { should_not be_executable.by 'group' }\n          it
      { should_not be_readable.by 'other' }\n          it { should_not be_writable.by
      'other' }\n          it { should_not be_executable.by 'other' }\n        end\n
      \     when /(SSSD|sssd)/\n        describe file(file_path.to_s) do\n          it
      { should exist }\n          its('owner') { should match(/SSSD|root/) }\n          its('group')
      { should match(/\\s*(SSSD|root)\\s*$/) }\n          it { should_not be_executable.by
      'owner' }\n          it { should_not be_executable.by 'group' }\n          it
      { should_not be_readable.by 'other' }\n          it { should_not be_writable.by
      'other' }\n          it { should_not be_executable.by 'other' }\n        end\n
      \     when /(gdm|gdm3)/\n        describe file(file_path.to_s) do\n          it
      { should exist }\n          its('owner') { should match(/root/) }\n          its('group')
      { should match(/\\s*(gdm3?|root)\\s*$/) }\n          it { should_not be_executable.by
      'owner' }\n          it { should_not be_executable.by 'group' }\n          it
      { should_not be_readable.by 'other' }\n          it { should_not be_writable.by
      'other' }\n          it { should_not be_executable.by 'other' }\n        end\n
      \     when /(.journal)/\n        describe file(file_path.to_s) do\n          it
      { should exist }\n          its('owner') { should match(/root/) }\n          its('group')
      { should match(/\\s*(systemd-journal|root)\\s*$/) }\n          it { should_not
      be_executable.by 'owner' }\n          it { should_not be_writable.by 'group'
      }\n          it { should_not be_executable.by 'group' }\n          it { should_not
      be_readable.by 'other' }\n          it { should_not be_writable.by 'other' }\n
      \         it { should_not be_executable.by 'other' }\n        end\n      else\n
      \       uid_min = command(\"awk \\'/^\\\\s*UID_MIN/{print $2}\\' /etc/login.defs\").stdout.strip.to_i\n
      \       file_uid = command(\"stat -Lc %u #{file_path}\").stdout.strip.to_i\n
      \       file_owner = command(\"stat -Lc %U #{file_path}\").stdout.strip\n        file_group
      = command(\"stat -Lc %G #{file_path}\").stdout.strip\n        describe file(file_path.to_s)
      do\n          it { should exist }\n          it { should_not be_executable.by
      'owner' }\n          it { should_not be_writable.by 'group' }\n          it
      { should_not be_executable.by 'group' }\n          it { should_not be_readable.by
      'other' }\n          it { should_not be_writable.by 'other' }\n          it
      { should_not be_executable.by 'other' }\n        end\n        if file_uid >=
      uid_min || !command(\"grep -Pq -- \\'(adm|root|\\'\\\"$(id -gn \\\"#{file_owner}\\\")\\\"\\')\\'
      <<< \\\"#{file_group}\\\"\").stdout.strip\n          describe file(file_path.to_s)
      do\n            it { should exist }\n            its('owner') { should match(/syslog|root/)
      }\n            its('group') { should match(/\\s*(adm|root)\\s*$/) }\n          end\n
      \       end\n      end\n    end\n  else\n    describe package('gdm') do\n      it
      { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2331
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package gdm is expected not to be installed
      :run_time: 0.000456622
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: package
      :resource_params: '["gdm"]'
      :resource_id: gdm
  - :id: xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_logrotate_is_configured
    :title: Ensure logrotate is configured
    :desc: |-
      The system includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageably large. The file /etc/logrotate.d/syslog is the configuration file used to rotate log files created by syslog or rsyslog .

      Rationale: By keeping the log files smaller and more manageable, a system administrator can easily archive these files to another system and spend less time looking through inordinately large log files.
    :descriptions:
    - :label: default
      :data: |-
        The system includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageably large. The file /etc/logrotate.d/syslog is the configuration file used to rotate log files created by syslog or rsyslog .

        Rationale: By keeping the log files smaller and more manageable, a system administrator can easily archive these files to another system and spend less time looking through inordinately large log files.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_logrotate_is_configured\"
      do\n  title \"Ensure logrotate is configured\"\n  desc  \"\n    The system includes
      the capability of rotating log files regularly to avoid filling up the system
      with logs or making the logs unmanageably large. The file /etc/logrotate.d/syslog
      is the configuration file used to rotate log files created by syslog or rsyslog
      .\n    \n    Rationale: By keeping the log files smaller and more manageable,
      a system administrator can easily archive these files to another system and
      spend less time looking through inordinately large log files.\n  \"\n  impact
      0.0\n  describe 'Ensure logrotate is configured' do\n    skip 'Review /etc/logrotate.conf
      and /etc/logrotate.d/* and verify logs are rotated according to site policy.'\n
      \ end\nend\n"
    :source_location:
      :line: 2430
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Ensure logrotate is configured
      :run_time: 4.749e-06
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource: ''
      :skip_message: Review /etc/logrotate.conf and /etc/logrotate.d/* and verify
        logs are rotated according to site policy.
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Ensure logrotate is configured
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_cron_daemon_is_enabled
    :title: Ensure cron daemon is enabled
    :desc: |-
      The cron daemon is used to execute batch jobs on the system.

      Rationale: While there may not be user jobs that need to be run on the system, the system does have maintenance jobs that may include security monitoring that have to run, and cron is used to execute them.
    :descriptions:
    - :label: default
      :data: |-
        The cron daemon is used to execute batch jobs on the system.

        Rationale: While there may not be user jobs that need to be run on the system, the system does have maintenance jobs that may include security monitoring that have to run, and cron is used to execute them.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_cron_daemon_is_enabled\"
      do\n  title \"Ensure cron daemon is enabled\"\n  desc  \"\n    The cron daemon
      is used to execute batch jobs on the system.\n    \n    Rationale: While there
      may not be user jobs that need to be run on the system, the system does have
      maintenance jobs that may include security monitoring that have to run, and
      cron is used to execute them.\n  \"\n  impact 1.0\n  describe service(\"crond\")
      do\n    it { should be_enabled }\n  end\nend\n"
    :source_location:
      :line: 2443
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: Service crond is expected to be enabled
      :run_time: 0.187698003
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: service
      :resource_params: '["crond"]'
      :resource_id: crond
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_permissions_on_etccrontab_are_configured
    :title: Ensure permissions on /etc/crontab are configured
    :desc: |-
      The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.

      Rationale: This file contains information on what system jobs are run by cron. Write access to this file could provide unprivileged users with the ability to elevate their privileges. Read access to this file could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.

        Rationale: This file contains information on what system jobs are run by cron. Write access to this file could provide unprivileged users with the ability to elevate their privileges. Read access to this file could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_permissions_on_etccrontab_are_configured\"
      do\n  title \"Ensure permissions on /etc/crontab are configured\"\n  desc  \"\n
      \   The /etc/crontab file is used by cron to control its own jobs. The commands
      in this item make sure that root is the user and group owner of the file and
      that only the owner can access the file.\n    \n    Rationale: This file contains
      information on what system jobs are run by cron. Write access to this file could
      provide unprivileged users with the ability to elevate their privileges. Read
      access to this file could provide users with the ability to gain insight on
      system jobs that run on the system and could provide them a way to gain unauthorized
      privileged access.\n  \"\n  impact 1.0\n  describe file(\"/etc/crontab\") do\n
      \   it { should exist }\n    its(\"gid\") { should cmp 0 }\n    its(\"uid\")
      { should cmp 0 }\n    it { should_not be_executable.by \"group\" }\n    it {
      should_not be_readable.by \"group\" }\n    it { should_not be_writable.by \"group\"
      }\n    it { should_not be_executable.by \"other\" }\n    it { should_not be_readable.by
      \"other\" }\n    it { should_not be_writable.by \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2456
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/crontab is expected to exist
      :run_time: 0.058242561
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab is expected not to be executable by group
      :run_time: 0.060660851
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: failed
      :code_desc: File /etc/crontab is expected not to be readable by group
      :run_time: 0.00030982
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/crontab not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab is expected not to be writable by group
      :run_time: 0.000116068
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab is expected not to be executable by other
      :run_time: 0.000338792
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: failed
      :code_desc: File /etc/crontab is expected not to be readable by other
      :run_time: 0.000160331
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/crontab not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab is expected not to be writable by other
      :run_time: 0.000102367
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab gid is expected to cmp == 0
      :run_time: 0.000153221
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
    - :status: passed
      :code_desc: File /etc/crontab uid is expected to cmp == 0
      :run_time: 0.000126887
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/crontab"]'
      :resource_id: "/etc/crontab"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_permissions_on_etccron.hourly_are_configured
    :title: Ensure permissions on /etc/cron.hourly are configured
    :desc: |-
      This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

      Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :descriptions:
    - :label: default
      :data: |-
        This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

        Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_permissions_on_etccron.hourly_are_configured\"
      do\n  title \"Ensure permissions on /etc/cron.hourly are configured\"\n  desc
      \ \"\n    This directory contains system cron jobs that need to run on an hourly
      basis. The files in this directory cannot be manipulated by the crontab command,
      but are instead edited by system administrators using a text editor. The commands
      below restrict read/write and search access to user and group root, preventing
      regular users from accessing this directory.\n    \n    Rationale: Granting
      write access to this directory for non-privileged users could provide them the
      means for gaining unauthorized elevated privileges. Granting read access to
      this directory could give an unprivileged user insight in how to gain elevated
      privileges or circumvent auditing controls.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/cron.hourly\") do\n    it { should exist }\n    its(\"gid\") { should
      cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"group\" }\n    it { should_not be_readable.by \"group\" }\n    it { should_not
      be_writable.by \"group\" }\n    it { should_not be_executable.by \"other\" }\n
      \   it { should_not be_readable.by \"other\" }\n    it { should_not be_writable.by
      \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2477
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/cron.hourly is expected to exist
      :run_time: 0.056139437
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: failed
      :code_desc: File /etc/cron.hourly is expected not to be executable by group
      :run_time: 0.059261225
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.hourly not to be executable by group
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: failed
      :code_desc: File /etc/cron.hourly is expected not to be readable by group
      :run_time: 0.000289118
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.hourly not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: passed
      :code_desc: File /etc/cron.hourly is expected not to be writable by group
      :run_time: 0.000160738
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: failed
      :code_desc: File /etc/cron.hourly is expected not to be executable by other
      :run_time: 0.000136529
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.hourly not to be executable by other
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: failed
      :code_desc: File /etc/cron.hourly is expected not to be readable by other
      :run_time: 0.000122331
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.hourly not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: passed
      :code_desc: File /etc/cron.hourly is expected not to be writable by other
      :run_time: 9.5273e-05
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: passed
      :code_desc: File /etc/cron.hourly gid is expected to cmp == 0
      :run_time: 0.00015457
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
    - :status: passed
      :code_desc: File /etc/cron.hourly uid is expected to cmp == 0
      :run_time: 0.000177739
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.hourly"]'
      :resource_id: "/etc/cron.hourly"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_permissions_on_etccron.daily_are_configured
    :title: Ensure permissions on /etc/cron.daily are configured
    :desc: |-
      The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

      Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

        Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_permissions_on_etccron.daily_are_configured\"
      do\n  title \"Ensure permissions on /etc/cron.daily are configured\"\n  desc
      \ \"\n    The /etc/cron.daily directory contains system cron jobs that need
      to run on a daily basis. The files in this directory cannot be manipulated by
      the crontab command, but are instead edited by system administrators using a
      text editor. The commands below restrict read/write and search access to user
      and group root, preventing regular users from accessing this directory.\n    \n
      \   Rationale: Granting write access to this directory for non-privileged users
      could provide them the means for gaining unauthorized elevated privileges. Granting
      read access to this directory could give an unprivileged user insight in how
      to gain elevated privileges or circumvent auditing controls.\n  \"\n  impact
      1.0\n  describe file(\"/etc/cron.daily\") do\n    it { should exist }\n    its(\"gid\")
      { should cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"group\" }\n    it { should_not be_readable.by \"group\" }\n    it { should_not
      be_writable.by \"group\" }\n    it { should_not be_executable.by \"other\" }\n
      \   it { should_not be_readable.by \"other\" }\n    it { should_not be_writable.by
      \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2498
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/cron.daily is expected to exist
      :run_time: 0.056947566
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: failed
      :code_desc: File /etc/cron.daily is expected not to be executable by group
      :run_time: 0.060313782
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.daily not to be executable by group
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: failed
      :code_desc: File /etc/cron.daily is expected not to be readable by group
      :run_time: 0.000255579
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.daily not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: passed
      :code_desc: File /etc/cron.daily is expected not to be writable by group
      :run_time: 0.000115887
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: failed
      :code_desc: File /etc/cron.daily is expected not to be executable by other
      :run_time: 0.000125901
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.daily not to be executable by other
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: failed
      :code_desc: File /etc/cron.daily is expected not to be readable by other
      :run_time: 0.000117736
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.daily not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: passed
      :code_desc: File /etc/cron.daily is expected not to be writable by other
      :run_time: 9.583e-05
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: passed
      :code_desc: File /etc/cron.daily gid is expected to cmp == 0
      :run_time: 0.000167793
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
    - :status: passed
      :code_desc: File /etc/cron.daily uid is expected to cmp == 0
      :run_time: 0.000145327
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.daily"]'
      :resource_id: "/etc/cron.daily"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_permissions_on_etccron.weekly_are_configured
    :title: Ensure permissions on /etc/cron.weekly are configured
    :desc: |-
      The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

      Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

        Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_permissions_on_etccron.weekly_are_configured\"
      do\n  title \"Ensure permissions on /etc/cron.weekly are configured\"\n  desc
      \ \"\n    The /etc/cron.weekly directory contains system cron jobs that need
      to run on a weekly basis. The files in this directory cannot be manipulated
      by the crontab command, but are instead edited by system administrators using
      a text editor. The commands below restrict read/write and search access to user
      and group root, preventing regular users from accessing this directory.\n    \n
      \   Rationale: Granting write access to this directory for non-privileged users
      could provide them the means for gaining unauthorized elevated privileges. Granting
      read access to this directory could give an unprivileged user insight in how
      to gain elevated privileges or circumvent auditing controls.\n  \"\n  impact
      1.0\n  describe file(\"/etc/cron.weekly\") do\n    it { should exist }\n    its(\"gid\")
      { should cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"group\" }\n    it { should_not be_readable.by \"group\" }\n    it { should_not
      be_writable.by \"group\" }\n    it { should_not be_executable.by \"other\" }\n
      \   it { should_not be_readable.by \"other\" }\n    it { should_not be_writable.by
      \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2519
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/cron.weekly is expected to exist
      :run_time: 0.056785393
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: failed
      :code_desc: File /etc/cron.weekly is expected not to be executable by group
      :run_time: 0.059919846
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.weekly not to be executable by group
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: failed
      :code_desc: File /etc/cron.weekly is expected not to be readable by group
      :run_time: 0.00025956
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.weekly not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: passed
      :code_desc: File /etc/cron.weekly is expected not to be writable by group
      :run_time: 0.000111359
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: failed
      :code_desc: File /etc/cron.weekly is expected not to be executable by other
      :run_time: 0.000119208
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.weekly not to be executable by other
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: failed
      :code_desc: File /etc/cron.weekly is expected not to be readable by other
      :run_time: 0.000129198
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.weekly not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: passed
      :code_desc: File /etc/cron.weekly is expected not to be writable by other
      :run_time: 0.000112528
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: passed
      :code_desc: File /etc/cron.weekly gid is expected to cmp == 0
      :run_time: 0.000360563
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
    - :status: passed
      :code_desc: File /etc/cron.weekly uid is expected to cmp == 0
      :run_time: 0.000145335
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.weekly"]'
      :resource_id: "/etc/cron.weekly"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_permissions_on_etccron.monthly_are_configured
    :title: Ensure permissions on /etc/cron.monthly are configured
    :desc: |-
      The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

      Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

        Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_permissions_on_etccron.monthly_are_configured\"
      do\n  title \"Ensure permissions on /etc/cron.monthly are configured\"\n  desc
      \ \"\n    The /etc/cron.monthly directory contains system cron jobs that need
      to run on a monthly basis. The files in this directory cannot be manipulated
      by the crontab command, but are instead edited by system administrators using
      a text editor. The commands below restrict read/write and search access to user
      and group root, preventing regular users from accessing this directory.\n    \n
      \   Rationale: Granting write access to this directory for non-privileged users
      could provide them the means for gaining unauthorized elevated privileges. Granting
      read access to this directory could give an unprivileged user insight in how
      to gain elevated privileges or circumvent auditing controls.\n  \"\n  impact
      1.0\n  describe file(\"/etc/cron.monthly\") do\n    it { should exist }\n    its(\"gid\")
      { should cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it { should_not be_executable.by
      \"group\" }\n    it { should_not be_readable.by \"group\" }\n    it { should_not
      be_writable.by \"group\" }\n    it { should_not be_executable.by \"other\" }\n
      \   it { should_not be_readable.by \"other\" }\n    it { should_not be_writable.by
      \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2540
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/cron.monthly is expected to exist
      :run_time: 0.057058812
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: failed
      :code_desc: File /etc/cron.monthly is expected not to be executable by group
      :run_time: 0.059187245
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.monthly not to be executable by group
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: failed
      :code_desc: File /etc/cron.monthly is expected not to be readable by group
      :run_time: 0.000264618
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.monthly not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: passed
      :code_desc: File /etc/cron.monthly is expected not to be writable by group
      :run_time: 0.000118382
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: failed
      :code_desc: File /etc/cron.monthly is expected not to be executable by other
      :run_time: 0.000124267
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.monthly not to be executable by other
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: failed
      :code_desc: File /etc/cron.monthly is expected not to be readable by other
      :run_time: 0.000124293
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.monthly not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: passed
      :code_desc: File /etc/cron.monthly is expected not to be writable by other
      :run_time: 0.000131034
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: passed
      :code_desc: File /etc/cron.monthly gid is expected to cmp == 0
      :run_time: 0.000154463
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
    - :status: passed
      :code_desc: File /etc/cron.monthly uid is expected to cmp == 0
      :run_time: 0.000128546
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.monthly"]'
      :resource_id: "/etc/cron.monthly"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_permissions_on_etccron.d_are_configured
    :title: Ensure permissions on /etc/cron.d are configured
    :desc: |-
      The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily, weekly and monthly jobs from /etc/crontab , but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

      Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily, weekly and monthly jobs from /etc/crontab , but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.

        Rationale: Granting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_permissions_on_etccron.d_are_configured\"
      do\n  title \"Ensure permissions on /etc/cron.d are configured\"\n  desc  \"\n
      \   The /etc/cron.d directory contains system cron jobs that need to run in
      a similar manner to the hourly, daily, weekly and monthly jobs from /etc/crontab
      , but require more granular control as to when they run. The files in this directory
      cannot be manipulated by the crontab command, but are instead edited by system
      administrators using a text editor. The commands below restrict read/write and
      search access to user and group root, preventing regular users from accessing
      this directory.\n    \n    Rationale: Granting write access to this directory
      for non-privileged users could provide them the means for gaining unauthorized
      elevated privileges. Granting read access to this directory could give an unprivileged
      user insight in how to gain elevated privileges or circumvent auditing controls.\n
      \ \"\n  impact 1.0\n  describe file(\"/etc/cron.d\") do\n    it { should exist
      }\n    its(\"gid\") { should cmp 0 }\n    its(\"uid\") { should cmp 0 }\n    it
      { should_not be_executable.by \"group\" }\n    it { should_not be_readable.by
      \"group\" }\n    it { should_not be_writable.by \"group\" }\n    it { should_not
      be_executable.by \"other\" }\n    it { should_not be_readable.by \"other\" }\n
      \   it { should_not be_writable.by \"other\" }\n  end\nend\n"
    :source_location:
      :line: 2561
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/cron.d is expected to exist
      :run_time: 0.057032183
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: failed
      :code_desc: File /etc/cron.d is expected not to be executable by group
      :run_time: 0.06062484
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.d not to be executable by group
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: failed
      :code_desc: File /etc/cron.d is expected not to be readable by group
      :run_time: 0.000256382
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.d not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: passed
      :code_desc: File /etc/cron.d is expected not to be writable by group
      :run_time: 0.000121822
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: failed
      :code_desc: File /etc/cron.d is expected not to be executable by other
      :run_time: 0.000357129
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.d not to be executable by other
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: failed
      :code_desc: File /etc/cron.d is expected not to be readable by other
      :run_time: 0.000131899
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.d not to be readable by other
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: passed
      :code_desc: File /etc/cron.d is expected not to be writable by other
      :run_time: 9.9383e-05
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: passed
      :code_desc: File /etc/cron.d gid is expected to cmp == 0
      :run_time: 0.000149898
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
    - :status: passed
      :code_desc: File /etc/cron.d uid is expected to cmp == 0
      :run_time: 0.000123165
      :start_time: '2024-04-04T14:52:37+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.d"]'
      :resource_id: "/etc/cron.d"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_cron_is_restricted_to_authorized_users
    :title: Ensure cron is restricted to authorized users
    :desc: |-
      If cron is installed in the system, configure /etc/cron.allow to allow specific users to use these services. If /etc/cron.allow does not exist, then /etc/cron.deny is checked. Any user not specifically defined in those files is allowed to use cron. By removing the file, only users in /etc/cron.allow are allowed to use cron.

      ** Note: Even though a given user is not listed in cron.allow , cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs. **

      Rationale: On many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.
    :descriptions:
    - :label: default
      :data: |-
        If cron is installed in the system, configure /etc/cron.allow to allow specific users to use these services. If /etc/cron.allow does not exist, then /etc/cron.deny is checked. Any user not specifically defined in those files is allowed to use cron. By removing the file, only users in /etc/cron.allow are allowed to use cron.

        ** Note: Even though a given user is not listed in cron.allow , cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs. **

        Rationale: On many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_cron_is_restricted_to_authorized_users\"
      do\n  title \"Ensure cron is restricted to authorized users\"\n  desc  \"\n
      \   If cron is installed in the system, configure /etc/cron.allow to allow specific
      users to use these services. If /etc/cron.allow does not exist, then /etc/cron.deny
      is checked. Any user not specifically defined in those files is allowed to use
      cron. By removing the file, only users in /etc/cron.allow are allowed to use
      cron.\n    \n    ** Note: Even though a given user is not listed in cron.allow
      , cron jobs can still be run as that user. The cron.allow file only controls
      administrative access to the crontab command for scheduling and modifying cron
      jobs. **\n    \n    Rationale: On many systems, only the system administrator
      is authorized to schedule cron jobs. Using the cron.allow file to control who
      can run cron jobs enforces this policy. It is easier to manage an allow list
      than a deny list. In a deny list, you could potentially add a user ID to the
      system and forget to add it to the deny files.\n  \"\n  impact 1.0\n  if package('cronie').installed?\n
      \   describe file(\"/etc/cron.deny\") do\n      it { should_not exist }\n    end\n
      \   describe file(\"/etc/cron.allow\") do\n      it { should exist }\n      it
      { should_not be_executable.by \"group\" }\n      it { should_not be_readable.by
      \"group\" }\n      it { should_not be_writable.by \"group\" }\n      it { should_not
      be_executable.by \"other\" }\n      it { should_not be_readable.by \"other\"
      }\n      it { should_not be_writable.by \"other\" }\n      it { should_not be_executable.by
      \"owner\" }\n      its(\"gid\") { should cmp 0 }\n      its(\"uid\") { should
      cmp 0 }\n    end\n  else\n    describe package(\"cronie\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2582
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/cron.deny is expected not to exist
      :run_time: 0.056287107
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.deny not to exist
      :resource_class: file
      :resource_params: '["/etc/cron.deny"]'
      :resource_id: "/etc/cron.deny"
    - :status: failed
      :code_desc: File /etc/cron.allow is expected to exist
      :run_time: 0.057874589
      :start_time: '2024-04-04T14:52:37+00:00'
      :message: expected File /etc/cron.allow to exist
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be executable by group
      :run_time: 0.000224876
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be readable by group
      :run_time: 0.000267125
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be writable by group
      :run_time: 0.000102402
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be executable by other
      :run_time: 9.1163e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be readable by other
      :run_time: 8.5817e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be writable by other
      :run_time: 8.7729e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: passed
      :code_desc: File /etc/cron.allow is expected not to be executable by owner
      :run_time: 8.4704e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: failed
      :code_desc: File /etc/cron.allow gid is expected to cmp == 0
      :run_time: 0.057798708
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
    - :status: failed
      :code_desc: File /etc/cron.allow uid is expected to cmp == 0
      :run_time: 0.000254789
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: "\nexpected: 0\n     got: \n\n(compared using `cmp` matcher)\n"
      :resource_class: file
      :resource_params: '["/etc/cron.allow"]'
      :resource_id: "/etc/cron.allow"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.1.9_Ensure_at_is_restricted_to_authorized_users
    :title: Ensure at is restricted to authorized users
    :desc: |-
      If at is installed in the system, configure /etc/at.allow to allow specific users to use these services. If /etc/at.allow does not exist, then /etc/at.deny is checked. Any user not specifically defined in those files is allowed to use at. By removing the file, only users in /etc/at.allow are allowed to use at.

      **Note:** Even though a given user is not listed in at.allow , at jobs can still be run as that user. The at.allow file only controls administrative access to the at command for scheduling and modifying at jobs.

      Rationale: On many systems, only the system administrator is authorized to schedule at jobs. Using the at.allow file to control who can run at jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.
    :descriptions:
    - :label: default
      :data: |-
        If at is installed in the system, configure /etc/at.allow to allow specific users to use these services. If /etc/at.allow does not exist, then /etc/at.deny is checked. Any user not specifically defined in those files is allowed to use at. By removing the file, only users in /etc/at.allow are allowed to use at.

        **Note:** Even though a given user is not listed in at.allow , at jobs can still be run as that user. The at.allow file only controls administrative access to the at command for scheduling and modifying at jobs.

        Rationale: On many systems, only the system administrator is authorized to schedule at jobs. Using the at.allow file to control who can run at jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.1.9_Ensure_at_is_restricted_to_authorized_users\"
      do\n  title \"Ensure at is restricted to authorized users\"\n  desc  \"\n    If
      at is installed in the system, configure /etc/at.allow to allow specific users
      to use these services. If /etc/at.allow does not exist, then /etc/at.deny is
      checked. Any user not specifically defined in those files is allowed to use
      at. By removing the file, only users in /etc/at.allow are allowed to use at.\n
      \   \n    **Note:** Even though a given user is not listed in at.allow , at
      jobs can still be run as that user. The at.allow file only controls administrative
      access to the at command for scheduling and modifying at jobs.\n    \n    Rationale:
      On many systems, only the system administrator is authorized to schedule at
      jobs. Using the at.allow file to control who can run at jobs enforces this policy.
      It is easier to manage an allow list than a deny list. In a deny list, you could
      potentially add a user ID to the system and forget to add it to the deny files.\n
      \ \"\n  impact 1.0\n  if package('at').installed?\n    describe file(\"/etc/at.deny\")
      do\n      it { should_not exist }\n    end\n    describe file(\"/etc/at.allow\")
      do\n      it { should exist }\n      it { should_not be_executable.by \"group\"
      }\n      it { should_not be_readable.by \"group\" }\n      it { should_not be_writable.by
      \"group\" }\n      it { should_not be_executable.by \"other\" }\n      it {
      should_not be_readable.by \"other\" }\n      it { should_not be_writable.by
      \"other\" }\n      it { should_not be_executable.by \"owner\" }\n      its(\"gid\")
      { should cmp 0 }\n      its(\"uid\") { should cmp 0 }\n    end\n  else\n    describe
      package(\"at\") do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2615
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package at is expected not to be installed
      :run_time: 0.000255627
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: package
      :resource_params: '["at"]'
      :resource_id: at
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_permissions_on_etcsshsshd_config_are_configured
    :title: Ensure permissions on /etc/ssh/sshd_config are configured
    :desc: |-
      The /etc/ssh/sshd_config file contains configuration specifications for sshd . The command below sets the owner and group of the file to root.

      Rationale: The /etc/ssh/sshd_config file needs to be protected from unauthorized changes by non-privileged users.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/ssh/sshd_config file contains configuration specifications for sshd . The command below sets the owner and group of the file to root.

        Rationale: The /etc/ssh/sshd_config file needs to be protected from unauthorized changes by non-privileged users.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_permissions_on_etcsshsshd_config_are_configured\"
      do\n  title \"Ensure permissions on /etc/ssh/sshd_config are configured\"\n
      \ desc  \"\n    The /etc/ssh/sshd_config file contains configuration specifications
      for sshd . The command below sets the owner and group of the file to root.\n
      \   \n    Rationale: The /etc/ssh/sshd_config file needs to be protected from
      unauthorized changes by non-privileged users.\n  \"\n  impact 1.0\n  if package('openssh-server').installed?\n
      \   describe file(\"/etc/ssh/sshd_config\") do\n      it { should exist }\n
      \     it { should_not be_executable.by \"group\" }\n      it { should_not be_readable.by
      \"group\" }\n      it { should_not be_writable.by \"group\" }\n      it { should_not
      be_executable.by \"other\" }\n      it { should_not be_readable.by \"other\"
      }\n      it { should_not be_writable.by \"other\" }\n      its(\"gid\") { should
      cmp 0 }\n      its(\"uid\") { should cmp 0 }\n    end\n  else\n    describe
      package(\"openssh-server\") do\n      it { should_not be_installed }\n    end\n
      \ end\nend\n"
    :source_location:
      :line: 2648
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected to exist
      :run_time: 0.05710635
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be executable by group
      :run_time: 0.000219164
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be readable by group
      :run_time: 0.000102265
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be writable by group
      :run_time: 9.5595e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be executable by other
      :run_time: 8.9953e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be readable by other
      :run_time: 8.6434e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config is expected not to be writable by other
      :run_time: 0.000124202
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config gid is expected to cmp == 0
      :run_time: 0.000156594
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config uid is expected to cmp == 0
      :run_time: 0.00025773
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_permissions_on_SSH_private_host_key_files_are_configured
    :title: Ensure permissions on SSH private host key files are configured
    :desc: |-
      An SSH private key is one of two files used in SSH public key authentication.  In this authentication method, the possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key should be distributed.

      Rationale: If an unauthorized user obtains the private SSH host key file, the host could be impersonated
    :descriptions:
    - :label: default
      :data: |-
        An SSH private key is one of two files used in SSH public key authentication.  In this authentication method, the possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key should be distributed.

        Rationale: If an unauthorized user obtains the private SSH host key file, the host could be impersonated
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_permissions_on_SSH_private_host_key_files_are_configured\"
      do\n  title \"Ensure permissions on SSH private host key files are configured\"\n
      \ desc  \"\n    An SSH private key is one of two files used in SSH public key
      authentication.  In this authentication method, the possession of the private
      key is proof of identity. Only a private key that corresponds to a public key
      will be able to authenticate successfully. The private keys need to be stored
      and handled carefully, and no copies of the private key should be distributed.\n
      \   \n    Rationale: If an unauthorized user obtains the private SSH host key
      file, the host could be impersonated\n  \"\n  impact 1.0\n  if package('openssh-server').installed?\n
      \   host_key_files = command('ls -a /etc/ssh/ssh_host_*_key').stdout.split(\"\\n\")\n
      \   host_key_files.each do |file|\n      describe file(\"#{file}\") do\n        it
      { should exist }\n        it { should_not be_executable.by \"group\" }\n        it
      { should_not be_readable.by \"group\" }\n        it { should_not be_writable.by
      \"group\" }\n        it { should_not be_executable.by \"other\" }\n        it
      { should_not be_readable.by \"other\" }\n        it { should_not be_writable.by
      \"other\" }\n        it { should_not be_executable.by \"owner\" }\n        its('owner')
      { should eq 'root' }\n        its('group') { should match(/\\s*(ssh_keys|root)\\s*$/)
      }\n      end\n    end\n  else\n    describe package(\"openssh-server\") do\n
      \     it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2675
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected to exist
      :run_time: 0.057242938
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be executable
        by group
      :run_time: 0.059499617
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: failed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be readable
        by group
      :run_time: 0.000302108
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected File /etc/ssh/ssh_host_ecdsa_key not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be writable
        by group
      :run_time: 0.000116108
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be executable
        by other
      :run_time: 0.000100395
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be readable
        by other
      :run_time: 8.9898e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be writable
        by other
      :run_time: 8.7275e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key is expected not to be executable
        by owner
      :run_time: 9.1802e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key owner is expected to eq "root"
      :run_time: 0.000130283
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key group is expected to match /\s*(ssh_keys|root)\s*$/
      :run_time: 0.000289109
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected to exist
      :run_time: 0.056868851
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be executable
        by group
      :run_time: 0.060304877
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: failed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be readable
        by group
      :run_time: 0.000300249
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected File /etc/ssh/ssh_host_ed25519_key not to be readable by
        group
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be writable
        by group
      :run_time: 0.00012786
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be executable
        by other
      :run_time: 9.9563e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be readable
        by other
      :run_time: 8.8756e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be writable
        by other
      :run_time: 8.853e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key is expected not to be executable
        by owner
      :run_time: 8.7179e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key owner is expected to eq "root"
      :run_time: 0.000125497
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key group is expected to match /\s*(ssh_keys|root)\s*$/
      :run_time: 0.000257943
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected to exist
      :run_time: 0.057097689
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be executable
        by group
      :run_time: 0.059875352
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: failed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be readable by
        group
      :run_time: 0.000290826
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected File /etc/ssh/ssh_host_rsa_key not to be readable by group
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be writable by
        group
      :run_time: 0.000108569
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be executable
        by other
      :run_time: 0.000134827
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be readable by
        other
      :run_time: 9.1439e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be writable by
        other
      :run_time: 8.7157e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key is expected not to be executable
        by owner
      :run_time: 8.5796e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key owner is expected to eq "root"
      :run_time: 0.000125964
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key group is expected to match /\s*(ssh_keys|root)\s*$/
      :run_time: 9.7535e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_permissions_on_SSH_public_host_key_files_are_configured
    :title: Ensure permissions on SSH public host key files are configured
    :desc: |-
      An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public key that corresponds to a private key will be able to authenticate successfully.

      Rationale: If a public host key file is modified by an unauthorized user, the SSH service may be compromised.
    :descriptions:
    - :label: default
      :data: |-
        An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public key that corresponds to a private key will be able to authenticate successfully.

        Rationale: If a public host key file is modified by an unauthorized user, the SSH service may be compromised.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_permissions_on_SSH_public_host_key_files_are_configured\"
      do\n  title \"Ensure permissions on SSH public host key files are configured\"\n
      \ desc  \"\n    An SSH public key is one of two files used in SSH public key
      authentication. In this authentication method, a public key is a key that can
      be used for verifying digital signatures generated using a corresponding private
      key. Only a public key that corresponds to a private key will be able to authenticate
      successfully.\n    \n    Rationale: If a public host key file is modified by
      an unauthorized user, the SSH service may be compromised.\n  \"\n  impact 1.0\n
      \ if package('openssh-server').installed?\n    host_key_files = command('ls
      -a /etc/ssh/ssh_host_*_key.pub').stdout.split(\"\\n\")\n    host_key_files.each
      do |file|\n      describe file(\"#{file}\") do\n        it { should exist }\n
      \       it { should_not be_executable.by \"group\" }\n        it { should_not
      be_writable.by \"group\" }\n        it { should_not be_executable.by \"other\"
      }\n        it { should_not be_writable.by \"other\" }\n        it { should_not
      be_executable.by \"owner\" }\n        its(\"uid\") { should cmp 0 }\n        its(\"gid\")
      { should cmp 0 }\n      end\n    end\n  else\n    describe package(\"openssh-server\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2706
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected to exist
      :run_time: 0.057120141
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected not to be executable
        by group
      :run_time: 0.060045143
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected not to be writable
        by group
      :run_time: 0.000218173
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected not to be executable
        by other
      :run_time: 0.000104565
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected not to be writable
        by other
      :run_time: 9.4844e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub is expected not to be executable
        by owner
      :run_time: 8.9438e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub uid is expected to cmp == 0
      :run_time: 0.000157919
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ecdsa_key.pub gid is expected to cmp == 0
      :run_time: 0.000127515
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ecdsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ecdsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected to exist
      :run_time: 0.057437905
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected not to be executable
        by group
      :run_time: 0.059550411
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected not to be writable
        by group
      :run_time: 0.00021937
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected not to be executable
        by other
      :run_time: 0.000120856
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected not to be writable
        by other
      :run_time: 9.7382e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub is expected not to be executable
        by owner
      :run_time: 9.0851e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub uid is expected to cmp ==
        0
      :run_time: 0.000147265
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_ed25519_key.pub gid is expected to cmp ==
        0
      :run_time: 0.000123607
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_ed25519_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_ed25519_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected to exist
      :run_time: 0.057770385
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected not to be executable
        by group
      :run_time: 0.059499065
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected not to be writable
        by group
      :run_time: 0.000220919
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected not to be executable
        by other
      :run_time: 0.000104743
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected not to be writable
        by other
      :run_time: 9.3684e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub is expected not to be executable
        by owner
      :run_time: 9.0458e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub uid is expected to cmp == 0
      :run_time: 0.000190701
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
    - :status: passed
      :code_desc: File /etc/ssh/ssh_host_rsa_key.pub gid is expected to cmp == 0
      :run_time: 0.000123032
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/ssh_host_rsa_key.pub"]'
      :resource_id: "/etc/ssh/ssh_host_rsa_key.pub"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_SSH_access_is_limited
    :title: Ensure SSH access is limited
    :desc: |-
      There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:

      * AllowUsers : *  The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.
      * AllowGroups : *  The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.
      * DenyUsers : *  The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.
      * DenyGroups : *  The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.

      Rationale: Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.
    :descriptions:
    - :label: default
      :data: |-
        There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:

        * AllowUsers : *  The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.
        * AllowGroups : *  The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.
        * DenyUsers : *  The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.
        * DenyGroups : *  The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.

        Rationale: Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_SSH_access_is_limited\"
      do\n  title \"Ensure SSH access is limited\"\n  desc  \"\n    There are several
      options available to limit which users and group can access the system via SSH.
      It is recommended that at least one of the following options be leveraged:\n
      \   \n    * AllowUsers : *  The AllowUsers variable gives the system administrator
      the option of allowing specific users to ssh into the system. The list consists
      of space separated user names. Numeric user IDs are not recognized with this
      variable. If a system administrator wants to restrict user access further by
      only allowing the allowed users to log in from a particular host, the entry
      can be specified in the form of user@host.\n    * AllowGroups : *  The AllowGroups
      variable gives the system administrator the option of allowing specific groups
      of users to ssh into the system. The list consists of space separated group
      names. Numeric group IDs are not recognized with this variable.\n    * DenyUsers
      : *  The DenyUsers variable gives the system administrator the option of denying
      specific users to ssh into the system. The list consists of space separated
      user names. Numeric user IDs are not recognized with this variable. If a system
      administrator wants to restrict user access further by specifically denying
      a user's access from a particular host, the entry can be specified in the form
      of user@host.\n    * DenyGroups : *  The DenyGroups variable gives the system
      administrator the option of denying specific groups of users to ssh into the
      system. The list consists of space separated group names. Numeric group IDs
      are not recognized with this variable.\n    \n    Rationale: Restricting which
      users can remotely access the system via SSH will help ensure that only authorized
      users access the system.\n  \"\n  impact 1.0\n  describe.one do\n    describe
      file('/etc/ssh/sshd_config') do\n      its('content') { should match(/^(allowusers|allowgroups|denyusers|denygroups)\\s+(\\S+).*$/)
      }\n    end\n    describe file(\"/etc/ssh/sshd_config\") do\n      its(\"content\")
      { should match(/^\\s*(?i)(allow|deny)(users|groups)\\s+\\S+(\\s+.*)?$/) }\n
      \   end\n    describe package(\"openssh-server\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2735
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^(allowusers|allowgroups|denyusers|denygroups)\s+(\S+).*$/
      :run_time: 0.000197358
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(allowusers|allowgroups|denyusers|denygroups)\s+(\S+).*$/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^\s*(?i)(allow|deny)(users|groups)\s+\S+(\s+.*)?$/
      :run_time: 0.000110806
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^\s*(?i)(allow|deny)(users|groups)\s+\S+(\s+.*)?$/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000620405
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_SSH_LogLevel_is_appropriate
    :title: Ensure SSH LogLevel is appropriate
    :desc: |-
      INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.

      VERBOSE level specifies that login and logout activity as well as the key fingerprint for any SSH key used for login will be logged. This information is important for SSH key management, especially in legacy environments.

      Rationale: SSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically **not** recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information.
    :descriptions:
    - :label: default
      :data: |-
        INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.

        VERBOSE level specifies that login and logout activity as well as the key fingerprint for any SSH key used for login will be logged. This information is important for SSH key management, especially in legacy environments.

        Rationale: SSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically **not** recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_SSH_LogLevel_is_appropriate\"
      do\n  title \"Ensure SSH LogLevel is appropriate\"\n  desc  \"\n    INFO level
      is the basic level that only records login activity of SSH users. In many situations,
      such as Incident Response, it is important to determine when a particular user
      was active on a system. The logout record can eliminate those users who disconnected,
      which helps narrow the field.\n    \n    VERBOSE level specifies that login
      and logout activity as well as the key fingerprint for any SSH key used for
      login will be logged. This information is important for SSH key management,
      especially in legacy environments.\n    \n    Rationale: SSH provides several
      logging levels with varying amounts of verbosity. DEBUG is specifically **not**
      recommended other than strictly for debugging SSH communications since it provides
      so much data that it is difficult to identify important security information.\n
      \ \"\n  impact 1.0\n  if package('openssh-server').installed?\n    describe
      file(\"/etc/ssh/sshd_config\") do\n      its(\"content\") { should match(/^(?i)\\s*LogLevel\\s+(VERBOSE|INFO)/)
      }\n    end\n    describe file(\"/etc/ssh/sshd_config\") do\n      its(\"content\")
      { should_not match(/^(?i)\\s*LogLevel\\s+(QUIET|FATAL|ERROR|DEBUG|DEBUG1|DEBUG2|DEBUG3)/)
      }\n    end\n  else\n    describe package(\"openssh-server\") do\n      it {
      should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2761
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^(?i)\s*LogLevel\s+(VERBOSE|INFO)/
      :run_time: 0.000156041
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*LogLevel\s+(VERBOSE|INFO)/
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: passed
      :code_desc: File /etc/ssh/sshd_config content is expected not to match /^(?i)\s*LogLevel\s+(QUIET|FATAL|ERROR|DEBUG|DEBUG1|DEBUG2|DEBUG3)/
      :run_time: 8.5694e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_SSH_PAM_is_enabled
    :title: Ensure SSH PAM is enabled
    :desc: |-
      UsePAM Enables the Pluggable Authentication Module interface. If set to &#x201C;yes&#x201D; this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types

      Rationale: When usePAM is set to yes, PAM runs through account and session types properly.  This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment variables on login or disallow access to the server
    :descriptions:
    - :label: default
      :data: |-
        UsePAM Enables the Pluggable Authentication Module interface. If set to &#x201C;yes&#x201D; this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types

        Rationale: When usePAM is set to yes, PAM runs through account and session types properly.  This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment variables on login or disallow access to the server
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_SSH_PAM_is_enabled\"
      do\n  title \"Ensure SSH PAM is enabled\"\n  desc  \"\n    UsePAM Enables the
      Pluggable Authentication Module interface. If set to &#x201C;yes&#x201D; this
      will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication
      in addition to PAM account and session module processing for all authentication
      types\n    \n    Rationale: When usePAM is set to yes, PAM runs through account
      and session types properly.  This is important if you want to restrict access
      to services based off of IP, time or other factors of the account. Additionally,
      you can make sure users inherit certain environment variables on login or disallow
      access to the server\n  \"\n  impact 1.0\n  describe.one do\n    describe sshd_config
      do\n      its('UsePAM') { should match 'yes' }\n    end\n    describe package(\"openssh-server\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2785
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration UsePAM '
      :run_time: 0.000195439
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000310801
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_SSH_root_login_is_disabled
    :title: Ensure SSH root login is disabled
    :desc: |-
      The PermitRootLogin parameter specifies if the root user can log in using ssh. The default is no.

      Rationale: Disallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo or su . This in turn limits opportunity for non-repudiation and provides a clear audit trail in the event of a security incident
    :descriptions:
    - :label: default
      :data: |-
        The PermitRootLogin parameter specifies if the root user can log in using ssh. The default is no.

        Rationale: Disallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo or su . This in turn limits opportunity for non-repudiation and provides a clear audit trail in the event of a security incident
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_SSH_root_login_is_disabled\"
      do\n  title \"Ensure SSH root login is disabled\"\n  desc  \"\n    The PermitRootLogin
      parameter specifies if the root user can log in using ssh. The default is no.\n
      \   \n    Rationale: Disallowing root logins over SSH requires system admins
      to authenticate using their own individual account, then escalating to root
      via sudo or su . This in turn limits opportunity for non-repudiation and provides
      a clear audit trail in the event of a security incident\n  \"\n  impact 1.0\n
      \ describe.one do\n    describe sshd_config do\n      its('PermitRootLogin')
      { should eq 'no' }\n    end\n    describe package(\"openssh-server\") do\n      it
      { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2803
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration PermitRootLogin '
      :run_time: 0.000180556
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000290244
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_SSH_HostbasedAuthentication_is_disabled
    :title: Ensure SSH HostbasedAuthentication is disabled
    :desc: |-
      The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts , or /etc/hosts.equiv , along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.

      Rationale: Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , disabling the ability to use .rhosts files in SSH provides an additional layer of protection.
    :descriptions:
    - :label: default
      :data: |-
        The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts , or /etc/hosts.equiv , along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.

        Rationale: Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , disabling the ability to use .rhosts files in SSH provides an additional layer of protection.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_SSH_HostbasedAuthentication_is_disabled\"
      do\n  title \"Ensure SSH HostbasedAuthentication is disabled\"\n  desc  \"\n
      \   The HostbasedAuthentication parameter specifies if authentication is allowed
      through trusted hosts via the user of .rhosts , or /etc/hosts.equiv , along
      with successful public key client host authentication. This option only applies
      to SSH Protocol Version 2.\n    \n    Rationale: Even though the .rhosts files
      are ineffective if support is disabled in /etc/pam.conf , disabling the ability
      to use .rhosts files in SSH provides an additional layer of protection.\n  \"\n
      \ impact 1.0\n  describe.one do\n    describe sshd_config do\n      its('HostbasedAuthentication')
      { should eq 'no' }\n    end\n    describe package('openssh-server') do\n      it
      { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2821
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration HostbasedAuthentication '
      :run_time: 0.000183932
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000292807
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.9_Ensure_SSH_PermitEmptyPasswords_is_disabled
    :title: Ensure SSH PermitEmptyPasswords is disabled
    :desc: |-
      The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.

      Rationale: Disallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system
    :descriptions:
    - :label: default
      :data: |-
        The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.

        Rationale: Disallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.9_Ensure_SSH_PermitEmptyPasswords_is_disabled\"
      do\n  title \"Ensure SSH PermitEmptyPasswords is disabled\"\n  desc  \"\n    The
      PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts
      with empty password strings.\n    \n    Rationale: Disallowing remote shell
      access to accounts that have an empty password reduces the probability of unauthorized
      access to the system\n  \"\n  impact 1.0\n  describe.one do\n    describe sshd_config
      do\n      its('PermitEmptyPasswords') { should eq 'no' }\n    end\n    describe
      package('openssh-server') do\n      it { should_not be_installed }\n    end\n
      \ end\nend\n"
    :source_location:
      :line: 2839
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration PermitEmptyPasswords '
      :run_time: 0.000149534
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000319613
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.10_Ensure_SSH_PermitUserEnvironment_is_disabled
    :title: Ensure SSH PermitUserEnvironment is disabled
    :desc: |-
      The PermitUserEnvironment option allows users to present environment options to the ssh daemon.

      Rationale: Permitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing trojan'd programs)
    :descriptions:
    - :label: default
      :data: |-
        The PermitUserEnvironment option allows users to present environment options to the ssh daemon.

        Rationale: Permitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing trojan'd programs)
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.10_Ensure_SSH_PermitUserEnvironment_is_disabled\"
      do\n  title \"Ensure SSH PermitUserEnvironment is disabled\"\n  desc  \"\n    The
      PermitUserEnvironment option allows users to present environment options to
      the ssh daemon.\n    \n    Rationale: Permitting users the ability to set environment
      variables through the SSH daemon could potentially allow users to bypass security
      controls (e.g. setting an execution path that has ssh executing trojan'd programs)\n
      \ \"\n  impact 1.0\n  describe.one do\n    describe file(\"/etc/ssh/sshd_config\")
      do\n      its(\"content\") { should match(/^(?i)\\s*PermitUserEnvironment\\s+no/)
      }\n    end\n    describe package(\"openssh-server\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2857
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^(?i)\s*PermitUserEnvironment\s+no/
      :run_time: 0.000132575
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*PermitUserEnvironment\s+no/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000287555
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.11_Ensure_SSH_IgnoreRhosts_is_enabled
    :title: Ensure SSH IgnoreRhosts is enabled
    :desc: |-
      The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication .

      Rationale: Setting this parameter forces users to enter a password when authenticating with ssh.
    :descriptions:
    - :label: default
      :data: |-
        The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication .

        Rationale: Setting this parameter forces users to enter a password when authenticating with ssh.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.11_Ensure_SSH_IgnoreRhosts_is_enabled\"
      do\n  title \"Ensure SSH IgnoreRhosts is enabled\"\n  desc  \"\n    The IgnoreRhosts
      parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication
      or HostbasedAuthentication .\n    \n    Rationale: Setting this parameter forces
      users to enter a password when authenticating with ssh.\n  \"\n  impact 1.0\n
      \ describe.one do\n    describe file(\"/etc/ssh/sshd_config\") do\n      its(\"content\")
      { should match(/^(?i)\\s*ignorerhosts\\s+yes\\b/) }\n    end\n    describe package(\"openssh-server\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2875
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^(?i)\s*ignorerhosts\s+yes\b/
      :run_time: 0.000119215
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*ignorerhosts\s+yes\b/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000473621
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.12_Ensure_SSH_X11_forwarding_is_disabled
    :title: Ensure SSH X11 forwarding is disabled
    :desc: |-
      The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections.

      Rationale: Disable X11 forwarding unless there is an operational requirement to use X11 applications directly. There is a small risk that the remote X11 servers of users who are logged in via SSH with X11 forwarding could be compromised by other users on the X11 server. Note that even if X11 forwarding is disabled, users can always install their own forwarders.
    :descriptions:
    - :label: default
      :data: |-
        The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections.

        Rationale: Disable X11 forwarding unless there is an operational requirement to use X11 applications directly. There is a small risk that the remote X11 servers of users who are logged in via SSH with X11 forwarding could be compromised by other users on the X11 server. Note that even if X11 forwarding is disabled, users can always install their own forwarders.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.12_Ensure_SSH_X11_forwarding_is_disabled\"
      do\n  title \"Ensure SSH X11 forwarding is disabled\"\n  desc  \"\n    The X11Forwarding
      parameter provides the ability to tunnel X11 traffic through the connection
      to enable remote graphic connections.\n    \n    Rationale: Disable X11 forwarding
      unless there is an operational requirement to use X11 applications directly.
      There is a small risk that the remote X11 servers of users who are logged in
      via SSH with X11 forwarding could be compromised by other users on the X11 server.
      Note that even if X11 forwarding is disabled, users can always install their
      own forwarders.\n  \"\n  impact 1.0\n  describe.one do\n    describe file(\"/etc/ssh/sshd_config\")
      do\n      its(\"content\") { should match(/^(?i)\\s*x11forwarding\\s+no/) }\n
      \   end\n    describe package(\"openssh-server\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2893
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/ssh/sshd_config content is expected to match /^(?i)\s*x11forwarding\s+no/
      :run_time: 0.000129728
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*x11forwarding\s+no/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/ssh/sshd_config"]'
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000294957
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.14_Ensure_system-wide_crypto_policy_is_not_over-ridden
    :title: Ensure system-wide crypto policy is not over-ridden
    :desc: |-
      System-wide Crypto policy can be over-ridden or opted out of for openSSH

      Rationale: Over-riding or opting out of the system-wide crypto policy could allow for the use of less secure Ciphers, MACs, KexAlgorithms and GSSAPIKexAlgorithm
    :descriptions:
    - :label: default
      :data: |-
        System-wide Crypto policy can be over-ridden or opted out of for openSSH

        Rationale: Over-riding or opting out of the system-wide crypto policy could allow for the use of less secure Ciphers, MACs, KexAlgorithms and GSSAPIKexAlgorithm
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.14_Ensure_system-wide_crypto_policy_is_not_over-ridden\"
      do\n  title \"Ensure system-wide crypto policy is not over-ridden\"\n  desc
      \ \"\n    System-wide Crypto policy can be over-ridden or opted out of for openSSH\n
      \   \n    Rationale: Over-riding or opting out of the system-wide crypto policy
      could allow for the use of less secure Ciphers, MACs, KexAlgorithms and GSSAPIKexAlgorithm\n
      \ \"\n  impact 1.0\n  describe.one do\n    describe file(\"/etc/sysconfig/sshd\")
      do\n      its(\"content\") { should_not match(/(?i)^\\h*CRYPTO_POLICY\\h*=.*$/)
      }\n    end\n    describe package(\"openssh-server\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2911
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/sysconfig/sshd content is expected not to match /(?i)^\h*CRYPTO_POLICY\h*=.*$/
      :run_time: 8.4506e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/sysconfig/sshd"]'
      :resource_id: "/etc/sysconfig/sshd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.15_Ensure_SSH_warning_banner_is_configured
    :title: Ensure SSH warning banner is configured
    :desc: |-
      The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.

      Rationale: Banners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.
    :descriptions:
    - :label: default
      :data: |-
        The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.

        Rationale: Banners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.15_Ensure_SSH_warning_banner_is_configured\"
      do\n  title \"Ensure SSH warning banner is configured\"\n  desc  \"\n    The
      Banner parameter specifies a file whose contents must be sent to the remote
      user before authentication is permitted. By default, no banner is displayed.\n
      \   \n    Rationale: Banners are used to warn connecting users of the particular
      site's policy regarding connection. Presenting a warning message prior to the
      normal user login may assist the prosecution of trespassers on the computer
      system.\n  \"\n  impact 1.0\n  describe.one do\n    describe sshd_config do\n
      \     its('Banner') { should match '/etc/issue.net' }\n    end\n    describe
      package(\"openssh-server\") do\n      it { should_not be_installed }\n    end\n
      \ end\nend\n"
    :source_location:
      :line: 2929
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration Banner '
      :run_time: 0.000148166
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000441437
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.16_Ensure_SSH_MaxAuthTries_is_set_to_4_or_less
    :title: Ensure SSH MaxAuthTries is set to 4 or less
    :desc: |-
      The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.

      Rationale: Setting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.
    :descriptions:
    - :label: default
      :data: |-
        The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.

        Rationale: Setting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.16_Ensure_SSH_MaxAuthTries_is_set_to_4_or_less\"
      do\n  title \"Ensure SSH MaxAuthTries is set to 4 or less\"\n  desc  \"\n    The
      MaxAuthTries parameter specifies the maximum number of authentication attempts
      permitted per connection. When the login failure count reaches half the number,
      error messages will be written to the syslog file detailing the login failure.\n
      \   \n    Rationale: Setting the MaxAuthTries parameter to a low number will
      minimize the risk of successful brute force attacks to the SSH server. While
      the recommended setting is 4, set the number based on site policy.\n  \"\n  impact
      1.0\n  describe.one do\n    describe sshd_config do\n      its('MaxAuthTries')
      { should cmp <= 4 }\n    end\n    describe package(\"openssh-server\") do\n
      \     it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2947
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration MaxAuthTries '
      :run_time: 0.000216797
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000306726
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.17_Ensure_SSH_MaxStartups_is_configured
    :title: Ensure SSH MaxStartups is configured
    :desc: |-
      The MaxStartups parameter specifies the  maximum number of concurrent unauthenticated connections to the SSH daemon.

      Rationale: To protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.
    :descriptions:
    - :label: default
      :data: |-
        The MaxStartups parameter specifies the  maximum number of concurrent unauthenticated connections to the SSH daemon.

        Rationale: To protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.17_Ensure_SSH_MaxStartups_is_configured\"
      do\n  title \"Ensure SSH MaxStartups is configured\"\n  desc  \"\n    The MaxStartups
      parameter specifies the  maximum number of concurrent unauthenticated connections
      to the SSH daemon.\n    \n    Rationale: To protect a system from denial of
      service due to a large number of pending authentication connection attempts,
      use the rate limiting function of MaxStartups to protect availability of sshd
      logins and prevent overwhelming the daemon.\n  \"\n  impact 1.0\n  describe.one
      do\n    describe sshd_config do\n      its(\"MaxStartups\") { should eq \"#{max_startups}\"}\n
      \   end\n    describe package(\"openssh-server\") do\n      it { should_not
      be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2965
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration MaxStartups '
      :run_time: 0.00015102
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000281934
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.18_Ensure_SSH_MaxSessions_is_set_to_10_or_less
    :title: Ensure SSH MaxSessions is set to 10 or less
    :desc: |-
      The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.

      Rationale: To protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.
    :descriptions:
    - :label: default
      :data: |-
        The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.

        Rationale: To protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.18_Ensure_SSH_MaxSessions_is_set_to_10_or_less\"
      do\n  title \"Ensure SSH MaxSessions is set to 10 or less\"\n  desc  \"\n    The
      MaxSessions parameter specifies the maximum number of open sessions permitted
      from a given connection.\n    \n    Rationale: To protect a system from denial
      of service due to a large number of concurrent sessions, use the rate limiting
      function of MaxSessions to protect availability of sshd logins and prevent overwhelming
      the daemon.\n  \"\n  impact 1.0\n  describe.one do\n    describe sshd_config
      do\n      its('MaxSessions') { should cmp <= 10 }\n    end\n    describe package(\"openssh-server\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 2983
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration MaxSessions '
      :run_time: 0.00021512
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000287637
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.19_Ensure_SSH_LoginGraceTime_is_set_to_one_minute_or_less
    :title: Ensure SSH LoginGraceTime is set to one minute or less
    :desc: |-
      The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.

      Rationale: Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.
    :descriptions:
    - :label: default
      :data: |-
        The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.

        Rationale: Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.19_Ensure_SSH_LoginGraceTime_is_set_to_one_minute_or_less\"
      do\n  title \"Ensure SSH LoginGraceTime is set to one minute or less\"\n  desc
      \ \"\n    The LoginGraceTime parameter specifies the time allowed for successful
      authentication to the SSH server. The longer the Grace period is the more open
      unauthenticated connections can exist. Like other session controls in this session
      the Grace Period should be limited to appropriate organizational limits to ensure
      the service is available for needed access.\n    \n    Rationale: Setting the
      LoginGraceTime parameter to a low number will minimize the risk of successful
      brute force attacks to the SSH server. It will also limit the number of concurrent
      unauthenticated connections While the recommended setting is 60 seconds (1 Minute),
      set the number based on site policy.\n  \"\n  impact 1.0\n  describe.one do\n
      \   describe sshd_config do\n      its('LoginGraceTime') { should cmp <= 60
      }\n      its('LoginGraceTime') { should cmp > 0 }\n    end\n    describe sshd_config
      do\n      its('LoginGraceTime') { should eq '1m' }\n    end\n    describe package(\"openssh-server\")
      do\n      it { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 3001
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration LoginGraceTime '
      :run_time: 0.000204068
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: 'SSHD Configuration LoginGraceTime '
      :run_time: 0.000177219
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: 'SSHD Configuration LoginGraceTime '
      :run_time: 0.000302743
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000325423
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.2.20_Ensure_SSH_Idle_Timeout_Interval_is_configured
    :title: Ensure SSH Idle Timeout Interval is configured
    :desc: |-
      **NOTE:** To clarify, the two settings described below are only meant for idle connections from a protocol perspective and not meant to check if the user is active or not. An idle user does not mean an idle connection. SSH does not, and never had, intentionally the capability to drop idle users. In SSH versions before 8.2p1 there was a bug that caused these values to behave in such a manner that they were abused to disconnect idle users. This bug has been resolved in 8.2p1 and thus may no longer be abused disconnect idle users.

      The two options ClientAliveInterval and ClientAliveCountMax control the timeout of SSH sessions. Taken directly from man 5 sshd_config :

      * ClientAliveInterval Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client. The default is 0, indicating that these messages will not be sent to the client.

      * ClientAliveCountMax Sets the number of client alive messages which may be sent without sshd(8) receiving any messages back from the client. If this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating the session.  It is important to note that the use of client alive messages is very different from TCPKeepAlive. The client alive messages are sent through the encrypted channel and therefore will not be spoofable. The TCP keepalive option en&#x2010;abled by TCPKeepAlive is spoofable. The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.
      The default value is 3. If ClientAliveInterval is set to 15, and ClientAliveCountMax is left at the default, unresponsive SSH clients will be disconnected after approximately 45 seconds. Setting a zero ClientAliveCountMax disables connection termination.

      Rationale: In order to prevent resource exhaustion, appropriate values should be set for both ClientAliveInterval and ClientAliveCountMax . Specifically, looking at the source code, ClientAliveCountMax must be greater than zero in order to utilize the ability of SSH to drop idle connections. If connections are allowed to stay open indefinitely, this can potentially be used as a DDOS attack or simple resource exhaustion could occur over unreliable networks.

      The example set here is a 45 second timeout. Consult your site policy for network timeouts and apply as appropriate.
    :descriptions:
    - :label: default
      :data: |-
        **NOTE:** To clarify, the two settings described below are only meant for idle connections from a protocol perspective and not meant to check if the user is active or not. An idle user does not mean an idle connection. SSH does not, and never had, intentionally the capability to drop idle users. In SSH versions before 8.2p1 there was a bug that caused these values to behave in such a manner that they were abused to disconnect idle users. This bug has been resolved in 8.2p1 and thus may no longer be abused disconnect idle users.

        The two options ClientAliveInterval and ClientAliveCountMax control the timeout of SSH sessions. Taken directly from man 5 sshd_config :

        * ClientAliveInterval Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client. The default is 0, indicating that these messages will not be sent to the client.

        * ClientAliveCountMax Sets the number of client alive messages which may be sent without sshd(8) receiving any messages back from the client. If this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating the session.  It is important to note that the use of client alive messages is very different from TCPKeepAlive. The client alive messages are sent through the encrypted channel and therefore will not be spoofable. The TCP keepalive option en&#x2010;abled by TCPKeepAlive is spoofable. The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.
        The default value is 3. If ClientAliveInterval is set to 15, and ClientAliveCountMax is left at the default, unresponsive SSH clients will be disconnected after approximately 45 seconds. Setting a zero ClientAliveCountMax disables connection termination.

        Rationale: In order to prevent resource exhaustion, appropriate values should be set for both ClientAliveInterval and ClientAliveCountMax . Specifically, looking at the source code, ClientAliveCountMax must be greater than zero in order to utilize the ability of SSH to drop idle connections. If connections are allowed to stay open indefinitely, this can potentially be used as a DDOS attack or simple resource exhaustion could occur over unreliable networks.

        The example set here is a 45 second timeout. Consult your site policy for network timeouts and apply as appropriate.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.2.20_Ensure_SSH_Idle_Timeout_Interval_is_configured\"
      do\n  title \"Ensure SSH Idle Timeout Interval is configured\"\n  desc  \"\n
      \   **NOTE:** To clarify, the two settings described below are only meant for
      idle connections from a protocol perspective and not meant to check if the user
      is active or not. An idle user does not mean an idle connection. SSH does not,
      and never had, intentionally the capability to drop idle users. In SSH versions
      before 8.2p1 there was a bug that caused these values to behave in such a manner
      that they were abused to disconnect idle users. This bug has been resolved in
      8.2p1 and thus may no longer be abused disconnect idle users.\n    \n    The
      two options ClientAliveInterval and ClientAliveCountMax control the timeout
      of SSH sessions. Taken directly from man 5 sshd_config :\n    \n    * ClientAliveInterval
      Sets a timeout interval in seconds after which if no data has been received
      from the client, sshd(8) will send a message through the encrypted channel to
      request a response from the client. The default is 0, indicating that these
      messages will not be sent to the client.\n    \n    * ClientAliveCountMax Sets
      the number of client alive messages which may be sent without sshd(8) receiving
      any messages back from the client. If this threshold is reached while client
      alive messages are being sent, sshd will disconnect the client, terminating
      the session.  It is important to note that the use of client alive messages
      is very different from TCPKeepAlive. The client alive messages are sent through
      the encrypted channel and therefore will not be spoofable. The TCP keepalive
      option en&#x2010;abled by TCPKeepAlive is spoofable. The client alive mechanism
      is valuable when the client or server depend on knowing when a connection has
      become unresponsive.\n    The default value is 3. If ClientAliveInterval is
      set to 15, and ClientAliveCountMax is left at the default, unresponsive SSH
      clients will be disconnected after approximately 45 seconds. Setting a zero
      ClientAliveCountMax disables connection termination.\n    \n    Rationale: In
      order to prevent resource exhaustion, appropriate values should be set for both
      ClientAliveInterval and ClientAliveCountMax . Specifically, looking at the source
      code, ClientAliveCountMax must be greater than zero in order to utilize the
      ability of SSH to drop idle connections. If connections are allowed to stay
      open indefinitely, this can potentially be used as a DDOS attack or simple resource
      exhaustion could occur over unreliable networks.\n    \n    The example set
      here is a 45 second timeout. Consult your site policy for network timeouts and
      apply as appropriate.\n  \"\n  impact 1.0\n  describe.one do\n    describe sshd_config
      do\n      its('ClientAliveInterval') { should cmp > 0 }\n      its('ClientAliveCountMax')
      { should cmp > 0 }\n    end\n    describe package(\"openssh-server\") do\n      it
      { should_not be_installed }\n    end\n  end\nend\n"
    :source_location:
      :line: 3023
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'SSHD Configuration ClientAliveInterval '
      :run_time: 0.000204125
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: 'SSHD Configuration ClientAliveCountMax '
      :run_time: 0.000180682
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: 'Can''t read file: /etc/ssh/sshd_config'
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: sshd_config
      :resource_params: "[]"
      :resource_id: "/etc/ssh/sshd_config"
    - :status: failed
      :code_desc: System Package openssh-server is expected not to be installed
      :run_time: 0.000453318
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected System Package openssh-server not to be installed
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: package
      :resource_params: '["openssh-server"]'
      :resource_id: openssh-server
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_sudo_is_installed
    :title: Ensure sudo is installed
    :desc: |-
      sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy.  The invoking user's real (not effective) user ID is used to determine the user name with which to query the security policy.

      Rationale: sudo supports a plug-in architecture for security policies and input/output logging.  Third parties can develop and distribute their own policy and I/O logging plug-ins to work seamlessly with the sudo front end. The default security policy is sudoers , which is configured via the file /etc/sudoers and any entries in /etc/sudoers.d .

      The security policy determines what privileges, if any, a user has to run sudo . The policy may require that users authenticate themselves with a password or another authentication mechanism. If authentication is required, sudo will exit if the user's password is not entered within a configurable time limit. This limit is policy-specific.
    :descriptions:
    - :label: default
      :data: |-
        sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy.  The invoking user's real (not effective) user ID is used to determine the user name with which to query the security policy.

        Rationale: sudo supports a plug-in architecture for security policies and input/output logging.  Third parties can develop and distribute their own policy and I/O logging plug-ins to work seamlessly with the sudo front end. The default security policy is sudoers , which is configured via the file /etc/sudoers and any entries in /etc/sudoers.d .

        The security policy determines what privileges, if any, a user has to run sudo . The policy may require that users authenticate themselves with a password or another authentication mechanism. If authentication is required, sudo will exit if the user's password is not entered within a configurable time limit. This limit is policy-specific.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_sudo_is_installed\"
      do\n  title \"Ensure sudo is installed\"\n  desc  \"\n    sudo allows a permitted
      user to execute a command as the superuser or another user, as specified by
      the security policy.  The invoking user's real (not effective) user ID is used
      to determine the user name with which to query the security policy.\n    \n
      \   Rationale: sudo supports a plug-in architecture for security policies and
      input/output logging.  Third parties can develop and distribute their own policy
      and I/O logging plug-ins to work seamlessly with the sudo front end. The default
      security policy is sudoers , which is configured via the file /etc/sudoers and
      any entries in /etc/sudoers.d .\n    \n    The security policy determines what
      privileges, if any, a user has to run sudo . The policy may require that users
      authenticate themselves with a password or another authentication mechanism.
      If authentication is required, sudo will exit if the user's password is not
      entered within a configurable time limit. This limit is policy-specific.\n  \"\n
      \ impact 1.0\n  describe package(\"sudo\") do\n    it { should be_installed
      }\n  end\nend\n"
    :source_location:
      :line: 3051
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: System Package sudo is expected to be installed
      :run_time: 0.050908969
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: package
      :resource_params: '["sudo"]'
      :resource_id: sudo
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_sudo_commands_use_pty
    :title: Ensure sudo commands use pty
    :desc: |-
      sudo can be configured to run only from a pseudo terminal ( pseudo-pty ).

      Rationale: Attackers can run a malicious program using sudo which would fork a background process that remains even when the main program has finished executing.
    :descriptions:
    - :label: default
      :data: |-
        sudo can be configured to run only from a pseudo terminal ( pseudo-pty ).

        Rationale: Attackers can run a malicious program using sudo which would fork a background process that remains even when the main program has finished executing.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_sudo_commands_use_pty\"
      do\n  title \"Ensure sudo commands use pty\"\n  desc  \"\n    sudo can be configured
      to run only from a pseudo terminal ( pseudo-pty ).\n    \n    Rationale: Attackers
      can run a malicious program using sudo which would fork a background process
      that remains even when the main program has finished executing.\n  \"\n  impact
      1.0\n  describe.one do\n    describe file(\"/etc/sudoers\") do\n      its(\"content\")
      { should match(/^(?i)\\s*Defaults\\s+([^#]\\S+,\\s*)?use_pty\\b/) }\n    end\n
      \   files = command(\"find /etc/sudoers.d/ -type f -regex .\\\\*/.\\\\*\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^(?i)\\s*Defaults\\s+([^#]\\S+,\\s*)?use_pty\\b/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 3066
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/sudoers content is expected to match /^(?i)\s*Defaults\s+([^#]\S+,\s*)?use_pty\b/
      :run_time: 0.00027434
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*Defaults\s+([^#]\S+,\s*)?use_pty\b/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/sudoers"]'
      :resource_id: "/etc/sudoers"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000201681
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_sudo_log_file_exists
    :title: Ensure sudo log file exists
    :desc: |-
      sudo can use a custom log file

      Rationale: A sudo log file simplifies auditing of sudo commands
    :descriptions:
    - :label: default
      :data: |-
        sudo can use a custom log file

        Rationale: A sudo log file simplifies auditing of sudo commands
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_sudo_log_file_exists\"
      do\n  title \"Ensure sudo log file exists\"\n  desc  \"\n    sudo can use a
      custom log file\n    \n    Rationale: A sudo log file simplifies auditing of
      sudo commands\n  \"\n  impact 1.0\n  describe.one do\n    describe file(\"/etc/sudoers\")
      do\n      its(\"content\") { should match(/^(?i)\\s*Defaults\\s+([^#]+,\\s*)?logfile\\s*=\\s*(\")?\\S+(\"#{sudo_log_file}\")?$/)
      }\n    end\n    files = command(\"find /etc/sudoers.d -type f -regex .\\\\*/.\\\\*\").stdout.split\n
      \   describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content !~ /^(?i)\\s*Defaults\\s+([^#]+,\\s*)?logfile\\s*=\\s*(\")?\\S+(\"#{sudo_log_file}\")?$/
      } do\n      it { should_not be_empty }\n    end\n  end\nend\n"
    :source_location:
      :line: 3085
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/sudoers content is expected to match /^(?i)\s*Defaults\s+([^#]+,\s*)?logfile\s*=\s*(")?\S+("\/var\/log\/sudo.log")?$/
      :run_time: 0.000175519
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected nil to match /^(?i)\s*Defaults\s+([^#]+,\s*)?logfile\s*=\s*(")?\S+("\/var\/log\/sudo.log")?$/
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: file
      :resource_params: '["/etc/sudoers"]'
      :resource_id: "/etc/sudoers"
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000135686
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.5_Ensure_re-authentication_for_privilege_escalation_is_not_disabled_globally
    :title: Ensure re-authentication for privilege escalation is not disabled globally
    :desc: |-
      The operating system must be configured so that users must re-authenticate for privilege escalation.

      Rationale: Without re-authentication, users may access resources or perform tasks for which they do not have authorization.

      When operating systems provide the capability to escalate a functional capability, it is critical the user re-authenticate.
    :descriptions:
    - :label: default
      :data: |-
        The operating system must be configured so that users must re-authenticate for privilege escalation.

        Rationale: Without re-authentication, users may access resources or perform tasks for which they do not have authorization.

        When operating systems provide the capability to escalate a functional capability, it is critical the user re-authenticate.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.5_Ensure_re-authentication_for_privilege_escalation_is_not_disabled_globally\"
      do\n  title \"Ensure re-authentication for privilege escalation is not disabled
      globally\"\n  desc  \"\n    The operating system must be configured so that
      users must re-authenticate for privilege escalation.\n    \n    Rationale: Without
      re-authentication, users may access resources or perform tasks for which they
      do not have authorization.\n    \n    When operating systems provide the capability
      to escalate a functional capability, it is critical the user re-authenticate.\n
      \ \"\n  impact 1.0\n  describe file(\"/etc/sudoers\") do\n    its(\"content\")
      { should_not match(/(?i)^\\s*([^#\\n\\r]+\\s+)?\\!authenticate\\b(\\.*)?$/)
      }\n  end\n  files = command(\"find /etc/sudoers.d -type f -regex .\\\\*/.\\\\*\").stdout.split\n
      \ describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || !file(f).content.match(/(?i)^\\s*([^#\\n\\r]+\\s+)?\\!authenticate\\b(\\.*)?$/)
      } do\n    it { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3104
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/sudoers content is expected not to match /(?i)^\s*([^#\n\r]+\s+)?\!authenticate\b(\.*)?$/
      :run_time: 9.545e-05
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/sudoers"]'
      :resource_id: "/etc/sudoers"
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002529027
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.6_Ensure_sudo_authentication_timeout_is_configured_correctly
    :title: Ensure sudo authentication timeout is configured correctly
    :desc: |-
      sudo caches used credentials for a default of 5 minutes. This is for ease of use when there are multiple administrative tasks to perform. The timeout can be modified to suit local security policies.

      Rationale: Setting a timeout value reduces the window of opportunity for unauthorized privileged access to another user.
    :descriptions:
    - :label: default
      :data: |-
        sudo caches used credentials for a default of 5 minutes. This is for ease of use when there are multiple administrative tasks to perform. The timeout can be modified to suit local security policies.

        Rationale: Setting a timeout value reduces the window of opportunity for unauthorized privileged access to another user.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.6_Ensure_sudo_authentication_timeout_is_configured_correctly\"
      do\n  title \"Ensure sudo authentication timeout is configured correctly\"\n
      \ desc  \"\n    sudo caches used credentials for a default of 5 minutes. This
      is for ease of use when there are multiple administrative tasks to perform.
      The timeout can be modified to suit local security policies.\n    \n    Rationale:
      Setting a timeout value reduces the window of opportunity for unauthorized privileged
      access to another user.\n  \"\n  impact 1.0\n  describe file(\"/etc/sudoers\")
      do\n    its(\"content\") { should_not match(/(?i)^\\s*defaults\\s+(?:[^#\\n\\r]+\\s*,\\s*)?timestamp_timeout=(-1|1[6-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\\b(\\s*,\\s*.*)?$/)
      }\n  end\n  files = command(\"find /etc/sudoers.d/ -type f -regex .\\\\*/\\\\^.+\\\\\\\\.conf\\\\$\").stdout.split\n
      \ describe files.delete_if { |f| command(\"file #{f} | cut -d: -f2\").stdout
      =~ /binary|executable|archive/ || file(f).content =~ /(?i)^\\s*defaults\\s+(?:[^#\\n\\r]+\\s*,\\s*)?timestamp_timeout=(-1|1[6-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\\b(\\s*,\\s*.*)?$/
      } do\n    it { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3123
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/sudoers content is expected not to match /(?i)^\s*defaults\s+(?:[^#\n\r]+\s*,\s*)?timestamp_timeout=(-1|1[6-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\b(\s*,\s*.*)?$/
      :run_time: 0.00012095
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: file
      :resource_params: '["/etc/sudoers"]'
      :resource_id: "/etc/sudoers"
    - :status: passed
      :code_desc: "[] is expected to be empty"
      :run_time: 0.002347241
      :start_time: '2024-04-04T14:52:38+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.3.7_Ensure_access_to_the_su_command_is_restricted
    :title: Ensure access to the su command is restricted
    :desc: |-
      The su command allows a user to run a command or shell as another user. The program has been superseded by sudo , which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su , the su command will only allow users in a specific groups to execute su . This group should be empty to reinforce the use of sudo for privileged access.

      Rationale: Restricting the use of su , and using sudo in its place, provides system administrators better control of the escalation of user privileges to execute privileged commands. The sudo utility also provides a better logging and audit mechanism, as it can log each command executed via sudo , whereas su can only record that a user executed the su program.
    :descriptions:
    - :label: default
      :data: |-
        The su command allows a user to run a command or shell as another user. The program has been superseded by sudo , which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su , the su command will only allow users in a specific groups to execute su . This group should be empty to reinforce the use of sudo for privileged access.

        Rationale: Restricting the use of su , and using sudo in its place, provides system administrators better control of the escalation of user privileges to execute privileged commands. The sudo utility also provides a better logging and audit mechanism, as it can log each command executed via sudo , whereas su can only record that a user executed the su program.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.3.7_Ensure_access_to_the_su_command_is_restricted\"
      do\n  title \"Ensure access to the su command is restricted\"\n  desc  \"\n
      \   The su command allows a user to run a command or shell as another user.
      The program has been superseded by sudo , which allows for more granular control
      over privileged access. Normally, the su command can be executed by any user.
      By uncommenting the pam_wheel.so statement in /etc/pam.d/su , the su command
      will only allow users in a specific groups to execute su . This group should
      be empty to reinforce the use of sudo for privileged access.\n    \n    Rationale:
      Restricting the use of su , and using sudo in its place, provides system administrators
      better control of the escalation of user privileges to execute privileged commands.
      The sudo utility also provides a better logging and audit mechanism, as it can
      log each command executed via sudo , whereas su can only record that a user
      executed the su program.\n  \"\n  impact 1.0\n  describe file(\"/etc/pam.d/su\")
      do\n    its(\"content\") { should match(/(?i)^\\s*auth\\s+(?:required|requisite)\\s+pam_wheel\\.so\\s+(?:[^#\\n\\r]+\\s+)?((?!\\2)(use_uid\\b|group=\\S+\\b))\\s+(?:[^#\\n\\r]+\\s+)?((?!\\1)(use_uid\\b|group=\\S+\\b))(\\s+.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3140
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/pam.d/su content is expected to match /(?i)^\s*auth\s+(?:required|requisite)\s+pam_wheel\.so\s+(?:[^#\n\r]+\s+)?((?!\2)(use_uid\b|group=\S+\b))\s+(?:[^#\n\r]+\s+)?((?!\1)(use_uid\b|group=\S+\b))(\s+.*)?$/
      :run_time: 0.05270156
      :start_time: '2024-04-04T14:52:38+00:00'
      :message: "expected \"#%PAM-1.0\\nauth\\t\\trequired\\tpam_env.so\\nauth\\t\\tsufficient\\tpam_rootok.so\\n#
        Uncomment the followin...ion\\t\\tinclude\\t\\tsystem-auth\\nsession\\t\\tinclude\\t\\tpostlogin\\nsession\\t\\toptional\\tpam_xauth.so\\n\"
        to match /(?i)^\\s*auth\\s+(?:required|requisite)\\s+pam_wheel\\.so\\s+(?:[^#\\n\\r]+\\s+)?((?!\\2)(use_uid\\b|group=\\S+\\b))\\s+(?:[^#\\n\\r]+\\s+)?((?!\\1)(use_uid\\b|group=\\S+\\b))(\\s+.*)?$/\nDiff:\n@@
        -1,15 +1,29 @@\n-/(?i)^\\s*auth\\s+(?:required|requisite)\\s+pam_wheel\\.so\\s+(?:[^#\\n\\r]+\\s+)?((?!\\2)(use_uid\\b|group=\\S+\\b))\\s+(?:[^#\\n\\r]+\\s+)?((?!\\1)(use_uid\\b|group=\\S+\\b))(\\s+.*)?$/\n+#%PAM-1.0\n+auth\t\trequired\tpam_env.so\n+auth\t\tsufficient\tpam_rootok.so\n+#
        Uncomment the following line to implicitly trust users in the \"wheel\" group.\n+#auth\t\tsufficient\tpam_wheel.so
        trust use_uid\n+# Uncomment the following line to require a user to be in
        the \"wheel\" group.\n+#auth\t\trequired\tpam_wheel.so use_uid\n+auth\t\tsubstack\tsystem-auth\n+auth\t\tinclude\t\tpostlogin\n+account\t\tsufficient\tpam_succeed_if.so
        uid = 0 use_uid quiet\n+account\t\tinclude\t\tsystem-auth\n+password\tinclude\t\tsystem-auth\n+session\t\tinclude\t\tsystem-auth\n+session\t\tinclude\t\tpostlogin\n+session\t\toptional\tpam_xauth.so\n"
      :resource_class: file
      :resource_params: '["/etc/pam.d/su"]'
      :resource_id: "/etc/pam.d/su"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_custom_authselect_profile_is_used
    :title: Ensure custom authselect profile is used
    :desc: |-
      A custom profile can be created by copying and customizing one of the default profiles. The default profiles include: sssd, winbind, or the nis.  This profile can then be customized to follow site specific requirements.

      You can select a profile for the authselect utility for a specific host. The profile will be applied to every user logging into the host.

      Rationale: A custom profile is required to customize many of the pam options.

      When you deploy a profile, the profile is applied to every user logging into the given host
    :descriptions:
    - :label: default
      :data: |-
        A custom profile can be created by copying and customizing one of the default profiles. The default profiles include: sssd, winbind, or the nis.  This profile can then be customized to follow site specific requirements.

        You can select a profile for the authselect utility for a specific host. The profile will be applied to every user logging into the host.

        Rationale: A custom profile is required to customize many of the pam options.

        When you deploy a profile, the profile is applied to every user logging into the given host
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_custom_authselect_profile_is_used\"
      do\n  title \"Ensure custom authselect profile is used\"\n  desc  \"\n    A
      custom profile can be created by copying and customizing one of the default
      profiles. The default profiles include: sssd, winbind, or the nis.  This profile
      can then be customized to follow site specific requirements.\n    \n    You
      can select a profile for the authselect utility for a specific host. The profile
      will be applied to every user logging into the host.\n    \n    Rationale: A
      custom profile is required to customize many of the pam options.\n    \n    When
      you deploy a profile, the profile is applied to every user logging into the
      given host\n  \"\n  impact 0.0\n  describe file(\"/etc/authselect/authselect.conf\")
      do\n    its(\"content\") { should match(/(?i)^\\s*custom\\/\\S+\\b.*$/) }\n
      \ end\nend\n"
    :source_location:
      :line: 3153
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/authselect/authselect.conf content is expected to match
        /(?i)^\s*custom\/\S+\b.*$/
      :run_time: 0.058427436
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "sssd\n\n" to match /(?i)^\s*custom\/\S+\b.*$/
        Diff:
        @@ -1 +1 @@
        -/(?i)^\s*custom\/\S+\b.*$/
        +sssd
      :resource_class: file
      :resource_params: '["/etc/authselect/authselect.conf"]'
      :resource_id: "/etc/authselect/authselect.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_authselect_includes_with-faillock
    :title: Ensure authselect includes with-faillock
    :desc: |-
      The pam_faillock.so module maintains a list of failed authentication attempts per user during a specified interval and locks the account in case there were more than the configured number of consecutive failed authentications (this is defined by the deny parameter in the faillock configuration). It stores the failure records into per-user files in the tally directory.

      Rationale: Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.
    :descriptions:
    - :label: default
      :data: |-
        The pam_faillock.so module maintains a list of failed authentication attempts per user during a specified interval and locks the account in case there were more than the configured number of consecutive failed authentications (this is defined by the deny parameter in the faillock configuration). It stores the failure records into per-user files in the tally directory.

        Rationale: Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_authselect_includes_with-faillock\"
      do\n  title \"Ensure authselect includes with-faillock\"\n  desc  \"\n    The
      pam_faillock.so module maintains a list of failed authentication attempts per
      user during a specified interval and locks the account in case there were more
      than the configured number of consecutive failed authentications (this is defined
      by the deny parameter in the faillock configuration). It stores the failure
      records into per-user files in the tally directory.\n    \n    Rationale: Locking
      out user IDs after n unsuccessful consecutive login attempts mitigates brute
      force password attacks against your systems.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/pam.d/password-auth\") do\n    its(\"content\") { should match(/^\\s*auth\\s+required\\s+([^#\\r\\n]+\\s+)?pam_faillock\\.so\\s*(\\s+.*)?$/)
      }\n    its(\"content\") { should match(/^\\s*account\\s+required\\s+([^#\\r\\n]+\\s+)?pam_faillock\\.so\\s*(\\s+.*)?$/)
      }\n  end\n  describe file(\"/etc/pam.d/system-auth\") do\n    its(\"content\")
      { should match(/^\\s*auth\\s+required\\s+([^#\\r\\n]+\\s+)?pam_faillock\\.so\\s*(\\s+.*)?$/)
      }\n    its(\"content\") { should match(/^\\s*account\\s+required\\s+([^#\\r\\n]+\\s+)?pam_faillock\\.so\\s*(\\s+.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3170
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/pam.d/password-auth content is expected to match /^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
      :run_time: 0.001900113
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/password-auth"]'
      :resource_id: "/etc/authselect/password-auth"
    - :status: failed
      :code_desc: File /etc/pam.d/password-auth content is expected to match /^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
      :run_time: 0.001341095
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/password-auth"]'
      :resource_id: "/etc/authselect/password-auth"
    - :status: failed
      :code_desc: File /etc/pam.d/system-auth content is expected to match /^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
      :run_time: 0.001818078
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*auth\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/system-auth"]'
      :resource_id: "/etc/authselect/system-auth"
    - :status: failed
      :code_desc: File /etc/pam.d/system-auth content is expected to match /^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
      :run_time: 0.001323451
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*account\s+required\s+([^#\r\n]+\s+)?pam_faillock\.so\s*(\s+.*)?$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/system-auth"]'
      :resource_id: "/etc/authselect/system-auth"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.5.1_Ensure_password_creation_requirements_are_configured
    :title: Ensure password creation requirements are configured
    :desc: |-
      The pam_pwquality.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more. The following are definitions of the pam_pwquality.so options.

      * try_first_pass - retrieve the password from a previous stacked PAM module. If not available, then prompt the user for a password.
      * retry=3 - Allow 3 tries before sending back a failure.
      * minlen=14 - password must be 14 characters or more
      **Either of the following can be used to enforce complex passwords:**

      * minclass=4 - provide at least four classes of characters for the new password
      **OR**

      * dcredit=-1 - provide at least one digit
      * ucredit=-1 - provide at least one uppercase character
      * ocredit=-1 - provide at least one special character
      * lcredit=-1 - provide at least one lowercase character
      The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies

      Rationale: Strong passwords protect systems from being hacked through brute force methods.
    :descriptions:
    - :label: default
      :data: |-
        The pam_pwquality.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more. The following are definitions of the pam_pwquality.so options.

        * try_first_pass - retrieve the password from a previous stacked PAM module. If not available, then prompt the user for a password.
        * retry=3 - Allow 3 tries before sending back a failure.
        * minlen=14 - password must be 14 characters or more
        **Either of the following can be used to enforce complex passwords:**

        * minclass=4 - provide at least four classes of characters for the new password
        **OR**

        * dcredit=-1 - provide at least one digit
        * ucredit=-1 - provide at least one uppercase character
        * ocredit=-1 - provide at least one special character
        * lcredit=-1 - provide at least one lowercase character
        The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies

        Rationale: Strong passwords protect systems from being hacked through brute force methods.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.5.1_Ensure_password_creation_requirements_are_configured\"
      do\n  title \"Ensure password creation requirements are configured\"\n  desc
      \ \"\n    The pam_pwquality.so module checks the strength of passwords. It performs
      checks such as making sure a password is not a dictionary word, it is a certain
      length, contains a mix of characters (e.g. alphabet, numeric, other) and more.
      The following are definitions of the pam_pwquality.so options.\n    \n    *
      try_first_pass - retrieve the password from a previous stacked PAM module. If
      not available, then prompt the user for a password.\n    * retry=3 - Allow 3
      tries before sending back a failure.\n    * minlen=14 - password must be 14
      characters or more\n    **Either of the following can be used to enforce complex
      passwords:**\n    \n    * minclass=4 - provide at least four classes of characters
      for the new password\n    **OR**\n    \n    * dcredit=-1 - provide at least
      one digit\n    * ucredit=-1 - provide at least one uppercase character\n    *
      ocredit=-1 - provide at least one special character\n    * lcredit=-1 - provide
      at least one lowercase character\n    The settings shown above are one possible
      policy. Alter these values to conform to your own organization's password policies\n
      \   \n    Rationale: Strong passwords protect systems from being hacked through
      brute force methods.\n  \"\n  impact 1.0\n  describe file(\"/etc/pam.d/password-auth\")
      do\n    its(\"content\") { should match(/^\\s*password\\s+requisite\\s+pam_pwquality.so\\s+(\\S+\\s+)*retry=[1-3]\\s*(\\s+\\S+\\s*)*(\\s+#.*)*$/)
      }\n  end\n  describe file(\"/etc/pam.d/system-auth\") do\n    its(\"content\")
      { should match(/^\\s*password\\s+requisite\\s+pam_pwquality.so\\s+(\\S+\\s+)*retry=[1-3]\\s*(\\s+\\S+\\s*)*(\\s+#.*)*$/)
      }\n  end\n  describe file(\"/etc/security/pwquality.conf\") do\n    its(\"content\")
      { should match(/^\\s*minlen\\s*=\\s*(1[4-9]|[2-9][0-9]|[1-9][0-9][0-9])\\b\\s*(#.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3188
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/pam.d/password-auth content is expected to match /^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
      :run_time: 0.000582409
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/password-auth"]'
      :resource_id: "/etc/authselect/password-auth"
    - :status: failed
      :code_desc: File /etc/pam.d/system-auth content is expected to match /^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
      :run_time: 0.000578451
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*password\s+requisite\s+pam_pwquality.so\s+(\S+\s+)*retry=[1-3]\s*(\s+\S+\s*)*(\s+#.*)*$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/system-auth"]'
      :resource_id: "/etc/authselect/system-auth"
    - :status: failed
      :code_desc: File /etc/security/pwquality.conf content is expected to match /^\s*minlen\s*=\s*(1[4-9]|[2-9][0-9]|[1-9][0-9][0-9])\b\s*(#.*)?$/
      :run_time: 0.05062083
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Configuration for systemwide password quality limits\n# Defaults:\n#\n# Number of characters in th... not present in the\n# /etc/passwd file.\n# Enabled if the option is present.\n# local_users_only\n" to match /^\s*minlen\s*=\s*(1[4-9]|[2-9][0-9]|[1-9][0-9][0-9])\b\s*(#.*)?$/
        Diff:
        @@ -1,79 +1,157 @@
        -/^\s*minlen\s*=\s*(1[4-9]|[2-9][0-9]|[1-9][0-9][0-9])\b\s*(#.*)?$/
        +# Configuration for systemwide password quality limits
        +# Defaults:
        +#
        +# Number of characters in the new password that must not be present in the
        +# old password.
        +# difok = 1
        +#
        +# Minimum acceptable size for the new password (plus one if
        +# credits are not disabled which is the default). (See pam_cracklib manual.)
        +# Cannot be set to lower value than 6.
        +# minlen = 8
        +#
        +# The maximum credit for having digits in the new password. If less than 0
        +# it is the minimum number of digits in the new password.
        +# dcredit = 0
        +#
        +# The maximum credit for having uppercase characters in the new password.
        +# If less than 0 it is the minimum number of uppercase characters in the new
        +# password.
        +# ucredit = 0
        +#
        +# The maximum credit for having lowercase characters in the new password.
        +# If less than 0 it is the minimum number of lowercase characters in the new
        +# password.
        +# lcredit = 0
        +#
        +# The maximum credit for having other characters in the new password.
        +# If less than 0 it is the minimum number of other characters in the new
        +# password.
        +# ocredit = 0
        +#
        +# The minimum number of required classes of characters for the new
        +# password (digits, uppercase, lowercase, others).
        +# minclass = 0
        +#
        +# The maximum number of allowed consecutive same characters in the new password.
        +# The check is disabled if the value is 0.
        +# maxrepeat = 0
        +#
        +# The maximum number of allowed consecutive characters of the same class in the
        +# new password.
        +# The check is disabled if the value is 0.
        +# maxclassrepeat = 0
        +#
        +# Whether to check for the words from the passwd entry GECOS string of the user.
        +# The check is enabled if the value is not 0.
        +# gecoscheck = 0
        +#
        +# Whether to check for the words from the cracklib dictionary.
        +# The check is enabled if the value is not 0.
        +# dictcheck = 1
        +#
        +# Whether to check if it contains the user name in some form.
        +# The check is enabled if the value is not 0.
        +# usercheck = 1
        +#
        +# Length of substrings from the username to check for in the password
        +# The check is enabled if the value is greater than 0 and usercheck is enabled.
        +# usersubstr = 0
        +#
        +# Whether the check is enforced by the PAM module and possibly other
        +# applications.
        +# The new password is rejected if it fails the check and the value is not 0.
        +# enforcing = 1
        +#
        +# Path to the cracklib dictionaries. Default is to use the cracklib default.
        +# dictpath =
        +#
        +# Prompt user at most N times before returning with error. The default is 1.
        +# retry = 3
        +#
        +# Enforces pwquality checks on the root user password.
        +# Enabled if the option is present.
        +# enforce_for_root
        +#
        +# Skip testing the password quality for users that are not present in the
        +# /etc/passwd file.
        +# Enabled if the option is present.
        +# local_users_only
      :resource_class: file
      :resource_params: '["/etc/security/pwquality.conf"]'
      :resource_id: "/etc/security/pwquality.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_lockout_for_failed_password_attempts_is_configured
    :title: Ensure lockout for failed password attempts is configured
    :desc: |-
      Lock out users after **n** unsuccessful consecutive login attempts.

      * deny=
      <n> - Number of attempts before the account is locked
      * unlock_time=<n> - Time in seconds before the account is unlocked
      **Note:** The maximum configurable value for unlock_time is 604800</n></n>

      Rationale: Locking out user IDs after **n** unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.
    :descriptions:
    - :label: default
      :data: |-
        Lock out users after **n** unsuccessful consecutive login attempts.

        * deny=
        <n> - Number of attempts before the account is locked
        * unlock_time=<n> - Time in seconds before the account is unlocked
        **Note:** The maximum configurable value for unlock_time is 604800</n></n>

        Rationale: Locking out user IDs after **n** unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_lockout_for_failed_password_attempts_is_configured\"
      do\n  title \"Ensure lockout for failed password attempts is configured\"\n
      \ desc  \"\n    Lock out users after **n** unsuccessful consecutive login attempts.\n
      \   \n    * deny=\n    <n> - Number of attempts before the account is locked\n
      \   * unlock_time=<n> - Time in seconds before the account is unlocked\n    **Note:**
      The maximum configurable value for unlock_time is 604800</n></n>\n    \n    Rationale:
      Locking out user IDs after **n** unsuccessful consecutive login attempts mitigates
      brute force password attacks against your systems.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/security/faillock.conf\") do\n    its(\"content\") { should match(/^\\s*deny\\s*=\\s*[1-5]\\b/)
      }\n    its(\"content\") { should match(/^\\s*unlock_time\\s*=\\s*(0|9[0-9][0-9]|[1-9][0-9][0-9][0-9]+)\\b/)
      }\n  end\nend\n"
    :source_location:
      :line: 3221
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/security/faillock.conf content is expected to match /^\s*deny\s*=\s*[1-5]\b/
      :run_time: 0.059087364
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*deny\s*=\s*[1-5]\b/
        Diff:
        @@ -1,62 +1,123 @@
        -/^\s*deny\s*=\s*[1-5]\b/
        +# Configuration for locking the user after multiple failed
        +# authentication attempts.
        +#
        +# The directory where the user files with the failure records are kept.
        +# The default is /var/run/faillock.
        +# dir = /var/run/faillock
        +#
        +# Will log the user name into the system log if the user is not found.
        +# Enabled if option is present.
        +# audit
        +#
        +# Don't print informative messages.
        +# Enabled if option is present.
        +# silent
        +#
        +# Don't log informative messages via syslog.
        +# Enabled if option is present.
        +# no_log_info
        +#
        +# Only track failed user authentications attempts for local users
        +# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
        +# The `faillock` command will also no longer track user failed
        +# authentication attempts. Enabling this option will prevent a
        +# double-lockout scenario where a user is locked out locally and
        +# in the centralized mechanism.
        +# Enabled if option is present.
        +# local_users_only
        +#
        +# Deny access if the number of consecutive authentication failures
        +# for this user during the recent interval exceeds n tries.
        +# The default is 3.
        +# deny = 3
        +#
        +# The length of the interval during which the consecutive
        +# authentication failures must happen for the user account
        +# lock out is <replaceable>n</replaceable> seconds.
        +# The default is 900 (15 minutes).
        +# fail_interval = 900
        +#
        +# The access will be re-enabled after n seconds after the lock out.
        +# The value 0 has the same meaning as value `never` - the access
        +# will not be re-enabled without resetting the faillock
        +# entries by the `faillock` command.
        +# The default is 600 (10 minutes).
        +# unlock_time = 600
        +#
        +# Root account can become locked as well as regular accounts.
        +# Enabled if option is present.
        +# even_deny_root
        +#
        +# This option implies the `even_deny_root` option.
        +# Allow access after n seconds to root account after the
        +# account is locked. In case the option is not specified
        +# the value is the same as of the `unlock_time` option.
        +# root_unlock_time = 900
        +#
        +# If a group name is specified with this option, members
        +# of the group will be handled by this module the same as
        +# the root account (the options `even_deny_root>` and
        +# `root_unlock_time` will apply to them.
        +# By default, the option is not set.
        +# admin_group = <admin_group_name>
      :resource_class: file
      :resource_params: '["/etc/security/faillock.conf"]'
      :resource_id: "/etc/security/faillock.conf"
    - :status: failed
      :code_desc: File /etc/security/faillock.conf content is expected to match /^\s*unlock_time\s*=\s*(0|9[0-9][0-9]|[1-9][0-9][0-9][0-9]+)\b/
      :run_time: 0.000984957
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*unlock_time\s*=\s*(0|9[0-9][0-9]|[1-9][0-9][0-9][0-9]+)\b/
        Diff:
        @@ -1,62 +1,123 @@
        -/^\s*unlock_time\s*=\s*(0|9[0-9][0-9]|[1-9][0-9][0-9][0-9]+)\b/
        +# Configuration for locking the user after multiple failed
        +# authentication attempts.
        +#
        +# The directory where the user files with the failure records are kept.
        +# The default is /var/run/faillock.
        +# dir = /var/run/faillock
        +#
        +# Will log the user name into the system log if the user is not found.
        +# Enabled if option is present.
        +# audit
        +#
        +# Don't print informative messages.
        +# Enabled if option is present.
        +# silent
        +#
        +# Don't log informative messages via syslog.
        +# Enabled if option is present.
        +# no_log_info
        +#
        +# Only track failed user authentications attempts for local users
        +# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
        +# The `faillock` command will also no longer track user failed
        +# authentication attempts. Enabling this option will prevent a
        +# double-lockout scenario where a user is locked out locally and
        +# in the centralized mechanism.
        +# Enabled if option is present.
        +# local_users_only
        +#
        +# Deny access if the number of consecutive authentication failures
        +# for this user during the recent interval exceeds n tries.
        +# The default is 3.
        +# deny = 3
        +#
        +# The length of the interval during which the consecutive
        +# authentication failures must happen for the user account
        +# lock out is <replaceable>n</replaceable> seconds.
        +# The default is 900 (15 minutes).
        +# fail_interval = 900
        +#
        +# The access will be re-enabled after n seconds after the lock out.
        +# The value 0 has the same meaning as value `never` - the access
        +# will not be re-enabled without resetting the faillock
        +# entries by the `faillock` command.
        +# The default is 600 (10 minutes).
        +# unlock_time = 600
        +#
        +# Root account can become locked as well as regular accounts.
        +# Enabled if option is present.
        +# even_deny_root
        +#
        +# This option implies the `even_deny_root` option.
        +# Allow access after n seconds to root account after the
        +# account is locked. In case the option is not specified
        +# the value is the same as of the `unlock_time` option.
        +# root_unlock_time = 900
        +#
        +# If a group name is specified with this option, members
        +# of the group will be handled by this module the same as
        +# the root account (the options `even_deny_root>` and
        +# `root_unlock_time` will apply to them.
        +# By default, the option is not set.
        +# admin_group = <admin_group_name>
      :resource_class: file
      :resource_params: '["/etc/security/faillock.conf"]'
      :resource_id: "/etc/security/faillock.conf"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_password_reuse_is_limited
    :title: Ensure password reuse is limited
    :desc: |-
      The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.

      * remember=5&gt; - Number of old passwords to remember

      Rationale: Forcing users not to reuse their past 5 passwords make it less likely that an attacker will be able to guess the password.

      **Note:** These change only apply to accounts configured on the local system.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.

        * remember=5&gt; - Number of old passwords to remember

        Rationale: Forcing users not to reuse their past 5 passwords make it less likely that an attacker will be able to guess the password.

        **Note:** These change only apply to accounts configured on the local system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_password_reuse_is_limited\"
      do\n  title \"Ensure password reuse is limited\"\n  desc  \"\n    The /etc/security/opasswd
      file stores the users' old passwords and can be checked to ensure that users
      are not recycling recent passwords.\n    \n    * remember=5&gt; - Number of
      old passwords to remember\n    \n    Rationale: Forcing users not to reuse their
      past 5 passwords make it less likely that an attacker will be able to guess
      the password.\n    \n    **Note:** These change only apply to accounts configured
      on the local system.\n  \"\n  impact 1.0\n  describe file(\"/etc/pam.d/system-auth\")
      do\n    its(\"content\") { should match(/^\\s*password\\s+(requisite|sufficient)\\s+(pam_pwhistory\\.so|pam_unix\\.so)\\s+([^#\\n\\r]+\\s+)?remember=([5-9]|[1-9][0-9]+)\\s*(\\s+.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3240
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/pam.d/system-auth content is expected to match /^\s*password\s+(requisite|sufficient)\s+(pam_pwhistory\.so|pam_unix\.so)\s+([^#\n\r]+\s+)?remember=([5-9]|[1-9][0-9]+)\s*(\s+.*)?$/
      :run_time: 0.000793687
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# Generated by authselect on Wed Jan 17 18:51:28 2024\n# Do not modify this file manually.\n\nauth  ...                 pam_unix.so\nsession     optional                                     pam_sss.so\n" to match /^\s*password\s+(requisite|sufficient)\s+(pam_pwhistory\.so|pam_unix\.so)\s+([^#\n\r]+\s+)?remember=([5-9]|[1-9][0-9]+)\s*(\s+.*)?$/
        Diff:
        @@ -1,30 +1,59 @@
        -/^\s*password\s+(requisite|sufficient)\s+(pam_pwhistory\.so|pam_unix\.so)\s+([^#\n\r]+\s+)?remember=([5-9]|[1-9][0-9]+)\s*(\s+.*)?$/
        +# Generated by authselect on Wed Jan 17 18:51:28 2024
        +# Do not modify this file manually.
        +
        +auth        required                                     pam_env.so
        +auth        required                                     pam_faildelay.so delay=2000000
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
        +auth        sufficient                                   pam_unix.so nullok
        +auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
        +auth        sufficient                                   pam_sss.so forward_pass
        +auth        required                                     pam_deny.so
        +
        +account     required                                     pam_unix.so
        +account     sufficient                                   pam_localuser.so
        +account     sufficient                                   pam_usertype.so issystem
        +account     [default=bad success=ok user_unknown=ignore] pam_sss.so
        +account     required                                     pam_permit.so
        +
        +password    requisite                                    pam_pwquality.so local_users_only
        +password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
        +password    [success=1 default=ignore]                   pam_localuser.so
        +password    sufficient                                   pam_sss.so use_authtok
        +password    required                                     pam_deny.so
        +
        +session     optional                                     pam_keyinit.so revoke
        +session     required                                     pam_limits.so
        +-session    optional                                     pam_systemd.so
        +session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
        +session     required                                     pam_unix.so
        +session     optional                                     pam_sss.so
      :resource_class: file
      :resource_params: '["/etc/pam.d/system-auth"]'
      :resource_id: "/etc/authselect/system-auth"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.5.4_Ensure_password_hashing_algorithm_is_SHA-512_or_yescrypt
    :title: Ensure password hashing algorithm is SHA-512 or yescrypt
    :desc: |-
      A cryptographic hash function converts an arbitrary-length input into a fixed length output. Password hashing performs a one-way transformation of a password, turning the password into another string, called the hashed password.

      Rationale: The SHA-512 algorithm provides stronger hashing than other hashing algorithms used for password hashing with Linux, providing additional protection to the system by increasing the level of effort for an attacker to successfully determine passwords.

      **Note:** These changes only apply to accounts configured on the local system.
    :descriptions:
    - :label: default
      :data: |-
        A cryptographic hash function converts an arbitrary-length input into a fixed length output. Password hashing performs a one-way transformation of a password, turning the password into another string, called the hashed password.

        Rationale: The SHA-512 algorithm provides stronger hashing than other hashing algorithms used for password hashing with Linux, providing additional protection to the system by increasing the level of effort for an attacker to successfully determine passwords.

        **Note:** These changes only apply to accounts configured on the local system.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.5.4_Ensure_password_hashing_algorithm_is_SHA-512_or_yescrypt\"
      do\n  title \"Ensure password hashing algorithm is SHA-512 or yescrypt\"\n  desc
      \ \"\n    A cryptographic hash function converts an arbitrary-length input into
      a fixed length output. Password hashing performs a one-way transformation of
      a password, turning the password into another string, called the hashed password.\n
      \   \n    Rationale: The SHA-512 algorithm provides stronger hashing than other
      hashing algorithms used for password hashing with Linux, providing additional
      protection to the system by increasing the level of effort for an attacker to
      successfully determine passwords.\n    \n    **Note:** These changes only apply
      to accounts configured on the local system.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/pam.d/password-auth\") do\n    its(\"content\") { should match(/^\\s*password\\s+(requisite|required|sufficient)\\s+pam_unix\\.so(\\s+[^#\\n\\r]+)?\\s+sha512\\b.*$/)
      }\n  end\n  describe file(\"/etc/pam.d/system-auth\") do\n    its(\"content\")
      { should match(/^\\s*password\\s+(requisite|required|sufficient)\\s+pam_unix\\.so(\\s+[^#\\n\\r]+)?\\s+sha512\\b.*$/)
      }\n  end\n  describe file(\"/etc/libuser.conf\") do\n    its(\"content\") {
      should match(/(?i)^\\s*crypt_style\\s*=\\s*sha512\\b/) }\n  end\n  describe
      file(\"/etc/login.defs\") do\n    its(\"content\") { should match(/(?i)^\\s*ENCRYPT_METHOD\\s+SHA512\\b/)
      }\n  end\nend\n"
    :source_location:
      :line: 3257
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/pam.d/password-auth content is expected to match /^\s*password\s+(requisite|required|sufficient)\s+pam_unix\.so(\s+[^#\n\r]+)?\s+sha512\b.*$/
      :run_time: 0.00013049
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/pam.d/password-auth"]'
      :resource_id: "/etc/authselect/password-auth"
    - :status: passed
      :code_desc: File /etc/pam.d/system-auth content is expected to match /^\s*password\s+(requisite|required|sufficient)\s+pam_unix\.so(\s+[^#\n\r]+)?\s+sha512\b.*$/
      :run_time: 0.000106994
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/pam.d/system-auth"]'
      :resource_id: "/etc/authselect/system-auth"
    - :status: passed
      :code_desc: File /etc/libuser.conf content is expected to match /(?i)^\s*crypt_style\s*=\s*sha512\b/
      :run_time: 0.056259115
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/libuser.conf"]'
      :resource_id: "/etc/libuser.conf"
    - :status: passed
      :code_desc: File /etc/login.defs content is expected to match /(?i)^\s*ENCRYPT_METHOD\s+SHA512\b/
      :run_time: 0.000251961
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/login.defs"]'
      :resource_id: "/etc/login.defs"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.1.1_Ensure_password_expiration_is_365_days_or_less
    :title: Ensure password expiration is 365 days or less
    :desc: |-
      The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age.  It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.

      Rationale: The window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attacker's window of opportunity.
    :descriptions:
    - :label: default
      :data: |-
        The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age.  It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.

        Rationale: The window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attacker's window of opportunity.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.1.1_Ensure_password_expiration_is_365_days_or_less\"
      do\n  title \"Ensure password expiration is 365 days or less\"\n  desc  \"\n
      \   The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to
      force passwords to expire once they reach a defined age.  It is recommended
      that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.\n
      \   \n    Rationale: The window of opportunity for an attacker to leverage compromised
      credentials or successfully compromise credentials via an online brute force
      attack is limited by the age of the password. Therefore, reducing the maximum
      age of a password also reduces an attacker's window of opportunity.\n  \"\n
      \ impact 1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\")
      { should match(/^\\s*PASS_MAX_DAYS\\s+(36[0-5]|3[0-5][0-9]|[1-2][0-9][0-9]|[1-9][0-9]?)\\s*(\\s+#.*)?$/)
      }\n  end\n  describe shadow.where { user =~ /.+/ and password =~ /^[^!*]/ and
      (max_days.nil? or max_days.to_i > 365) } do\n    its(\"raw_data\") { should
      be_empty }\n  end\nend\n"
    :source_location:
      :line: 3281
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/login.defs content is expected to match /^\s*PASS_MAX_DAYS\s+(36[0-5]|3[0-5][0-9]|[1-2][0-9][0-9]|[1-9][0-9]?)\s*(\s+#.*)?$/
      :run_time: 0.0022509
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: "expected \"#\\n# Please note that the parameters in this configuration
        file control the\\n# behavior of the tools... to see the possible algorithms\\n#
        that are available in your system.\\n#\\nHMAC_CRYPTO_ALGO SHA512\\n\" to match
        /^\\s*PASS_MAX_DAYS\\s+(36[0-5]|3[0-5][0-9]|[1-2][0-9][0-9]|[1-9][0-9]?)\\s*(\\s+#.*)?$/\nDiff:\n@@
        -1,278 +1,555 @@\n-/^\\s*PASS_MAX_DAYS\\s+(36[0-5]|3[0-5][0-9]|[1-2][0-9][0-9]|[1-9][0-9]?)\\s*(\\s+#.*)?$/\n+#\n+#
        Please note that the parameters in this configuration file control the\n+#
        behavior of the tools from the shadow-utils component. None of these\n+# tools
        uses the PAM mechanism, and the utilities that use PAM (such as the\n+# passwd
        command) should therefore be configured elsewhere. Refer to\n+# /etc/pam.d/system-auth
        for more information.\n+#\n+\n+#\n+# Delay in seconds before being allowed
        another attempt after a login failure\n+# Note: When PAM is used, some modules
        may enforce a minimum delay (e.g.\n+#       pam_unix(8) enforces a 2s delay)\n+#\n+#FAIL_DELAY\t\t3\n+\n+#
        Currently FAILLOG_ENAB is not supported\n+\n+#\n+# Enable display of unknown
        usernames when login(1) failures are recorded.\n+#\n+#LOG_UNKFAIL_ENAB\tno\n+\n+#
        Currently LOG_OK_LOGINS is not supported\n+\n+# Currently LASTLOG_ENAB is
        not supported\n+\n+#\n+# Limit the highest user ID number for which the lastlog
        entries should\n+# be updated.\n+#\n+# No LASTLOG_UID_MAX means that there
        is no user ID limit for writing\n+# lastlog entries.\n+#\n+#LASTLOG_UID_MAX\n+\n+#
        Currently MAIL_CHECK_ENAB is not supported\n+\n+# Currently OBSCURE_CHECKS_ENAB
        is not supported\n+\n+# Currently PORTTIME_CHECKS_ENAB is not supported\n+\n+#
        Currently QUOTAS_ENAB is not supported\n+\n+# Currently SYSLOG_SU_ENAB is
        not supported\n+\n+#\n+# Enable \"syslog\" logging of newgrp(1) and sg(1)
        activity.\n+#\n+#SYSLOG_SG_ENAB\t\tyes\n+\n+# Currently CONSOLE is not supported\n+\n+#
        Currently SULOG_FILE is not supported\n+\n+# Currently MOTD_FILE is not supported\n+\n+#
        Currently ISSUE_FILE is not supported\n+\n+# Currently TTYTYPE_FILE is not
        supported\n+\n+# Currently FTMP_FILE is not supported\n+\n+# Currently NOLOGINS_FILE
        is not supported\n+\n+# Currently SU_NAME is not supported\n+\n+# *REQUIRED*\n+#
        \  Directory where mailboxes reside, _or_ name of file, relative to the\n+#
        \  home directory.  If you _do_ define both, MAIL_DIR takes precedence.\n+#\n+MAIL_DIR\t/var/spool/mail\n+#MAIL_FILE\t.mail\n+\n+#\n+#
        If defined, file which inhibits all the usual chatter during the login\n+#
        sequence.  If a full pathname, then hushed mode will be enabled if the\n+#
        user's name or shell are found in the file.  If not a full pathname, then\n+#
        hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+#HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#
        Currently ENV_TZ is not supported\n+\n+# Currently ENV_HZ is not supported\n+\n+#\n+#
        The default PATH settings, for superuser and normal users.\n+#\n+# (they are
        minimal, add the rest in the shell startup files)\n+#ENV_SUPATH\tPATH=/sbin:/bin:/usr/sbin:/usr/bin\n+#ENV_PATH\tPATH=/bin:/usr/bin\n+\n+#\n+#
        Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group
        ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+#
        If you have a write(1) program which is \"setgid\" to a special group\n+#
        which owns the terminals, define TTYGROUP as the number of such group\n+#
        and TTYPERM as 0620.  Otherwise leave TTYGROUP commented out and\n+# set TTYPERM
        to either 622 or 600.\n+#\n+#TTYGROUP\ttty\n+#TTYPERM\t\t0600\n+\n+# Currently
        ERASECHAR, KILLCHAR and ULIMIT are not supported\n+\n+# Default initial \"umask\"
        value used by login(1) on non-PAM enabled systems.\n+# Default \"umask\" value
        for pam_umask(8) on PAM enabled systems.\n+# UMASK is also used by useradd(8)
        and newusers(8) to set the mode for new\n+# home directories if HOME_MODE
        is not set.\n+# 022 is the default value, but 027, or even 077, could be considered\n+#
        for increased privacy. There is no One True Answer here: each sysadmin\n+#
        must make up their mind.\n+UMASK\t\t022\n+\n+# HOME_MODE is used by useradd(8)
        and newusers(8) to set the mode for new\n+# home directories.\n+# If HOME_MODE
        is not set, the value of UMASK is used to create the mode.\n+HOME_MODE\t0700\n+\n+#
        Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a
        password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between
        password changes.\n+#\tPASS_MIN_LEN\tMinimum acceptable password length.\n+#\tPASS_WARN_AGE\tNumber
        of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#
        Currently PASS_MIN_LEN is not supported\n+\n+# Currently SU_WHEEL_ONLY is
        not supported\n+\n+# Currently CRACKLIB_DICTPATH is not supported\n+\n+#\n+#
        Min/max values for automatic uid selection in useradd(8)\n+#\n+UID_MIN                  1000\n+UID_MAX
        \                60000\n+# System accounts\n+SYS_UID_MIN               201\n+SYS_UID_MAX
        \              999\n+# Extra per user uids\n+SUB_UID_MIN\t\t   100000\n+SUB_UID_MAX\t\t600100000\n+SUB_UID_COUNT\t\t
        \   65536\n+\n+#\n+# Min/max values for automatic gid selection in groupadd(8)\n+#\n+GID_MIN
        \                 1000\n+GID_MAX                 60000\n+# System accounts\n+SYS_GID_MIN
        \              201\n+SYS_GID_MAX               999\n+# Extra per user group
        ids\n+SUB_GID_MIN\t\t   100000\n+SUB_GID_MAX\t\t600100000\n+SUB_GID_COUNT\t\t
        \   65536\n+\n+#\n+# Max number of login(1) retries if password is bad\n+#\n+#LOGIN_RETRIES\t\t3\n+\n+#\n+#
        Max time in seconds for login(1)\n+#\n+#LOGIN_TIMEOUT\t\t60\n+\n+# Currently
        PASS_CHANGE_TRIES is not supported\n+\n+# Currently PASS_ALWAYS_WARN is not
        supported\n+\n+# Currently PASS_MAX_LEN is not supported\n+\n+# Currently
        CHFN_AUTH is not supported\n+\n+#\n+# Which fields may be changed by regular
        users using chfn(1) - use\n+# any combination of letters \"frwh\" (full name,
        room number, work\n+# phone, home phone).  If not defined, no changes are
        allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+#
        \n+#CHFN_RESTRICT\t\trwh\n+\n+# Currently LOGIN_STRING is not supported\n+\n+#
        Currently MD5_CRYPT_ENAB is not supported\n+\n+#\n+# If set to MD5, MD5-based
        algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based
        algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based
        algorithm will be used for encrypting password\n+# If set to BLOWFISH, BLOWFISH-based
        algorithm will be used for encrypting password\n+# If set to DES, DES-based
        algorithm will be used for encrypting password (default)\n+#\n+ENCRYPT_METHOD
        SHA512\n+\n+#\n+# Only works if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+#
        Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult
        to brute-force the password.\n+# However, more CPU resources will be needed
        to authenticate users if\n+# this value is increased.\n+#\n+# If not specified,
        the libc will choose the default number of rounds (5000).\n+# The values must
        be within the 1000-999999999 range.\n+#\n+#SHA_CRYPT_MAX_ROUNDS 5000\n+\n+#
        Currently SHA_CRYPT_MIN_ROUNDS is not supported\n+\n+# Currently BCRYPT_MIN_ROUNDS
        and BCRYPT_MAX_ROUNDS are not supported\n+\n+# Currently CONSOLE_GROUPS is
        not supported\n+\n+#\n+# Should login be allowed if we can't cd to the home
        directory?\n+# Default is yes.\n+#\n+#DEFAULT_HOME\tyes\n+\n+# Currently ENVIRON_FILE
        is not supported\n+\n+#\n+# If defined, this command is run when removing
        a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the
        user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+#
        Enables userdel(8) to remove user groups if no members exist.\n+#\n+USERGROUPS_ENAB
        yes\n+\n+#\n+# If set to a non-zero number, the shadow utilities will make
        sure that\n+# groups never have more than this number of users on one line.\n+#
        This permits to support split groups (groups split into multiple lines,\n+#
        with the same group ID, to avoid limitation of the line length in the\n+#
        group file).\n+#\n+# 0 is the default value and disables this feature.\n+#\n+#MAX_MEMBERS_PER_GROUP\t0\n+\n+#\n+#
        If useradd(8) should create home directories for users by default (non\n+#
        system users only).\n+# This option is overridden with the -M or -m flags
        on the useradd(8)\n+# command-line.\n+#\n+CREATE_HOME\tyes\n+\n+#\n+# Force
        use shadow, even if shadow passwd & shadow group files are\n+# missing.\n+#\n+#FORCE_SHADOW
        \   yes\n+\n+#\n+# Select the HMAC cryptography algorithm.\n+# Used in pam_timestamp
        module to calculate the keyed-hash message\n+# authentication code.\n+#\n+#
        Note: It is recommended to check hmac(3) to see the possible algorithms\n+#
        that are available in your system.\n+#\n+HMAC_CRYPTO_ALGO SHA512\n"
      :resource_class: file
      :resource_params: '["/etc/login.defs"]'
      :resource_id: "/etc/login.defs"
    - :status: skipped
      :code_desc: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :run_time: 6.626e-06
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :skip_message: 'Can''t read file: /etc/shadow'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: !ruby/object:FilterTable::ExceptionCatcher {}
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.1.2_Ensure_minimum_days_between_password_changes_is__configured
    :title: Ensure minimum days between password changes is  configured
    :desc: |-
      The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 1 or more days.

      Rationale: By restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls.
    :descriptions:
    - :label: default
      :data: |-
        The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 1 or more days.

        Rationale: By restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.1.2_Ensure_minimum_days_between_password_changes_is__configured\"
      do\n  title \"Ensure minimum days between password changes is  configured\"\n
      \ desc  \"\n    The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator
      to prevent users from changing their password until a minimum number of days
      have passed since the last time the user changed their password. It is recommended
      that PASS_MIN_DAYS parameter be set to 1 or more days.\n    \n    Rationale:
      By restricting the frequency of password changes, an administrator can prevent
      users from repeatedly changing their password in an attempt to circumvent password
      reuse controls.\n  \"\n  impact 1.0\n  describe file(\"/etc/login.defs\") do\n
      \   its(\"content\") { should match(/^\\s*PASS_MIN_DAYS\\s+([1-9]|[1-9][0-9]+)\\s*(\\s+#.*)?$/)
      }\n  end\n  describe file(\"/etc/shadow\") do\n    its(\"content\") { should_not
      match(/^\\S+:[^\\!\\*:]*:[^:]*:(0|\\-1):[^:]*:[^:]*:[^:]*:[^:]*:[^:]*\\s*$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3297
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/login.defs content is expected to match /^\s*PASS_MIN_DAYS\s+([1-9]|[1-9][0-9]+)\s*(\s+#.*)?$/
      :run_time: 0.002125945
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: "expected \"#\\n# Please note that the parameters in this configuration
        file control the\\n# behavior of the tools... to see the possible algorithms\\n#
        that are available in your system.\\n#\\nHMAC_CRYPTO_ALGO SHA512\\n\" to match
        /^\\s*PASS_MIN_DAYS\\s+([1-9]|[1-9][0-9]+)\\s*(\\s+#.*)?$/\nDiff:\n@@ -1,278
        +1,555 @@\n-/^\\s*PASS_MIN_DAYS\\s+([1-9]|[1-9][0-9]+)\\s*(\\s+#.*)?$/\n+#\n+#
        Please note that the parameters in this configuration file control the\n+#
        behavior of the tools from the shadow-utils component. None of these\n+# tools
        uses the PAM mechanism, and the utilities that use PAM (such as the\n+# passwd
        command) should therefore be configured elsewhere. Refer to\n+# /etc/pam.d/system-auth
        for more information.\n+#\n+\n+#\n+# Delay in seconds before being allowed
        another attempt after a login failure\n+# Note: When PAM is used, some modules
        may enforce a minimum delay (e.g.\n+#       pam_unix(8) enforces a 2s delay)\n+#\n+#FAIL_DELAY\t\t3\n+\n+#
        Currently FAILLOG_ENAB is not supported\n+\n+#\n+# Enable display of unknown
        usernames when login(1) failures are recorded.\n+#\n+#LOG_UNKFAIL_ENAB\tno\n+\n+#
        Currently LOG_OK_LOGINS is not supported\n+\n+# Currently LASTLOG_ENAB is
        not supported\n+\n+#\n+# Limit the highest user ID number for which the lastlog
        entries should\n+# be updated.\n+#\n+# No LASTLOG_UID_MAX means that there
        is no user ID limit for writing\n+# lastlog entries.\n+#\n+#LASTLOG_UID_MAX\n+\n+#
        Currently MAIL_CHECK_ENAB is not supported\n+\n+# Currently OBSCURE_CHECKS_ENAB
        is not supported\n+\n+# Currently PORTTIME_CHECKS_ENAB is not supported\n+\n+#
        Currently QUOTAS_ENAB is not supported\n+\n+# Currently SYSLOG_SU_ENAB is
        not supported\n+\n+#\n+# Enable \"syslog\" logging of newgrp(1) and sg(1)
        activity.\n+#\n+#SYSLOG_SG_ENAB\t\tyes\n+\n+# Currently CONSOLE is not supported\n+\n+#
        Currently SULOG_FILE is not supported\n+\n+# Currently MOTD_FILE is not supported\n+\n+#
        Currently ISSUE_FILE is not supported\n+\n+# Currently TTYTYPE_FILE is not
        supported\n+\n+# Currently FTMP_FILE is not supported\n+\n+# Currently NOLOGINS_FILE
        is not supported\n+\n+# Currently SU_NAME is not supported\n+\n+# *REQUIRED*\n+#
        \  Directory where mailboxes reside, _or_ name of file, relative to the\n+#
        \  home directory.  If you _do_ define both, MAIL_DIR takes precedence.\n+#\n+MAIL_DIR\t/var/spool/mail\n+#MAIL_FILE\t.mail\n+\n+#\n+#
        If defined, file which inhibits all the usual chatter during the login\n+#
        sequence.  If a full pathname, then hushed mode will be enabled if the\n+#
        user's name or shell are found in the file.  If not a full pathname, then\n+#
        hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+#HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#
        Currently ENV_TZ is not supported\n+\n+# Currently ENV_HZ is not supported\n+\n+#\n+#
        The default PATH settings, for superuser and normal users.\n+#\n+# (they are
        minimal, add the rest in the shell startup files)\n+#ENV_SUPATH\tPATH=/sbin:/bin:/usr/sbin:/usr/bin\n+#ENV_PATH\tPATH=/bin:/usr/bin\n+\n+#\n+#
        Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group
        ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+#
        If you have a write(1) program which is \"setgid\" to a special group\n+#
        which owns the terminals, define TTYGROUP as the number of such group\n+#
        and TTYPERM as 0620.  Otherwise leave TTYGROUP commented out and\n+# set TTYPERM
        to either 622 or 600.\n+#\n+#TTYGROUP\ttty\n+#TTYPERM\t\t0600\n+\n+# Currently
        ERASECHAR, KILLCHAR and ULIMIT are not supported\n+\n+# Default initial \"umask\"
        value used by login(1) on non-PAM enabled systems.\n+# Default \"umask\" value
        for pam_umask(8) on PAM enabled systems.\n+# UMASK is also used by useradd(8)
        and newusers(8) to set the mode for new\n+# home directories if HOME_MODE
        is not set.\n+# 022 is the default value, but 027, or even 077, could be considered\n+#
        for increased privacy. There is no One True Answer here: each sysadmin\n+#
        must make up their mind.\n+UMASK\t\t022\n+\n+# HOME_MODE is used by useradd(8)
        and newusers(8) to set the mode for new\n+# home directories.\n+# If HOME_MODE
        is not set, the value of UMASK is used to create the mode.\n+HOME_MODE\t0700\n+\n+#
        Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a
        password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between
        password changes.\n+#\tPASS_MIN_LEN\tMinimum acceptable password length.\n+#\tPASS_WARN_AGE\tNumber
        of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#
        Currently PASS_MIN_LEN is not supported\n+\n+# Currently SU_WHEEL_ONLY is
        not supported\n+\n+# Currently CRACKLIB_DICTPATH is not supported\n+\n+#\n+#
        Min/max values for automatic uid selection in useradd(8)\n+#\n+UID_MIN                  1000\n+UID_MAX
        \                60000\n+# System accounts\n+SYS_UID_MIN               201\n+SYS_UID_MAX
        \              999\n+# Extra per user uids\n+SUB_UID_MIN\t\t   100000\n+SUB_UID_MAX\t\t600100000\n+SUB_UID_COUNT\t\t
        \   65536\n+\n+#\n+# Min/max values for automatic gid selection in groupadd(8)\n+#\n+GID_MIN
        \                 1000\n+GID_MAX                 60000\n+# System accounts\n+SYS_GID_MIN
        \              201\n+SYS_GID_MAX               999\n+# Extra per user group
        ids\n+SUB_GID_MIN\t\t   100000\n+SUB_GID_MAX\t\t600100000\n+SUB_GID_COUNT\t\t
        \   65536\n+\n+#\n+# Max number of login(1) retries if password is bad\n+#\n+#LOGIN_RETRIES\t\t3\n+\n+#\n+#
        Max time in seconds for login(1)\n+#\n+#LOGIN_TIMEOUT\t\t60\n+\n+# Currently
        PASS_CHANGE_TRIES is not supported\n+\n+# Currently PASS_ALWAYS_WARN is not
        supported\n+\n+# Currently PASS_MAX_LEN is not supported\n+\n+# Currently
        CHFN_AUTH is not supported\n+\n+#\n+# Which fields may be changed by regular
        users using chfn(1) - use\n+# any combination of letters \"frwh\" (full name,
        room number, work\n+# phone, home phone).  If not defined, no changes are
        allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+#
        \n+#CHFN_RESTRICT\t\trwh\n+\n+# Currently LOGIN_STRING is not supported\n+\n+#
        Currently MD5_CRYPT_ENAB is not supported\n+\n+#\n+# If set to MD5, MD5-based
        algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based
        algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based
        algorithm will be used for encrypting password\n+# If set to BLOWFISH, BLOWFISH-based
        algorithm will be used for encrypting password\n+# If set to DES, DES-based
        algorithm will be used for encrypting password (default)\n+#\n+ENCRYPT_METHOD
        SHA512\n+\n+#\n+# Only works if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+#
        Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult
        to brute-force the password.\n+# However, more CPU resources will be needed
        to authenticate users if\n+# this value is increased.\n+#\n+# If not specified,
        the libc will choose the default number of rounds (5000).\n+# The values must
        be within the 1000-999999999 range.\n+#\n+#SHA_CRYPT_MAX_ROUNDS 5000\n+\n+#
        Currently SHA_CRYPT_MIN_ROUNDS is not supported\n+\n+# Currently BCRYPT_MIN_ROUNDS
        and BCRYPT_MAX_ROUNDS are not supported\n+\n+# Currently CONSOLE_GROUPS is
        not supported\n+\n+#\n+# Should login be allowed if we can't cd to the home
        directory?\n+# Default is yes.\n+#\n+#DEFAULT_HOME\tyes\n+\n+# Currently ENVIRON_FILE
        is not supported\n+\n+#\n+# If defined, this command is run when removing
        a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the
        user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+#
        Enables userdel(8) to remove user groups if no members exist.\n+#\n+USERGROUPS_ENAB
        yes\n+\n+#\n+# If set to a non-zero number, the shadow utilities will make
        sure that\n+# groups never have more than this number of users on one line.\n+#
        This permits to support split groups (groups split into multiple lines,\n+#
        with the same group ID, to avoid limitation of the line length in the\n+#
        group file).\n+#\n+# 0 is the default value and disables this feature.\n+#\n+#MAX_MEMBERS_PER_GROUP\t0\n+\n+#\n+#
        If useradd(8) should create home directories for users by default (non\n+#
        system users only).\n+# This option is overridden with the -M or -m flags
        on the useradd(8)\n+# command-line.\n+#\n+CREATE_HOME\tyes\n+\n+#\n+# Force
        use shadow, even if shadow passwd & shadow group files are\n+# missing.\n+#\n+#FORCE_SHADOW
        \   yes\n+\n+#\n+# Select the HMAC cryptography algorithm.\n+# Used in pam_timestamp
        module to calculate the keyed-hash message\n+# authentication code.\n+#\n+#
        Note: It is recommended to check hmac(3) to see the possible algorithms\n+#
        that are available in your system.\n+#\n+HMAC_CRYPTO_ALGO SHA512\n"
      :resource_class: file
      :resource_params: '["/etc/login.defs"]'
      :resource_id: "/etc/login.defs"
    - :status: passed
      :code_desc: File /etc/shadow content is expected not to match /^\S+:[^\!\*:]*:[^:]*:(0|\-1):[^:]*:[^:]*:[^:]*:[^:]*:[^:]*\s*$/
      :run_time: 0.000110296
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.1.3_Ensure_password_expiration_warning_days_is_7_or_more
    :title: Ensure password expiration warning days is 7 or more
    :desc: |-
      The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.

      Rationale: Providing an advance warning that a password will be expiring gives users time to think of a secure password. Users caught unaware may choose a simple password or write it down where it may be discovered.
    :descriptions:
    - :label: default
      :data: |-
        The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.

        Rationale: Providing an advance warning that a password will be expiring gives users time to think of a secure password. Users caught unaware may choose a simple password or write it down where it may be discovered.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.1.3_Ensure_password_expiration_warning_days_is_7_or_more\"
      do\n  title \"Ensure password expiration warning days is 7 or more\"\n  desc
      \ \"\n    The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator
      to notify users that their password will expire in a defined number of days.
      It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.\n
      \   \n    Rationale: Providing an advance warning that a password will be expiring
      gives users time to think of a secure password. Users caught unaware may choose
      a simple password or write it down where it may be discovered.\n  \"\n  impact
      1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\") { should
      match(/^\\s*PASS_WARN_AGE\\s+([789]|[1-9][0-9]+)\\s*(\\s+#.*)?$/) }\n  end\n
      \ describe shadow.where { user =~ /.+/ and password =~ /^[^!*]/ and (warn_days.nil?
      or warn_days.to_i < 7) } do\n    its(\"raw_data\") { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3313
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/login.defs content is expected to match /^\s*PASS_WARN_AGE\s+([789]|[1-9][0-9]+)\s*(\s+#.*)?$/
      :run_time: 0.000154786
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/login.defs"]'
      :resource_id: "/etc/login.defs"
    - :status: skipped
      :code_desc: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :run_time: 4.936e-06
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :skip_message: 'Can''t read file: /etc/shadow'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: !ruby/object:FilterTable::ExceptionCatcher {}
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.1.4_Ensure_inactive_password_lock_is_30_days_or_less
    :title: Ensure inactive password lock is 30 days or less
    :desc: |-
      User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 30 days after password expiration be disabled.

      Rationale: Inactive accounts pose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.
    :descriptions:
    - :label: default
      :data: |-
        User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 30 days after password expiration be disabled.

        Rationale: Inactive accounts pose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.1.4_Ensure_inactive_password_lock_is_30_days_or_less\"
      do\n  title \"Ensure inactive password lock is 30 days or less\"\n  desc  \"\n
      \   User accounts that have been inactive for over a given period of time can
      be automatically disabled. It is recommended that accounts that are inactive
      for 30 days after password expiration be disabled.\n    \n    Rationale: Inactive
      accounts pose a threat to system security since the users are not logging in
      to notice failed login attempts or other anomalies.\n  \"\n  impact 1.0\n  describe
      file(\"/etc/default/useradd\") do\n    its(\"content\") { should match(/^\\s*INACTIVE\\s*=\\s*(30|[1-2][0-9]|[1-9])\\s*(\\s+#.*)?$/)
      }\n  end\n  describe shadow.where { user =~ /.+/ and password =~ /^[^!*]/ and
      (inactive_days.nil? or inactive_days.to_i > 30) } do\n    its(\"raw_data\")
      { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3329
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: File /etc/default/useradd content is expected to match /^\s*INACTIVE\s*=\s*(30|[1-2][0-9]|[1-9])\s*(\s+#.*)?$/
      :run_time: 0.070536701
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "# useradd defaults file\nGROUP=100\nHOME=/home\nINACTIVE=-1\nEXPIRE=\nSHELL=/bin/bash\nSKEL=/etc/skel\nCREATE_MAIL_SPOOL=yes\n\n" to match /^\s*INACTIVE\s*=\s*(30|[1-2][0-9]|[1-9])\s*(\s+#.*)?$/
        Diff:
        @@ -1,8 +1,15 @@
        -/^\s*INACTIVE\s*=\s*(30|[1-2][0-9]|[1-9])\s*(\s+#.*)?$/
        +# useradd defaults file
        +GROUP=100
        +HOME=/home
        +INACTIVE=-1
        +EXPIRE=
        +SHELL=/bin/bash
        +SKEL=/etc/skel
        +CREATE_MAIL_SPOOL=yes
      :resource_class: file
      :resource_params: '["/etc/default/useradd"]'
      :resource_id: "/etc/default/useradd"
    - :status: skipped
      :code_desc: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :run_time: 1.0887e-05
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :skip_message: 'Can''t read file: /etc/shadow'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: !ruby/object:FilterTable::ExceptionCatcher {}
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.1.5_Ensure_all_users_last_password_change_date_is_in_the_past
    :title: Ensure all users last password change date is in the past
    :desc: |-
      All users should have a password change date in the past.

      Rationale: If a user's recorded password change date is in the future, then they could bypass any set password expiration.
    :descriptions:
    - :label: default
      :data: |-
        All users should have a password change date in the past.

        Rationale: If a user's recorded password change date is in the future, then they could bypass any set password expiration.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.1.5_Ensure_all_users_last_password_change_date_is_in_the_past\"
      do\n  title \"Ensure all users last password change date is in the past\"\n
      \ desc  \"\n    All users should have a password change date in the past.\n
      \   \n    Rationale: If a user's recorded password change date is in the future,
      then they could bypass any set password expiration.\n  \"\n  impact 1.0\n  today
      = (DateTime.now.to_time.to_i)/86400\n  describe shadow.where { user =~ /.+/
      and password !~ /^!/ and last_change.to_i >= today } do\n    its('entries')
      { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3345
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :run_time: 5.238e-06
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :skip_message: 'Can''t read file: /etc/shadow'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: !ruby/object:FilterTable::ExceptionCatcher {}
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_system_accounts_are_secured
    :title: Ensure system accounts are secured
    :desc: |-
      There are a number of accounts provided with most distributions that are used to manage applications and are not intended to provide an interactive shell. Furthermore, a user may add special accounts that are not intended to provide an interactive shell.

      Rationale: It is important to make sure that accounts that are not being used by regular users are prevented from being used to provide an interactive shell. By default, most distributions set the password field for these accounts to an invalid string, but it is also recommended that the shell field in the password file be set to the nologin shell. This prevents the account from potentially being used to run any commands.
    :descriptions:
    - :label: default
      :data: |-
        There are a number of accounts provided with most distributions that are used to manage applications and are not intended to provide an interactive shell. Furthermore, a user may add special accounts that are not intended to provide an interactive shell.

        Rationale: It is important to make sure that accounts that are not being used by regular users are prevented from being used to provide an interactive shell. By default, most distributions set the password field for these accounts to an invalid string, but it is also recommended that the shell field in the password file be set to the nologin shell. This prevents the account from potentially being used to run any commands.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_system_accounts_are_secured\"
      do\n  title \"Ensure system accounts are secured\"\n  desc  \"\n    There are
      a number of accounts provided with most distributions that are used to manage
      applications and are not intended to provide an interactive shell. Furthermore,
      a user may add special accounts that are not intended to provide an interactive
      shell.\n    \n    Rationale: It is important to make sure that accounts that
      are not being used by regular users are prevented from being used to provide
      an interactive shell. By default, most distributions set the password field
      for these accounts to an invalid string, but it is also recommended that the
      shell field in the password file be set to the nologin shell. This prevents
      the account from potentially being used to run any commands.\n  \"\n  impact
      1.0\n  describe passwd.where { user =~ /^(?!root|sync|shutdown|halt).*$/ } do\n
      \   its(\"entries\") { should_not be_empty }\n  end\n  describe passwd.where
      { user =~ /^(?!root|sync|shutdown|halt).*$/ && uid.to_i < 500 && shell != \"/sbin/nologin\"
      } do\n    its(\"entries\") { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3359
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/passwd with user =~ /^(?!root|sync|shutdown|halt).*$/ entries
        is expected not to be empty"
      :run_time: 0.029889099
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: FilterTable::Table
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: /etc/passwd with user =~ /^(?!root|sync|shutdown|halt).*$/ uid to_i
        < 500 shell != "/sbin/nologin" entries is expected to be empty
      :run_time: 0.010660546
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: FilterTable::Table
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_default_user_shell_timeout_is_900_seconds_or_less
    :title: Ensure default user shell timeout is 900 seconds or less
    :desc: |-
      TMOUT is an environmental setting that determines the timeout of a shell in seconds.

      *  TMOUT= **n** - Sets the shell timeout to **n** seconds.  A setting of TMOUT=0 disables timeout.
      * readonly TMOUT- Sets the TMOUT environmental variable as readonly, preventing unwanted modification during run-time.
      * export TMOUT - exports the TMOUT variable
      **System Wide Shell Configuration Files:**

      * /etc/profile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in the .bash_profile , however this file is used to set an initial PATH or PS1 for all shell users of the system. ** is only executed for interactive **login** shells, or shells executed with the --login parameter. **
      * /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh . It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables.
      * /etc/bashrc - System wide version of .bashrc .  In Fedora derived distributions, /etc/bashrc also invokes /etc/profile.d/*.sh if **non-login** shell, but redirects output to /dev/null if **non-interactive.**** Is only executed for **interactive** shells or if BASH_ENV is set to /etc/bashrc . **

      Rationale: Setting a timeout value reduces the window of opportunity for unauthorized user access to another user's shell session that has been left unattended. It also ends the inactive session and releases the resources associated with that session.
    :descriptions:
    - :label: default
      :data: |-
        TMOUT is an environmental setting that determines the timeout of a shell in seconds.

        *  TMOUT= **n** - Sets the shell timeout to **n** seconds.  A setting of TMOUT=0 disables timeout.
        * readonly TMOUT- Sets the TMOUT environmental variable as readonly, preventing unwanted modification during run-time.
        * export TMOUT - exports the TMOUT variable
        **System Wide Shell Configuration Files:**

        * /etc/profile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in the .bash_profile , however this file is used to set an initial PATH or PS1 for all shell users of the system. ** is only executed for interactive **login** shells, or shells executed with the --login parameter. **
        * /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh . It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables.
        * /etc/bashrc - System wide version of .bashrc .  In Fedora derived distributions, /etc/bashrc also invokes /etc/profile.d/*.sh if **non-login** shell, but redirects output to /dev/null if **non-interactive.**** Is only executed for **interactive** shells or if BASH_ENV is set to /etc/bashrc . **

        Rationale: Setting a timeout value reduces the window of opportunity for unauthorized user access to another user's shell session that has been left unattended. It also ends the inactive session and releases the resources associated with that session.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_default_user_shell_timeout_is_900_seconds_or_less\"
      do\n  title \"Ensure default user shell timeout is 900 seconds or less\"\n  desc
      \ \"\n    TMOUT is an environmental setting that determines the timeout of a
      shell in seconds.\n    \n    *  TMOUT= **n** - Sets the shell timeout to **n**
      seconds.  A setting of TMOUT=0 disables timeout.\n    * readonly TMOUT- Sets
      the TMOUT environmental variable as readonly, preventing unwanted modification
      during run-time.\n    * export TMOUT - exports the TMOUT variable\n    **System
      Wide Shell Configuration Files:**\n    \n    * /etc/profile - used to set system
      wide environmental variables on users shells. The variables are sometimes the
      same ones that are in the .bash_profile , however this file is used to set an
      initial PATH or PS1 for all shell users of the system. ** is only executed for
      interactive **login** shells, or shells executed with the --login parameter.
      **\n    * /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh
      . It is recommended to place your configuration in a shell script within /etc/profile.d
      to set your own system wide environmental variables.\n    * /etc/bashrc - System
      wide version of .bashrc .  In Fedora derived distributions, /etc/bashrc also
      invokes /etc/profile.d/*.sh if **non-login** shell, but redirects output to
      /dev/null if **non-interactive.**** Is only executed for **interactive** shells
      or if BASH_ENV is set to /etc/bashrc . **\n    \n    Rationale: Setting a timeout
      value reduces the window of opportunity for unauthorized user access to another
      user's shell session that has been left unattended. It also ends the inactive
      session and releases the resources associated with that session.\n  \"\n  impact
      1.0\n  files = [\"/etc/bashrc\", \"/etc/profile\"]\n  files += command(\"find
      /etc/profile.d/*.sh -type f\").stdout.split\n  files_with_tmout = []\n  files_with_tmout
      += files\n  describe files_with_tmout.delete_if { |f| command(\"file #{f} |
      cut -d: -f2\").stdout =~ /binary|executable|archive/ || file(f).content !~ /^\\s*([^#]+\\s+)?TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\b/
      } do\n    it { should_not be_empty }\n  end\n  describe command('grep -P \\'^\\s*([^#]+\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\d{3,})\\b\\'
      /etc/profile /etc/profile.d/*.sh /etc/bashrc') do\n    its('stdout') { should
      be_empty }\n  end\n  files_with_tmout_and_readonly = []\n  files_with_tmout_and_readonly
      += files\n  describe files_with_tmout_and_readonly.delete_if { |f| command(\"file
      #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/ || file(f).content
      !~ /^\\s*([^#]+;\\s*)?readonly\\s+TMOUT(\\s+|\\s*;|\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\b/
      } do\n    it { should_not be_empty }\n  end\n  files_with_tmout_and_export =
      []\n  files_with_tmout_and_export += files\n  describe files_with_tmout_and_export.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /^\\s*([^#]+;\\s*)?export\\s+TMOUT(\\s+|\\s*;|\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\b/
      } do\n    it { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 3375
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.003743596
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: 'Command: `grep -P ''^\s*([^#]+\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\d{3,})\b''
        /etc/profile /etc/profile.d/*.sh /etc/bashrc` stdout is expected to be empty'
      :run_time: 0.023796377
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: command
      :resource_params: '["grep -P ''^\\s*([^#]+\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\d{3,})\\b''
        /etc/profile /etc/profile.d/*.sh /etc/bashrc"]'
      :resource_id: 'Command: `grep -P ''^\s*([^#]+\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\d{3,})\b''
        /etc/profile /etc/profile.d/*.sh /etc/bashrc`'
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002558714
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.002316123
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.4_Ensure_default_group_for_the_root_account_is_GID_0
    :title: Ensure default group for the root account is GID 0
    :desc: |-
      The usermod command can be used to specify which group the root account belongs to. This affects permissions of files that are created by the root account.

      Rationale: Using GID 0 for the root account helps prevent root -owned files from accidentally becoming accessible to non-privileged users.
    :descriptions:
    - :label: default
      :data: |-
        The usermod command can be used to specify which group the root account belongs to. This affects permissions of files that are created by the root account.

        Rationale: Using GID 0 for the root account helps prevent root -owned files from accidentally becoming accessible to non-privileged users.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.4_Ensure_default_group_for_the_root_account_is_GID_0\"
      do\n  title \"Ensure default group for the root account is GID 0\"\n  desc  \"\n
      \   The usermod command can be used to specify which group the root account
      belongs to. This affects permissions of files that are created by the root account.\n
      \   \n    Rationale: Using GID 0 for the root account helps prevent root -owned
      files from accidentally becoming accessible to non-privileged users.\n  \"\n
      \ impact 1.0\n  describe passwd.where { user == \"root\" } do\n    its(\"entries\")
      { should_not be_empty }\n  end\n  describe passwd.where { user == \"root\" &&
      gid.to_i == 0 } do\n    its(\"entries\") { should_not be_empty }\n  end\nend\n"
    :source_location:
      :line: 3414
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: /etc/passwd with user == "root" entries is expected not to be empty
      :run_time: 0.002224073
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: FilterTable::Table
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: /etc/passwd with user == "root" gid to_i == 0 entries is expected
        not to be empty
      :run_time: 0.002238221
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: FilterTable::Table
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_default_user_umask_is_027_or_more_restrictive
    :title: Ensure default user umask is 027 or more restrictive
    :desc: |-
      The user file-creation mode mask ( umask ) is use to determine the file permission for newly created directories and files. In Linux, the default permissions for any newly created directory is 0777 ( rwxrwxrwx ), and for any newly created file it is 0666 ( rw-rw-rw- ). The umask modifies the default Linux permissions by restricting (masking) these permissions. The umask is not simply subtracted, but is processed bitwise. Bits set in the umask are cleared in the resulting file mode.

      umask can be set with either octal or Symbolic values:

      * Octal (Numeric) Value - Represented by either three or four digits. ie umask 0027 or umask 027 .  If a four digit umask is used, the first digit is ignored. The remaining three digits effect the resulting permissions for user, group, and world/other respectively.
      * Symbolic Value - Represented by a comma separated list for User u , group g , and world/other o .  The permissions listed are not masked by umask . ie a umask set by umask u=rwx,g=rx,o= is the Symbolic equivalent of the Octalumask 027 .  This umask would set a newly created directory with file mode drwxr-x--- and a newly created file with file mode rw-r----- .
      The default umask can be set to use the pam_umask module or in a System Wide Shell Configuration File .  The user creating the directories or files has the discretion of changing the permissions via the chmod command, or choosing a different default umask by adding the umask command into a User Shell Configuration File , ( .bash_profile or .bashrc ), in their home directory.

      Setting the default umask:

      *  pam_umask module: *  will set the umask according to the system default in /etc/login.defs and user settings, solving the problem of different umask settings with different shells, display managers, remote sessions etc.
      * umask=
      <mask> value in the /etc/login.defs file is interpreted as Octal
      *  Setting USERGROUPS_ENAB to yes in /etc/login.defs (default): *  will enable setting of the umask group bits to be the same as owner bits. (examples: 022 -&gt; 002, 077 -&gt; 007) for non-root users, if the uid is the same as gid , and username is the same as the <primary/>name&gt;
      * userdel will remove the user's group if it contains no more members, and useradd will create by default a group with the name of the user
      * System Wide Shell Configuration File : * /etc/profile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in the .bash_profile , however this file is used to set an initial PATH or PS1 for all shell users of the system. ** is only executed for interactive **login** shells, or shells executed with the --login parameter. **
      * /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh . It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables.
      * /etc/bashrc - System wide version of .bashrc .  In Fedora derived distributions, etc/bashrc also invokes /etc/profile.d/*.sh if **non-login** shell, but redirects output to /dev/null if **non-interactive.**** Is only executed for **interactive** shells or if BASH_ENV is set to /etc/bashrc . **
      User Shell Configuration Files:

      * ~/.bash_profile - Is executed to configure your shell before the initial command prompt. **Is only read by login shells.**
      * ~/.bashrc - Is executed for interactive shells. **only read by a shell that's both interactive and non-login**</mask>

      Rationale: Setting a secure default value for umask ensures that users make a conscious choice about their file permissions. A permissive umask value could result in directories or files with excessive permissions that can be read and/or written to by unauthorized users.
    :descriptions:
    - :label: default
      :data: |-
        The user file-creation mode mask ( umask ) is use to determine the file permission for newly created directories and files. In Linux, the default permissions for any newly created directory is 0777 ( rwxrwxrwx ), and for any newly created file it is 0666 ( rw-rw-rw- ). The umask modifies the default Linux permissions by restricting (masking) these permissions. The umask is not simply subtracted, but is processed bitwise. Bits set in the umask are cleared in the resulting file mode.

        umask can be set with either octal or Symbolic values:

        * Octal (Numeric) Value - Represented by either three or four digits. ie umask 0027 or umask 027 .  If a four digit umask is used, the first digit is ignored. The remaining three digits effect the resulting permissions for user, group, and world/other respectively.
        * Symbolic Value - Represented by a comma separated list for User u , group g , and world/other o .  The permissions listed are not masked by umask . ie a umask set by umask u=rwx,g=rx,o= is the Symbolic equivalent of the Octalumask 027 .  This umask would set a newly created directory with file mode drwxr-x--- and a newly created file with file mode rw-r----- .
        The default umask can be set to use the pam_umask module or in a System Wide Shell Configuration File .  The user creating the directories or files has the discretion of changing the permissions via the chmod command, or choosing a different default umask by adding the umask command into a User Shell Configuration File , ( .bash_profile or .bashrc ), in their home directory.

        Setting the default umask:

        *  pam_umask module: *  will set the umask according to the system default in /etc/login.defs and user settings, solving the problem of different umask settings with different shells, display managers, remote sessions etc.
        * umask=
        <mask> value in the /etc/login.defs file is interpreted as Octal
        *  Setting USERGROUPS_ENAB to yes in /etc/login.defs (default): *  will enable setting of the umask group bits to be the same as owner bits. (examples: 022 -&gt; 002, 077 -&gt; 007) for non-root users, if the uid is the same as gid , and username is the same as the <primary/>name&gt;
        * userdel will remove the user's group if it contains no more members, and useradd will create by default a group with the name of the user
        * System Wide Shell Configuration File : * /etc/profile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in the .bash_profile , however this file is used to set an initial PATH or PS1 for all shell users of the system. ** is only executed for interactive **login** shells, or shells executed with the --login parameter. **
        * /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh . It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables.
        * /etc/bashrc - System wide version of .bashrc .  In Fedora derived distributions, etc/bashrc also invokes /etc/profile.d/*.sh if **non-login** shell, but redirects output to /dev/null if **non-interactive.**** Is only executed for **interactive** shells or if BASH_ENV is set to /etc/bashrc . **
        User Shell Configuration Files:

        * ~/.bash_profile - Is executed to configure your shell before the initial command prompt. **Is only read by login shells.**
        * ~/.bashrc - Is executed for interactive shells. **only read by a shell that's both interactive and non-login**</mask>

        Rationale: Setting a secure default value for umask ensures that users make a conscious choice about their file permissions. A permissive umask value could result in directories or files with excessive permissions that can be read and/or written to by unauthorized users.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_default_user_umask_is_027_or_more_restrictive\"
      do\n  title \"Ensure default user umask is 027 or more restrictive\"\n  desc
      \ \"\n    The user file-creation mode mask ( umask ) is use to determine the
      file permission for newly created directories and files. In Linux, the default
      permissions for any newly created directory is 0777 ( rwxrwxrwx ), and for any
      newly created file it is 0666 ( rw-rw-rw- ). The umask modifies the default
      Linux permissions by restricting (masking) these permissions. The umask is not
      simply subtracted, but is processed bitwise. Bits set in the umask are cleared
      in the resulting file mode.\n    \n    umask can be set with either octal or
      Symbolic values:\n    \n    * Octal (Numeric) Value - Represented by either
      three or four digits. ie umask 0027 or umask 027 .  If a four digit umask is
      used, the first digit is ignored. The remaining three digits effect the resulting
      permissions for user, group, and world/other respectively.\n    * Symbolic Value
      - Represented by a comma separated list for User u , group g , and world/other
      o .  The permissions listed are not masked by umask . ie a umask set by umask
      u=rwx,g=rx,o= is the Symbolic equivalent of the Octalumask 027 .  This umask
      would set a newly created directory with file mode drwxr-x--- and a newly created
      file with file mode rw-r----- .\n    The default umask can be set to use the
      pam_umask module or in a System Wide Shell Configuration File .  The user creating
      the directories or files has the discretion of changing the permissions via
      the chmod command, or choosing a different default umask by adding the umask
      command into a User Shell Configuration File , ( .bash_profile or .bashrc ),
      in their home directory.\n    \n    Setting the default umask:\n    \n    *
      \ pam_umask module: *  will set the umask according to the system default in
      /etc/login.defs and user settings, solving the problem of different umask settings
      with different shells, display managers, remote sessions etc.\n    * umask=\n
      \   <mask> value in the /etc/login.defs file is interpreted as Octal\n    *
      \ Setting USERGROUPS_ENAB to yes in /etc/login.defs (default): *  will enable
      setting of the umask group bits to be the same as owner bits. (examples: 022
      -&gt; 002, 077 -&gt; 007) for non-root users, if the uid is the same as gid
      , and username is the same as the <primary/>name&gt;\n    * userdel will remove
      the user's group if it contains no more members, and useradd will create by
      default a group with the name of the user\n    * System Wide Shell Configuration
      File : * /etc/profile - used to set system wide environmental variables on users
      shells. The variables are sometimes the same ones that are in the .bash_profile
      , however this file is used to set an initial PATH or PS1 for all shell users
      of the system. ** is only executed for interactive **login** shells, or shells
      executed with the --login parameter. **\n    * /etc/profile.d - /etc/profile
      will execute the scripts within /etc/profile.d/*.sh . It is recommended to place
      your configuration in a shell script within /etc/profile.d to set your own system
      wide environmental variables.\n    * /etc/bashrc - System wide version of .bashrc
      .  In Fedora derived distributions, etc/bashrc also invokes /etc/profile.d/*.sh
      if **non-login** shell, but redirects output to /dev/null if **non-interactive.****
      Is only executed for **interactive** shells or if BASH_ENV is set to /etc/bashrc
      . **\n    User Shell Configuration Files:\n    \n    * ~/.bash_profile - Is
      executed to configure your shell before the initial command prompt. **Is only
      read by login shells.**\n    * ~/.bashrc - Is executed for interactive shells.
      **only read by a shell that's both interactive and non-login**</mask>\n    \n
      \   Rationale: Setting a secure default value for umask ensures that users make
      a conscious choice about their file permissions. A permissive umask value could
      result in directories or files with excessive permissions that can be read and/or
      written to by unauthorized users.\n  \"\n  impact 1.0\n  umask_and_session_check
      = [\"/etc/login.defs\",\"/etc/pam.d/system-auth\",\"/etc/pam.d/password-auth\"]\n
      \ umask_value_check = [\"/etc/bashrc\",\"/etc/profile\"]\n  umask_value_check
      += command(\"find /etc/profile.d/*.sh -type f\").stdout.split\n  describe.one
      do\n    describe umask_and_session_check.delete_if { |f| command(\"file #{f}
      | cut -d: -f2\").stdout =~ /binary|executable|archive/ || ( file(f).content
      !~ /(?i)^\\s*UMASK\\s+(0[0-7][2-7]7|[0-7][2-7]7)\\b/ && file(f).content !~ /(?i)^\\s*USERGROUPS_ENAB\\s*\"?no\"?\\b/
      && file(f).content !~ /^\\s*session\\s+(optional|requisite|required)\\s+pam_umask\\.so\\b/
      ) } do\n      it { should_not be_empty }\n      it { should include \"/etc/login.defs\"}\n
      \     it { should include \"/etc/pam.d/system-auth\" }\n      it { should include
      \"/etc/pam.d/password-auth\" }\n    end\n    describe umask_value_check.delete_if
      { |f| command(\"file #{f} | cut -d: -f2\").stdout =~ /binary|executable|archive/
      || file(f).content !~ /(?i)^\\s*UMASK\\s+\\s*(0[0-7][2-7]7|[0-7][2-7]7|u=(r?|w?|x?)(r?|w?|x?)(r?|w?|x?),g=(r?x?|x?r?),o=)\\b/
      } do\n      it { should_not be_empty }\n    end\n  end\n  describe command(\"grep
      -RPi '(^|^[^#]*)\\s*umask\\s+([0-7][0-7][01][0-7]\\b|[0-7][0-7][0-7][0-6]\\b|[0-7][01][0-7]\\b|[0-7][0-7][0-6]\\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\\b)'
      /etc/login.defs /etc/profile* /etc/bashrc*\") do\n    its(\"stdout\") {should
      be_empty}\n  end\nend\n"
    :source_location:
      :line: 3430
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000163187
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: '[] is expected to include "/etc/login.defs"'
      :run_time: 0.000159767
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected [] to include "/etc/login.defs"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: '[] is expected to include "/etc/pam.d/system-auth"'
      :run_time: 0.000150625
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected [] to include "/etc/pam.d/system-auth"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: '[] is expected to include "/etc/pam.d/password-auth"'
      :run_time: 0.000106218
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected [] to include "/etc/pam.d/password-auth"
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: failed
      :code_desc: "[] is expected not to be empty"
      :run_time: 0.000132859
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: expected `[].empty?` to be falsey, got true
      :exception: RSpec::Core::MultipleExceptionError
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: "Command: `grep -RPi '(^|^[^#]*) *umask +([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b|[0-7][01][0-7]\b|[0-7][0-7][0-6]\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\b)'
        /etc/login.defs /etc/profile* /etc/bashrc*` stdout is expected to be empty"
      :run_time: 0.048166209
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: command
      :resource_params: '["grep -RPi ''(^|^[^#]*) *umask +([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b|[0-7][01][0-7]\b|[0-7][0-7][0-6]\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\b)''
        /etc/login.defs /etc/profile* /etc/bashrc*"]'
      :resource_id: "Command: `grep -RPi '(^|^[^#]*) *umask +([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b|[0-7][01][0-7]\b|[0-7][0-7][0-6]\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\b)'
        /etc/login.defs /etc/profile* /etc/bashrc*`"
  - :id: xccdf_org.cisecurity.benchmarks_rule_5.6.6_Ensure_root_password_is_set
    :title: Ensure root password is set
    :desc: |-
      There are a number of methods to access the root account directly. Without a password set any user would be able to gain access and thus control over the entire system.

      Rationale: Access to root should be secured at all times.
    :descriptions:
    - :label: default
      :data: |-
        There are a number of methods to access the root account directly. Without a password set any user would be able to gain access and thus control over the entire system.

        Rationale: Access to root should be secured at all times.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_5.6.6_Ensure_root_password_is_set\"
      do\n  title \"Ensure root password is set\"\n  desc  \"\n    There are a number
      of methods to access the root account directly. Without a password set any user
      would be able to gain access and thus control over the entire system.\n    \n
      \   Rationale: Access to root should be secured at all times.\n  \"\n  impact
      1.0\n  describe command(\"passwd -S root\") do\n    its(:stdout) { should match
      /Password set/ }\n  end\nend\n"
    :source_location:
      :line: 3478
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: 'Command: `passwd -S root` stdout is expected to match /Password
        set/'
      :run_time: 0.060540353
      :start_time: '2024-04-04T14:52:39+00:00'
      :message: |
        expected "" to match /Password set/
        Diff:
        @@ -1 +1 @@
        -/Password set/
        +""
      :resource_class: command
      :resource_params: '["passwd -S root"]'
      :resource_id: 'Command: `passwd -S root`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_permissions_on_etcpasswd_are_configured
    :title: Ensure permissions on /etc/passwd are configured
    :desc: |-
      The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.

      Rationale: It is critical to ensure that the /etc/passwd file is protected from unauthorized write access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.

        Rationale: It is critical to ensure that the /etc/passwd file is protected from unauthorized write access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_permissions_on_etcpasswd_are_configured\"
      do\n  title \"Ensure permissions on /etc/passwd are configured\"\n  desc  \"\n
      \   The /etc/passwd file contains user account information that is used by many
      system utilities and therefore must be readable for these utilities to operate.\n
      \   \n    Rationale: It is critical to ensure that the /etc/passwd file is protected
      from unauthorized write access. Although it is protected by default, the file
      permissions could be changed either inadvertently or through malicious actions.\n
      \ \"\n  impact 1.0\n  describe file(\"/etc/passwd\") do\n    it { should exist
      }\n  end\n  describe file(\"/etc/passwd\") do\n    it { should_not be_executable.by
      \"group\" }\n  end\n  describe file(\"/etc/passwd\") do\n    its(\"gid\") {
      should cmp 0 }\n  end\n  describe file(\"/etc/passwd\") do\n    it { should_not
      be_writable.by \"group\" }\n  end\n  describe file(\"/etc/passwd\") do\n    it
      { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/passwd\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/passwd\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/passwd\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\nend\n"
    :source_location:
      :line: 3491
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/passwd is expected to exist
      :run_time: 0.058290112
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd is expected not to be executable by group
      :run_time: 0.000232521
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd gid is expected to cmp == 0
      :run_time: 0.000165112
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd is expected not to be writable by group
      :run_time: 0.000114568
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd is expected not to be executable by other
      :run_time: 0.000100845
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd is expected not to be writable by other
      :run_time: 0.000265401
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd is expected not to be executable by owner
      :run_time: 0.000162665
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
    - :status: passed
      :code_desc: File /etc/passwd uid is expected to cmp == 0
      :run_time: 0.000144054
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_permissions_on_etcpasswd-_are_configured
    :title: Ensure permissions on /etc/passwd- are configured
    :desc: |-
      The /etc/passwd- file contains backup user account information.

      Rationale: It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/passwd- file contains backup user account information.

        Rationale: It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_permissions_on_etcpasswd-_are_configured\"
      do\n  title \"Ensure permissions on /etc/passwd- are configured\"\n  desc  \"\n
      \   The /etc/passwd- file contains backup user account information.\n    \n
      \   Rationale: It is critical to ensure that the /etc/passwd- file is protected
      from unauthorized access. Although it is protected by default, the file permissions
      could be changed either inadvertently or through malicious actions.\n  \"\n
      \ impact 1.0\n  describe file(\"/etc/passwd-\") do\n    it { should exist }\n
      \ end\n  describe file(\"/etc/passwd-\") do\n    it { should_not be_executable.by
      \"group\" }\n  end\n  describe file(\"/etc/passwd-\") do\n    its(\"gid\") {
      should cmp 0 }\n  end\n  describe file(\"/etc/passwd-\") do\n    it { should_not
      be_writable.by \"group\" }\n  end\n  describe file(\"/etc/passwd-\") do\n    it
      { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/passwd-\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/passwd-\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/passwd-\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\nend\n"
    :source_location:
      :line: 3525
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/passwd- is expected to exist
      :run_time: 0.056170128
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- is expected not to be executable by group
      :run_time: 0.059458334
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- gid is expected to cmp == 0
      :run_time: 0.000404924
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- is expected not to be writable by group
      :run_time: 0.000268774
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- is expected not to be executable by other
      :run_time: 0.000149307
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- is expected not to be writable by other
      :run_time: 0.000199284
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- is expected not to be executable by owner
      :run_time: 0.000170347
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
    - :status: passed
      :code_desc: File /etc/passwd- uid is expected to cmp == 0
      :run_time: 0.000171431
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd-"]'
      :resource_id: "/etc/passwd-"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_permissions_on_etcgroup_are_configured
    :title: Ensure permissions on /etc/group are configured
    :desc: |-
      The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.

      Rationale: The /etc/group file needs to be protected from unauthorized changes by non-privileged users, but needs to be readable as this information is used with many non-privileged programs.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.

        Rationale: The /etc/group file needs to be protected from unauthorized changes by non-privileged users, but needs to be readable as this information is used with many non-privileged programs.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_permissions_on_etcgroup_are_configured\"
      do\n  title \"Ensure permissions on /etc/group are configured\"\n  desc  \"\n
      \   The /etc/group file contains a list of all the valid groups defined in the
      system. The command below allows read/write access for root and read access
      for everyone else.\n    \n    Rationale: The /etc/group file needs to be protected
      from unauthorized changes by non-privileged users, but needs to be readable
      as this information is used with many non-privileged programs.\n  \"\n  impact
      1.0\n  describe file(\"/etc/group\") do\n    it { should exist }\n  end\n  describe
      file(\"/etc/group\") do\n    it { should_not be_executable.by \"group\" }\n
      \ end\n  describe file(\"/etc/group\") do\n    its(\"gid\") { should cmp 0 }\n
      \ end\n  describe file(\"/etc/group\") do\n    it { should_not be_writable.by
      \"group\" }\n  end\n  describe file(\"/etc/group\") do\n    it { should_not
      be_executable.by \"other\" }\n  end\n  describe file(\"/etc/group\") do\n    it
      { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/group\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/group\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\nend\n"
    :source_location:
      :line: 3559
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/group is expected to exist
      :run_time: 0.056119848
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group is expected not to be executable by group
      :run_time: 0.000330638
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group gid is expected to cmp == 0
      :run_time: 0.000339533
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group is expected not to be writable by group
      :run_time: 0.000251415
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group is expected not to be executable by other
      :run_time: 0.000243964
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group is expected not to be writable by other
      :run_time: 0.000194881
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group is expected not to be executable by owner
      :run_time: 0.0001885
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: File /etc/group uid is expected to cmp == 0
      :run_time: 0.000481015
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group"]'
      :resource_id: "/etc/group"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_permissions_on_etcgroup-_are_configured
    :title: Ensure permissions on /etc/group- are configured
    :desc: |-
      The /etc/group- file contains a backup list of all the valid groups defined in the system.

      Rationale: It is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/group- file contains a backup list of all the valid groups defined in the system.

        Rationale: It is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_permissions_on_etcgroup-_are_configured\"
      do\n  title \"Ensure permissions on /etc/group- are configured\"\n  desc  \"\n
      \   The /etc/group- file contains a backup list of all the valid groups defined
      in the system.\n    \n    Rationale: It is critical to ensure that the /etc/group-
      file is protected from unauthorized access. Although it is protected by default,
      the file permissions could be changed either inadvertently or through malicious
      actions.\n  \"\n  impact 1.0\n  describe file(\"/etc/group-\") do\n    it {
      should exist }\n  end\n  describe file(\"/etc/group-\") do\n    it { should_not
      be_executable.by \"group\" }\n  end\n  describe file(\"/etc/group-\") do\n    its(\"gid\")
      { should cmp 0 }\n  end\n  describe file(\"/etc/group-\") do\n    it { should_not
      be_writable.by \"group\" }\n  end\n  describe file(\"/etc/group-\") do\n    it
      { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/group-\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/group-\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/group-\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\nend\n"
    :source_location:
      :line: 3593
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/group- is expected to exist
      :run_time: 0.055158654
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- is expected not to be executable by group
      :run_time: 0.061851217
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- gid is expected to cmp == 0
      :run_time: 0.00041686
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- is expected not to be writable by group
      :run_time: 0.000254611
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- is expected not to be executable by other
      :run_time: 0.000336693
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- is expected not to be writable by other
      :run_time: 0.000399857
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- is expected not to be executable by owner
      :run_time: 0.00017415
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
    - :status: passed
      :code_desc: File /etc/group- uid is expected to cmp == 0
      :run_time: 0.000266887
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/group-"]'
      :resource_id: "/etc/group-"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_permissions_on_etcshadow_are_configured
    :title: Ensure permissions on /etc/shadow are configured
    :desc: |-
      The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.

      Rationale: If attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/shadow file (such as expiration) could also be useful to subvert the user accounts.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.

        Rationale: If attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/shadow file (such as expiration) could also be useful to subvert the user accounts.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_permissions_on_etcshadow_are_configured\"
      do\n  title \"Ensure permissions on /etc/shadow are configured\"\n  desc  \"\n
      \   The /etc/shadow file is used to store the information about user accounts
      that is critical to the security of those accounts, such as the hashed password
      and other security information.\n    \n    Rationale: If attackers can gain
      read access to the /etc/shadow file, they can easily run a password cracking
      program against the hashed password to break it. Other security information
      that is stored in the /etc/shadow file (such as expiration) could also be useful
      to subvert the user accounts.\n  \"\n  impact 1.0\n  describe file(\"/etc/shadow\")
      do\n    it { should exist }\n  end\n  describe file(\"/etc/shadow\") do\n    it
      { should_not be_executable.by \"group\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_readable.by \"group\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    its(\"gid\") { should cmp 0 }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_writable.by \"group\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_readable.by \"other\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_readable.by \"owner\" }\n  end\n  describe file(\"/etc/shadow\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\n  describe file(\"/etc/shadow\")
      do\n    it { should_not be_writable.by \"owner\" }\n  end\nend\n"
    :source_location:
      :line: 3627
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/shadow is expected to exist
      :run_time: 0.055835501
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be executable by group
      :run_time: 0.000306658
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be readable by group
      :run_time: 0.000194636
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow gid is expected to cmp == 0
      :run_time: 0.000235829
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be writable by group
      :run_time: 0.000166295
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be executable by other
      :run_time: 0.000155827
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be readable by other
      :run_time: 0.000157801
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be writable by other
      :run_time: 0.000517542
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be executable by owner
      :run_time: 0.000207434
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be readable by owner
      :run_time: 0.000204338
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow uid is expected to cmp == 0
      :run_time: 0.000233023
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
    - :status: passed
      :code_desc: File /etc/shadow is expected not to be writable by owner
      :run_time: 0.000164406
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow"]'
      :resource_id: "/etc/shadow"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.6_Ensure_permissions_on_etcshadow-_are_configured
    :title: Ensure permissions on /etc/shadow- are configured
    :desc: |-
      The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.

      Rationale: It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.

        Rationale: It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.6_Ensure_permissions_on_etcshadow-_are_configured\"
      do\n  title \"Ensure permissions on /etc/shadow- are configured\"\n  desc  \"\n
      \   The /etc/shadow- file is used to store backup information about user accounts
      that is critical to the security of those accounts, such as the hashed password
      and other security information.\n    \n    Rationale: It is critical to ensure
      that the /etc/shadow- file is protected from unauthorized access. Although it
      is protected by default, the file permissions could be changed either inadvertently
      or through malicious actions.\n  \"\n  impact 1.0\n  describe file(\"/etc/shadow-\")
      do\n    it { should exist }\n  end\n  describe file(\"/etc/shadow-\") do\n    it
      { should_not be_executable.by \"group\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_readable.by \"group\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    its(\"gid\") { should cmp 0 }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_writable.by \"group\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_readable.by \"other\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_readable.by \"owner\" }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\n  describe file(\"/etc/shadow-\")
      do\n    it { should_not be_writable.by \"owner\" }\n  end\nend\n"
    :source_location:
      :line: 3673
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/shadow- is expected to exist
      :run_time: 0.057684755
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be executable by group
      :run_time: 0.059822655
      :start_time: '2024-04-04T14:52:39+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be readable by group
      :run_time: 0.000290694
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- gid is expected to cmp == 0
      :run_time: 0.000466914
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be writable by group
      :run_time: 0.000190577
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be executable by other
      :run_time: 0.000160877
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be readable by other
      :run_time: 0.000151109
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be writable by other
      :run_time: 0.000160337
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be executable by owner
      :run_time: 0.000154804
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be readable by owner
      :run_time: 0.000147059
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- uid is expected to cmp == 0
      :run_time: 0.000426146
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
    - :status: passed
      :code_desc: File /etc/shadow- is expected not to be writable by owner
      :run_time: 0.00016702
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/shadow-"]'
      :resource_id: "/etc/shadow-"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.7_Ensure_permissions_on_etcgshadow_are_configured
    :title: Ensure permissions on /etc/gshadow are configured
    :desc: |-
      The /etc/gshadow file is used to store the information about groups that is critical to the security of those accounts, such as the hashed password and other security information.

      Rationale: If attackers can gain read access to the /etc/gshadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/gshadow file (such as group administrators) could also be useful to subvert the group.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/gshadow file is used to store the information about groups that is critical to the security of those accounts, such as the hashed password and other security information.

        Rationale: If attackers can gain read access to the /etc/gshadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/gshadow file (such as group administrators) could also be useful to subvert the group.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.7_Ensure_permissions_on_etcgshadow_are_configured\"
      do\n  title \"Ensure permissions on /etc/gshadow are configured\"\n  desc  \"\n
      \   The /etc/gshadow file is used to store the information about groups that
      is critical to the security of those accounts, such as the hashed password and
      other security information.\n    \n    Rationale: If attackers can gain read
      access to the /etc/gshadow file, they can easily run a password cracking program
      against the hashed password to break it. Other security information that is
      stored in the /etc/gshadow file (such as group administrators) could also be
      useful to subvert the group.\n  \"\n  impact 1.0\n  describe file(\"/etc/gshadow\")
      do\n    it { should exist }\n  end\n  describe file(\"/etc/gshadow\") do\n    it
      { should_not be_executable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_readable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    its(\"gid\") { should cmp 0 }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_writable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_readable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_readable.by \"owner\" }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\n  describe file(\"/etc/gshadow\")
      do\n    it { should_not be_writable.by \"owner\" }\n  end\nend\n"
    :source_location:
      :line: 3719
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/gshadow is expected to exist
      :run_time: 0.054906791
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be executable by group
      :run_time: 0.059917403
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be readable by group
      :run_time: 0.000311486
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow gid is expected to cmp == 0
      :run_time: 0.00027644
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be writable by group
      :run_time: 0.000196976
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be executable by other
      :run_time: 0.000418546
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be readable by other
      :run_time: 0.000207347
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be writable by other
      :run_time: 0.000178425
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be executable by owner
      :run_time: 0.000153225
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be readable by owner
      :run_time: 0.000146779
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow uid is expected to cmp == 0
      :run_time: 0.000217556
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
    - :status: passed
      :code_desc: File /etc/gshadow is expected not to be writable by owner
      :run_time: 0.000160211
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow"]'
      :resource_id: "/etc/gshadow"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.8_Ensure_permissions_on_etcgshadow-_are_configured
    :title: Ensure permissions on /etc/gshadow- are configured
    :desc: |-
      The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.

      Rationale: It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :descriptions:
    - :label: default
      :data: |-
        The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.

        Rationale: It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.8_Ensure_permissions_on_etcgshadow-_are_configured\"
      do\n  title \"Ensure permissions on /etc/gshadow- are configured\"\n  desc  \"\n
      \   The /etc/gshadow- file is used to store backup information about groups
      that is critical to the security of those accounts, such as the hashed password
      and other security information.\n    \n    Rationale: It is critical to ensure
      that the /etc/gshadow- file is protected from unauthorized access. Although
      it is protected by default, the file permissions could be changed either inadvertently
      or through malicious actions.\n  \"\n  impact 1.0\n  describe file(\"/etc/gshadow-\")
      do\n    it { should exist }\n  end\n  describe file(\"/etc/gshadow-\") do\n
      \   it { should_not be_executable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_readable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    its(\"gid\") { should cmp 0 }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_writable.by \"group\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_executable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_readable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_writable.by \"other\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_executable.by \"owner\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_readable.by \"owner\" }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    its(\"uid\") { should cmp 0 }\n  end\n  describe file(\"/etc/gshadow-\")
      do\n    it { should_not be_writable.by \"owner\" }\n  end\nend\n"
    :source_location:
      :line: 3765
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/gshadow- is expected to exist
      :run_time: 0.055176007
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be executable by group
      :run_time: 0.059670132
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be readable by group
      :run_time: 0.000303378
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- gid is expected to cmp == 0
      :run_time: 0.000270381
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be writable by group
      :run_time: 0.000192227
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be executable by other
      :run_time: 0.000168878
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be readable by other
      :run_time: 0.000153884
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be writable by other
      :run_time: 0.000164682
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be executable by owner
      :run_time: 0.000175778
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be readable by owner
      :run_time: 0.000153944
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- uid is expected to cmp == 0
      :run_time: 0.00024413
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
    - :status: passed
      :code_desc: File /etc/gshadow- is expected not to be writable by owner
      :run_time: 0.000169116
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: file
      :resource_params: '["/etc/gshadow-"]'
      :resource_id: "/etc/gshadow-"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.9_Ensure_no_world_writable_files_exist
    :title: Ensure no world writable files exist
    :desc: |-
      Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.

      Rationale: Data in world-writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity.
    :descriptions:
    - :label: default
      :data: |-
        Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.

        Rationale: Data in world-writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.9_Ensure_no_world_writable_files_exist\"
      do\n  title \"Ensure no world writable files exist\"\n  desc  \"\n    Unix-based
      systems support variable settings to control access to files. World writable
      files are the least secure. See the chmod(2) man page for more information.\n
      \   \n    Rationale: Data in world-writable files can be modified and compromised
      by any user on the system. World writable files may also indicate an incorrectly
      written script or program that could potentially be the cause of a larger compromise
      to the system's integrity.\n  \"\n  impact 1.0\n  describe command(' df --local
      -P | awk \\'{if (NR!=1) print $6}\\' | xargs -I \\'{}\\' find \\'{}\\' -xdev
      -type f -perm -0002') do\n    its(\"stdout\") { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3811
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: 'Command: ` df --local -P | awk ''{if (NR!=1) print $6}'' | xargs
        -I ''{}'' find ''{}'' -xdev -type f -perm -0002` stdout is expected to be
        empty'
      :run_time: 0.292274839
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: command
      :resource_params: '[" df --local -P | awk ''{if (NR!=1) print $6}'' | xargs
        -I ''{}'' find ''{}'' -xdev -type f -perm -0002"]'
      :resource_id: 'Command: ` df --local -P | awk ''{if (NR!=1) print $6}'' | xargs
        -I ''{}'' find ''{}'' -xdev -type f -perm -0002`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.10_Ensure_no_unowned_files_or_directories_exist
    :title: Ensure no unowned files or directories exist
    :desc: |-
      Sometimes when administrators delete users from the password file, they neglect to remove all files owned by those users from the system.

      Rationale: A new user who is assigned the deleted user's user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended.
    :descriptions:
    - :label: default
      :data: |-
        Sometimes when administrators delete users from the password file, they neglect to remove all files owned by those users from the system.

        Rationale: A new user who is assigned the deleted user's user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.10_Ensure_no_unowned_files_or_directories_exist\"
      do\n  title \"Ensure no unowned files or directories exist\"\n  desc  \"\n    Sometimes
      when administrators delete users from the password file, they neglect to remove
      all files owned by those users from the system.\n    \n    Rationale: A new
      user who is assigned the deleted user's user ID or group ID may then end up
      \\\"owning\\\" these files, and thus have more access on the system than was
      intended.\n  \"\n  impact 1.0\n  describe command('df --local -P | awk {\\'if
      (NR!=1) print $6\\'} | xargs -I \\'{}\\' find \\'{}\\' -xdev -nouser') do\n
      \   its(\"stdout\") { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3824
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: 'Command: `df --local -P | awk {''if (NR!=1) print $6''} | xargs
        -I ''{}'' find ''{}'' -xdev -nouser` stdout is expected to be empty'
      :run_time: 0.849077655
      :start_time: '2024-04-04T14:52:40+00:00'
      :resource_class: command
      :resource_params: '["df --local -P | awk {''if (NR!=1) print $6''} | xargs -I
        ''{}'' find ''{}'' -xdev -nouser"]'
      :resource_id: 'Command: `df --local -P | awk {''if (NR!=1) print $6''} | xargs
        -I ''{}'' find ''{}'' -xdev -nouser`'
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.11_Ensure_no_ungrouped_files_or_directories_exist
    :title: Ensure no ungrouped files or directories exist
    :desc: |-
      Sometimes when administrators delete users or groups from the system, they neglect to remove all files owned by those users or groups.

      Rationale: A new user who is assigned the deleted user's user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended.
    :descriptions:
    - :label: default
      :data: |-
        Sometimes when administrators delete users or groups from the system, they neglect to remove all files owned by those users or groups.

        Rationale: A new user who is assigned the deleted user's user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.11_Ensure_no_ungrouped_files_or_directories_exist\"
      do\n  title \"Ensure no ungrouped files or directories exist\"\n  desc  \"\n
      \   Sometimes when administrators delete users or groups from the system, they
      neglect to remove all files owned by those users or groups.\n    \n    Rationale:
      A new user who is assigned the deleted user's user ID or group ID may then end
      up \\\"owning\\\" these files, and thus have more access on the system than
      was intended.\n  \"\n  impact 1.0\n  output = bash(\" df -P | awk {'if (NR!=1)
      print $6'} | xargs -I '{}' find '{}' -xdev -nogroup \").stdout\n  describe output
      do\n    it { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3837
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: is expected to be empty
      :run_time: 0.002662321
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.12_Ensure_sticky_bit_is_set_on_all_world-writable_directories
    :title: Ensure sticky bit is set on all world-writable directories
    :desc: |-
      Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.

      Rationale: This feature prevents the ability to delete or rename files in world writable directories (such as /tmp ) that are owned by another user.
    :descriptions:
    - :label: default
      :data: |-
        Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.

        Rationale: This feature prevents the ability to delete or rename files in world writable directories (such as /tmp ) that are owned by another user.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.12_Ensure_sticky_bit_is_set_on_all_world-writable_directories\"
      do\n  title \"Ensure sticky bit is set on all world-writable directories\"\n
      \ desc  \"\n    Setting the sticky bit on world writable directories prevents
      users from deleting or renaming files in that directory that are not owned by
      them.\n    \n    Rationale: This feature prevents the ability to delete or rename
      files in world writable directories (such as /tmp ) that are owned by another
      user.\n  \"\n  impact 1.0\n  output = bash(\"df --local -P | awk {'if (NR!=1)
      print $6'} | xargs -I '{}' find '{}' -xdev -type d \\\\( -perm -0002 -a ! -perm
      -1000 \\\\)\").stdout\n  describe output do\n    it { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3851
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: is expected to be empty
      :run_time: 0.002208297
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.13_Audit_SUID_executables
    :title: Audit SUID executables
    :desc: |-
      The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to perform functions (such as changing their password) that require root privileges.

      Rationale: There are valid reasons for SUID programs, but it is important to identify and review such programs to ensure they are legitimate.
    :descriptions:
    - :label: default
      :data: |-
        The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to perform functions (such as changing their password) that require root privileges.

        Rationale: There are valid reasons for SUID programs, but it is important to identify and review such programs to ensure they are legitimate.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.13_Audit_SUID_executables\"
      do\n  title \"Audit SUID executables\"\n  desc  \"\n    The owner of a file
      can set the file's permissions to run with the owner's or group's permissions,
      even if the user running the program is not the owner or a member of the group.
      The most common reason for a SUID program is to enable users to perform functions
      (such as changing their password) that require root privileges.\n    \n    Rationale:
      There are valid reasons for SUID programs, but it is important to identify and
      review such programs to ensure they are legitimate.\n  \"\n  impact 0.0\n  describe
      \"Audit SUID executables\" do\n    skip \"Audit Procedure: Run the following
      command to list SUID files\n  \n    # df --local -P | awk '{if (NR!=1) print
      $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -4000\n  \n    The command
      above only searches local filesystems, there may still be compromised items
      on network mounted partitions.\n    Additionally, the --local option to df is
      not universal to all versions, it can be omitted to search all filesystems on\n
      \   a system including network mounted filesystems\n    or\n    the following
      command can be run manually for each partition:\n  \n    # find <partition>
      -xdev -type f -perm -4000\n  \n    Ensure that no rogue SUID programs have been
      introduced into the system.\n    Review the files returned by the action in
      the Audit section and confirm the integrity of these binaries.\"\n  end\nend\n"
    :source_location:
      :line: 3865
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Audit SUID executables
      :run_time: 7.231e-06
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource: ''
      :skip_message: "Audit Procedure: Run the following command to list SUID files\n
        \ \n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find
        '{}' -xdev -type f -perm -4000\n  \n    The command above only searches local
        filesystems, there may still be compromised items on network mounted partitions.\n
        \   Additionally, the --local option to df is not universal to all versions,
        it can be omitted to search all filesystems on\n    a system including network
        mounted filesystems\n    or\n    the following command can be run manually
        for each partition:\n  \n    # find <partition> -xdev -type f -perm -4000\n
        \ \n    Ensure that no rogue SUID programs have been introduced into the system.\n
        \   Review the files returned by the action in the Audit section and confirm
        the integrity of these binaries."
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Audit SUID executables
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.1.14_Audit_SGID_executables
    :title: Audit SGID executables
    :desc: |-
      The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges.

      Rationale: There are valid reasons for SGID programs, but it is important to identify and review such programs to ensure they are legitimate. Review the files returned by the action in the audit section and check to see if system binaries have a different md5 checksum than what from the package. This is an indication that the binary may have been replaced.
    :descriptions:
    - :label: default
      :data: |-
        The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges.

        Rationale: There are valid reasons for SGID programs, but it is important to identify and review such programs to ensure they are legitimate. Review the files returned by the action in the audit section and check to see if system binaries have a different md5 checksum than what from the package. This is an indication that the binary may have been replaced.
    :impact: 0.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.1.14_Audit_SGID_executables\"
      do\n  title \"Audit SGID executables\"\n  desc  \"\n    The owner of a file
      can set the file's permissions to run with the owner's or group's permissions,
      even if the user running the program is not the owner or a member of the group.
      The most common reason for a SGID program is to enable users to perform functions
      (such as changing their password) that require root privileges.\n    \n    Rationale:
      There are valid reasons for SGID programs, but it is important to identify and
      review such programs to ensure they are legitimate. Review the files returned
      by the action in the audit section and check to see if system binaries have
      a different md5 checksum than what from the package. This is an indication that
      the binary may have been replaced.\n  \"\n  impact 0.0\n  describe \"Audit SUID
      executables\" do\n    skip \"Audit Procedure: Run the following command to list
      SGID files\n  \n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I
      '{}' find '{}' -xdev -type f -perm -2000\n  \n    The command above only searches
      local filesystems, there may still be compromised items on network mounted partitions.\n
      \   Additionally, the --local option to df is not universal to all versions,
      it can be omitted to search all filesystems on\n    a system including network
      mounted filesystems\n    or\n    the following command can be run manually for
      each partition:\n  \n    # find <partition> -xdev -type f -perm -2000\n  \n
      \   Ensure that no rogue SGID programs have been introduced into the system.\n
      \   Review the files returned by the action in the Audit section and confirm
      the integrity of these binaries.\"\n  end\nend\n"
    :source_location:
      :line: 3891
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: Audit SUID executables
      :run_time: 4.547e-06
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource: ''
      :skip_message: "Audit Procedure: Run the following command to list SGID files\n
        \ \n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find
        '{}' -xdev -type f -perm -2000\n  \n    The command above only searches local
        filesystems, there may still be compromised items on network mounted partitions.\n
        \   Additionally, the --local option to df is not universal to all versions,
        it can be omitted to search all filesystems on\n    a system including network
        mounted filesystems\n    or\n    the following command can be run manually
        for each partition:\n  \n    # find <partition> -xdev -type f -perm -2000\n
        \ \n    Ensure that no rogue SGID programs have been introduced into the system.\n
        \   Review the files returned by the action in the Audit section and confirm
        the integrity of these binaries."
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: Audit SUID executables
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.1_Ensure_accounts_in_etcpasswd_use_shadowed_passwords
    :title: Ensure accounts in /etc/passwd use shadowed passwords
    :desc: |-
      Local accounts can use shadowed passwords.  With shadowed passwords, the passwords are saved in shadow password file, /etc/shadow , encrypted by a salted one-way hash. Accounts with a shadowed password have an x in the second field in /etc/passwd .

      Rationale: The /etc/passwd file also contains information like user ID's and group ID's that are used by many system programs. Therefore, the /etc/passwd file must remain world readable. In spite of encoding the password with a randomly-generated one-way hash function, an attacker could still break the system if they got access to the /etc/passwd file. This can be mitigated by using shadowed passwords, thus moving the passwords in the /etc/passwd file to /etc/shadow . The /etc/shadow file is set so only root will be able to read and write. This helps mitigate the risk of an attacker gaining access to the encoded passwords with which to perform a dictionary attack.

      **Note:**

      * All accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.
      *  A user account with an empty second field in /etc/passwd allows the account to be logged into by providing only the username.
    :descriptions:
    - :label: default
      :data: |-
        Local accounts can use shadowed passwords.  With shadowed passwords, the passwords are saved in shadow password file, /etc/shadow , encrypted by a salted one-way hash. Accounts with a shadowed password have an x in the second field in /etc/passwd .

        Rationale: The /etc/passwd file also contains information like user ID's and group ID's that are used by many system programs. Therefore, the /etc/passwd file must remain world readable. In spite of encoding the password with a randomly-generated one-way hash function, an attacker could still break the system if they got access to the /etc/passwd file. This can be mitigated by using shadowed passwords, thus moving the passwords in the /etc/passwd file to /etc/shadow . The /etc/shadow file is set so only root will be able to read and write. This helps mitigate the risk of an attacker gaining access to the encoded passwords with which to perform a dictionary attack.

        **Note:**

        * All accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.
        *  A user account with an empty second field in /etc/passwd allows the account to be logged into by providing only the username.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.1_Ensure_accounts_in_etcpasswd_use_shadowed_passwords\"
      do\n  title \"Ensure accounts in /etc/passwd use shadowed passwords\"\n  desc
      \ \"\n    Local accounts can use shadowed passwords.  With shadowed passwords,
      the passwords are saved in shadow password file, /etc/shadow , encrypted by
      a salted one-way hash. Accounts with a shadowed password have an x in the second
      field in /etc/passwd .\n    \n    Rationale: The /etc/passwd file also contains
      information like user ID's and group ID's that are used by many system programs.
      Therefore, the /etc/passwd file must remain world readable. In spite of encoding
      the password with a randomly-generated one-way hash function, an attacker could
      still break the system if they got access to the /etc/passwd file. This can
      be mitigated by using shadowed passwords, thus moving the passwords in the /etc/passwd
      file to /etc/shadow . The /etc/shadow file is set so only root will be able
      to read and write. This helps mitigate the risk of an attacker gaining access
      to the encoded passwords with which to perform a dictionary attack.\n    \n
      \   **Note:**\n    \n    * All accounts must have passwords or be locked to
      prevent the account from being used by an unauthorized user.\n    *  A user
      account with an empty second field in /etc/passwd allows the account to be logged
      into by providing only the username.\n  \"\n  impact 1.0\n  describe file(\"/etc/passwd\")
      do\n    its(\"content\") { should_not match(/^\\s*[^:]+:[^x:]*:[^:]*:[^:]*:[^:]*:[^:]*:[^:]*(\\s+#.*)?$/)
      }\n  end\nend\n"
    :source_location:
      :line: 3917
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/passwd content is expected not to match /^\s*[^:]+:[^x:]*:[^:]*:[^:]*:[^:]*:[^:]*:[^:]*(\s+#.*)?$/
      :run_time: 0.000192085
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.2_Ensure_etcshadow_password_fields_are_not_empty
    :title: Ensure /etc/shadow password fields are not empty
    :desc: |-
      An account with an empty password field means that anybody may log in as that user without providing a password.

      Rationale: All accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.
    :descriptions:
    - :label: default
      :data: |-
        An account with an empty password field means that anybody may log in as that user without providing a password.

        Rationale: All accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.2_Ensure_etcshadow_password_fields_are_not_empty\"
      do\n  title \"Ensure /etc/shadow password fields are not empty\"\n  desc  \"\n
      \   An account with an empty password field means that anybody may log in as
      that user without providing a password.\n    \n    Rationale: All accounts must
      have passwords or be locked to prevent the account from being used by an unauthorized
      user.\n  \"\n  impact 1.0\n  describe shadow.where { user =~ /.+/ and password
      !~ /.+/ } do\n    its(\"raw_data\") { should be_empty }\n  end\nend\n"
    :source_location:
      :line: 3935
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: skipped
      :code_desc: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :run_time: 4.876e-06
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource: 'Inspec::Resources::Shadow (Can''t read file: /etc/shadow)'
      :skip_message: 'Can''t read file: /etc/shadow'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: !ruby/object:FilterTable::ExceptionCatcher {}
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.3_Ensure_all_groups_in_etcpasswd_exist_in_etcgroup
    :title: Ensure all groups in /etc/passwd exist in /etc/group
    :desc: |-
      Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group .

      Rationale: Groups defined in the /etc/passwd file but not in the /etc/group file pose a threat to system security since group permissions are not properly managed.
    :descriptions:
    - :label: default
      :data: |-
        Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group .

        Rationale: Groups defined in the /etc/passwd file but not in the /etc/group file pose a threat to system security since group permissions are not properly managed.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.3_Ensure_all_groups_in_etcpasswd_exist_in_etcgroup\"
      do\n  title \"Ensure all groups in /etc/passwd exist in /etc/group\"\n  desc
      \ \"\n    Over time, system administration errors and changes can lead to groups
      being defined in /etc/passwd but not in /etc/group .\n    \n    Rationale: Groups
      defined in the /etc/passwd file but not in the /etc/group file pose a threat
      to system security since group permissions are not properly managed.\n  \"\n
      \ impact 1.0\n  groupslist = {}\n  passwd.uids.each_with_index {|k,i| groupslist[k]
      = passwd.gids[i] }\n  if groupslist.any?\n    groupslist.each do |uid,gid|\n
      \   describe etc_group do\n      its('gids') { should include gid.to_i }\n    end\n
      \ end\n  else\n    describe groupslist do\n      it { should be_empty }\n    end\n
      \ end\nend\n"
    :source_location:
      :line: 3948
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 0"
      :run_time: 0.000172456
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 1"
      :run_time: 0.000104693
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 2"
      :run_time: 0.000105186
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 4"
      :run_time: 0.000102582
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 7"
      :run_time: 0.000100204
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 0"
      :run_time: 9.9453e-05
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 0"
      :run_time: 0.000115542
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 0"
      :run_time: 0.000203544
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 12"
      :run_time: 0.000146433
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 0"
      :run_time: 0.000108163
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 100"
      :run_time: 0.000117575
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 50"
      :run_time: 0.000105915
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 65534"
      :run_time: 9.8067e-05
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 997"
      :run_time: 0.000110464
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 81"
      :run_time: 0.0001132
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 996"
      :run_time: 0.000103776
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 59"
      :run_time: 9.8998e-05
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 994"
      :run_time: 0.000100857
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 74"
      :run_time: 9.9869e-05
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 993"
      :run_time: 0.000131847
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 991"
      :run_time: 0.000103969
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 1000"
      :run_time: 0.000105275
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 990"
      :run_time: 0.000145217
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 989"
      :run_time: 0.000106236
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 988"
      :run_time: 0.000141828
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
    - :status: passed
      :code_desc: "/etc/group gids is expected to include 987"
      :run_time: 0.000106685
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.4_Ensure_no_duplicate_UIDs_exist
    :title: Ensure no duplicate UIDs exist
    :desc: |-
      Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.

      Rationale: Users must be assigned unique UIDs for accountability and to ensure appropriate access protections.
    :descriptions:
    - :label: default
      :data: |-
        Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.

        Rationale: Users must be assigned unique UIDs for accountability and to ensure appropriate access protections.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.4_Ensure_no_duplicate_UIDs_exist\"
      do\n  title \"Ensure no duplicate UIDs exist\"\n  desc  \"\n    Although the
      useradd program will not let you create a duplicate User ID (UID), it is possible
      for an administrator to manually edit the /etc/passwd file and change the UID
      field.\n    \n    Rationale: Users must be assigned unique UIDs for accountability
      and to ensure appropriate access protections.\n  \"\n  impact 1.0\n  describe
      passwd() do\n    its('uids') { should_not contain_duplicates }\n  end\nend\n"
    :source_location:
      :line: 3971
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/passwd uids is expected not to contain duplicates"
      :run_time: 0.000219169
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: passwd
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.5_Ensure_no_duplicate_GIDs_exist
    :title: Ensure no duplicate GIDs exist
    :desc: |-
      Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.

      Rationale: User groups must be assigned unique GIDs for accountability and to ensure appropriate access protections.
    :descriptions:
    - :label: default
      :data: |-
        Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.

        Rationale: User groups must be assigned unique GIDs for accountability and to ensure appropriate access protections.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.5_Ensure_no_duplicate_GIDs_exist\"
      do\n  title \"Ensure no duplicate GIDs exist\"\n  desc  \"\n    Although the
      groupadd program will not let you create a duplicate Group ID (GID), it is possible
      for an administrator to manually edit the /etc/group file and change the GID
      field.\n    \n    Rationale: User groups must be assigned unique GIDs for accountability
      and to ensure appropriate access protections.\n  \"\n  impact 1.0\n  describe
      etc_group() do\n    its('gids') { should_not contain_duplicates }\n  end\nend\n"
    :source_location:
      :line: 3984
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/group gids is expected not to contain duplicates"
      :run_time: 0.002276691
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.6_Ensure_no_duplicate_user_names_exist
    :title: Ensure no duplicate user names exist
    :desc: |-
      Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the username.

      Rationale: If a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in /etc/passwd . For example, if "test4" has a UID of 1000 and a subsequent "test4" entry has a UID of 2000, logging in as "test4" will use UID 1000. Effectively, the UID is shared, which is a security problem.
    :descriptions:
    - :label: default
      :data: |-
        Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the username.

        Rationale: If a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in /etc/passwd . For example, if "test4" has a UID of 1000 and a subsequent "test4" entry has a UID of 2000, logging in as "test4" will use UID 1000. Effectively, the UID is shared, which is a security problem.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.6_Ensure_no_duplicate_user_names_exist\"
      do\n  title \"Ensure no duplicate user names exist\"\n  desc  \"\n    Although
      the useradd program will not let you create a duplicate user name, it is possible
      for an administrator to manually edit the /etc/passwd file and change the username.\n
      \   \n    Rationale: If a user is assigned a duplicate user name, it will create
      and have access to files with the first UID for that username in /etc/passwd
      . For example, if \\\"test4\\\" has a UID of 1000 and a subsequent \\\"test4\\\"
      entry has a UID of 2000, logging in as \\\"test4\\\" will use UID 1000. Effectively,
      the UID is shared, which is a security problem.\n  \"\n  impact 1.0\n  describe
      passwd() do\n    its('users') { should_not contain_duplicates }\n  end\nend\n"
    :source_location:
      :line: 3997
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/passwd users is expected not to contain duplicates"
      :run_time: 0.000153165
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: passwd
      :resource_params: "[]"
      :resource_id: ''
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.7_Ensure_no_duplicate_group_names_exist
    :title: Ensure no duplicate group names exist
    :desc: |-
      Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.

      Rationale: If a group is assigned a duplicate group name, it will create and have access to files with the first GID for that group in /etc/group . Effectively, the GID is shared, which is a security problem.
    :descriptions:
    - :label: default
      :data: |-
        Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.

        Rationale: If a group is assigned a duplicate group name, it will create and have access to files with the first GID for that group in /etc/group . Effectively, the GID is shared, which is a security problem.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.7_Ensure_no_duplicate_group_names_exist\"
      do\n  title \"Ensure no duplicate group names exist\"\n  desc  \"\n    Although
      the groupadd program will not let you create a duplicate group name, it is possible
      for an administrator to manually edit the /etc/group file and change the group
      name.\n    \n    Rationale: If a group is assigned a duplicate group name, it
      will create and have access to files with the first GID for that group in /etc/group
      . Effectively, the GID is shared, which is a security problem.\n  \"\n  impact
      1.0\n  describe etc_group() do\n    its('groups') { should_not contain_duplicates
      }\n  end\nend\n"
    :source_location:
      :line: 4010
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "/etc/group groups is expected not to contain duplicates"
      :run_time: 0.000230721
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: etc_group
      :resource_params: "[]"
      :resource_id: "/etc/group"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.8_Ensure_root_PATH_Integrity
    :title: Ensure root PATH Integrity
    :desc: |-
      The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.

      Rationale: Including the current working directory (.) or other writable directory in root 's executable path makes it likely that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse program.
    :descriptions:
    - :label: default
      :data: |-
        The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.

        Rationale: Including the current working directory (.) or other writable directory in root 's executable path makes it likely that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse program.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.8_Ensure_root_PATH_Integrity\"
      do\n  title \"Ensure root PATH Integrity\"\n  desc  \"\n    The root user can
      execute any command on the system and could be fooled into executing programs
      unintentionally if the PATH is not set correctly.\n    \n    Rationale: Including
      the current working directory (.) or other writable directory in root 's executable
      path makes it likely that an attacker can gain superuser access by forcing an
      administrator operating as root to execute a Trojan horse program.\n  \"\n  impact
      1.0\n  output = command(\"sudo -Hiu root env | grep '^PATH=' | cut -d= -f2 |
      tr -d \\\"\\n\\\"\").stdout.to_s\n  describe command(\"echo -n #{output} | grep
      ':$'\").stdout do\n    it { should be_empty }\n  end\n  output_array = output.split(':')\n
      \ describe output_array do\n    it { should_not be_empty }\n  end\n  output_array.each
      do |path|\n    describe path do\n      it { should_not cmp \"\" }\n      it
      { should_not cmp \".\" }\n    end\n    describe directory(path) do\n      it
      { should be_directory }\n      it { should_not be_writable.by 'group' }\n      it
      { should_not be_writable.by 'other' }\n      it { should be_owned_by \"root\"
      }\n    end\n  end\nend\n"
    :source_location:
      :line: 4023
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: is expected to be empty
      :run_time: 0.005932201
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: '["/root/.local/bin", "/root/bin", "/usr/local/sbin", "/sbin", "/bin",
        "/usr/sbin", "/usr/bin"] is expected not to be empty'
      :run_time: 0.002322913
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: ''
    - :status: passed
      :code_desc: /root/.local/bin is expected not to cmp == ""
      :run_time: 0.001777102
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/root/.local/bin"
    - :status: passed
      :code_desc: /root/.local/bin is expected not to cmp == "."
      :run_time: 0.000150424
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/root/.local/bin"
    - :status: failed
      :code_desc: Directory /root/.local/bin is expected to be directory
      :run_time: 0.042712805
      :start_time: '2024-04-04T14:52:41+00:00'
      :message: expected `Directory /root/.local/bin.directory?` to be truthy, got
        false
      :resource_class: directory
      :resource_params: '["/root/.local/bin"]'
      :resource_id: "/root/.local/bin"
    - :status: passed
      :code_desc: Directory /root/.local/bin is expected not to be writable by group
      :run_time: 0.058727529
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/root/.local/bin"]'
      :resource_id: "/root/.local/bin"
    - :status: passed
      :code_desc: Directory /root/.local/bin is expected not to be writable by other
      :run_time: 0.002776312
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/root/.local/bin"]'
      :resource_id: "/root/.local/bin"
    - :status: failed
      :code_desc: Directory /root/.local/bin is expected to be owned by "root"
      :run_time: 0.019816783
      :start_time: '2024-04-04T14:52:41+00:00'
      :message: expected `Directory /root/.local/bin.owned_by?("root")` to be truthy,
        got false
      :resource_class: directory
      :resource_params: '["/root/.local/bin"]'
      :resource_id: "/root/.local/bin"
    - :status: passed
      :code_desc: /root/bin is expected not to cmp == ""
      :run_time: 0.000198754
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/root/bin"
    - :status: passed
      :code_desc: /root/bin is expected not to cmp == "."
      :run_time: 0.002187352
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/root/bin"
    - :status: failed
      :code_desc: Directory /root/bin is expected to be directory
      :run_time: 0.036739808
      :start_time: '2024-04-04T14:52:41+00:00'
      :message: expected `Directory /root/bin.directory?` to be truthy, got false
      :resource_class: directory
      :resource_params: '["/root/bin"]'
      :resource_id: "/root/bin"
    - :status: passed
      :code_desc: Directory /root/bin is expected not to be writable by group
      :run_time: 0.067825829
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/root/bin"]'
      :resource_id: "/root/bin"
    - :status: passed
      :code_desc: Directory /root/bin is expected not to be writable by other
      :run_time: 0.000227316
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/root/bin"]'
      :resource_id: "/root/bin"
    - :status: failed
      :code_desc: Directory /root/bin is expected to be owned by "root"
      :run_time: 0.002756344
      :start_time: '2024-04-04T14:52:41+00:00'
      :message: expected `Directory /root/bin.owned_by?("root")` to be truthy, got
        false
      :resource_class: directory
      :resource_params: '["/root/bin"]'
      :resource_id: "/root/bin"
    - :status: passed
      :code_desc: /usr/local/sbin is expected not to cmp == ""
      :run_time: 0.000259348
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: /usr/local/sbin is expected not to cmp == "."
      :run_time: 0.000131161
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: Directory /usr/local/sbin is expected to be directory
      :run_time: 0.057195556
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/usr/local/sbin"]'
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: Directory /usr/local/sbin is expected not to be writable by group
      :run_time: 0.062819045
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/usr/local/sbin"]'
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: Directory /usr/local/sbin is expected not to be writable by other
      :run_time: 0.000230181
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/usr/local/sbin"]'
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: Directory /usr/local/sbin is expected to be owned by "root"
      :run_time: 0.002745629
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/usr/local/sbin"]'
      :resource_id: "/usr/local/sbin"
    - :status: passed
      :code_desc: /sbin is expected not to cmp == ""
      :run_time: 0.000244521
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/sbin"
    - :status: passed
      :code_desc: /sbin is expected not to cmp == "."
      :run_time: 0.000126322
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/sbin"
    - :status: passed
      :code_desc: Directory /sbin is expected to be directory
      :run_time: 0.056536947
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /sbin is expected not to be writable by group
      :run_time: 0.063917231
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /sbin is expected not to be writable by other
      :run_time: 0.000218418
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /sbin is expected to be owned by "root"
      :run_time: 0.002697965
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: /bin is expected not to cmp == ""
      :run_time: 0.000219001
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/bin"
    - :status: passed
      :code_desc: /bin is expected not to cmp == "."
      :run_time: 0.000456117
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/bin"
    - :status: passed
      :code_desc: Directory /bin is expected to be directory
      :run_time: 0.05543373
      :start_time: '2024-04-04T14:52:41+00:00'
      :resource_class: directory
      :resource_params: '["/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /bin is expected not to be writable by group
      :run_time: 0.059006214
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /bin is expected not to be writable by other
      :run_time: 0.000240625
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /bin is expected to be owned by "root"
      :run_time: 0.002591676
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: /usr/sbin is expected not to cmp == ""
      :run_time: 0.000255222
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: /usr/sbin is expected not to cmp == "."
      :run_time: 0.000159139
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /usr/sbin is expected to be directory
      :run_time: 0.055862887
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /usr/sbin is expected not to be writable by group
      :run_time: 0.058531687
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /usr/sbin is expected not to be writable by other
      :run_time: 0.000229299
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: Directory /usr/sbin is expected to be owned by "root"
      :run_time: 0.00266822
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/sbin"]'
      :resource_id: "/usr/sbin"
    - :status: passed
      :code_desc: /usr/bin is expected not to cmp == ""
      :run_time: 0.000199288
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: /usr/bin is expected not to cmp == "."
      :run_time: 0.000128757
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: Object
      :resource_params: "[]"
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /usr/bin is expected to be directory
      :run_time: 0.05650668
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /usr/bin is expected not to be writable by group
      :run_time: 0.059058499
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /usr/bin is expected not to be writable by other
      :run_time: 0.000226846
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/bin"]'
      :resource_id: "/usr/bin"
    - :status: passed
      :code_desc: Directory /usr/bin is expected to be owned by "root"
      :run_time: 0.002736839
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: directory
      :resource_params: '["/usr/bin"]'
      :resource_id: "/usr/bin"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.9_Ensure_root_is_the_only_UID_0_account
    :title: Ensure root is the only UID 0 account
    :desc: |-
      Any account with UID 0 has superuser privileges on the system.

      Rationale: This access must be limited to only the default root account and only from the system console. Administrative access must be through an unprivileged account using an approved mechanism as noted in Item 5.6 Ensure access to the su command is restricted.
    :descriptions:
    - :label: default
      :data: |-
        Any account with UID 0 has superuser privileges on the system.

        Rationale: This access must be limited to only the default root account and only from the system console. Administrative access must be through an unprivileged account using an approved mechanism as noted in Item 5.6 Ensure access to the su command is restricted.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.9_Ensure_root_is_the_only_UID_0_account\"
      do\n  title \"Ensure root is the only UID 0 account\"\n  desc  \"\n    Any account
      with UID 0 has superuser privileges on the system.\n    \n    Rationale: This
      access must be limited to only the default root account and only from the system
      console. Administrative access must be through an unprivileged account using
      an approved mechanism as noted in Item 5.6 Ensure access to the su command is
      restricted.\n  \"\n  impact 1.0\n  describe file(\"/etc/passwd\") do\n    its(\"content\")
      { should_not match(/^(?!root:)[^:]*:[^:]*:0/) }\n  end\nend\n"
    :source_location:
      :line: 4053
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: File /etc/passwd content is expected not to match /^(?!root:)[^:]*:[^:]*:0/
      :run_time: 0.000198628
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: file
      :resource_params: '["/etc/passwd"]'
      :resource_id: "/etc/passwd"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.10_Ensure_local_interactive_user_home_directories_exist
    :title: Ensure local interactive user home directories exist
    :desc: |-
      Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.

      Rationale: If the user's home directory does not exist or is unassigned, the user will be placed in "/" and will not be able to write any files or have local environment variables set.
    :descriptions:
    - :label: default
      :data: |-
        Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.

        Rationale: If the user's home directory does not exist or is unassigned, the user will be placed in "/" and will not be able to write any files or have local environment variables set.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.10_Ensure_local_interactive_user_home_directories_exist\"
      do\n  title \"Ensure local interactive user home directories exist\"\n  desc
      \ \"\n    Users can be defined in /etc/passwd without a home directory or with
      a home directory that does not actually exist.\n    \n    Rationale: If the
      user's home directory does not exist or is unassigned, the user will be placed
      in \\\"/\\\" and will not be able to write any files or have local environment
      variables set.\n  \"\n  impact 1.0\n  describe bash(\"valid_shells=\\\"^($(
      sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|'
      - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F: '$(NF) ~ pat { print $1 \\\"
      \\\" $(NF-1) }' /etc/passwd | (while read -r user home; do\\n\\t[ ! -d \\\"$home\\\"
      ] && output=\\\"$output\\\\n  - User \\\\\\\"$user\\\\\\\" home directory \\\\\\\"$home\\\\\\\"
      doesn't exist\\\"\\ndone\\n\\nif [ -z \\\"$output\\\" ]; then\\n\\techo -e \\\"\\\\n-PASSED:
      - All local interactive users have a home directory\\\"\\n\\texit 0\\nelse\\n\\techo
      -e \\\"\\\\n- FAILED:\\\\n$output\\\\n\\\"\\n\\texit 1\\nfi\\n)\") do\n    its(\"exit_status\")
      { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4066
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command valid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\t[ ! -d \"$home\" ] && output=\"$output\\n  - User \\\"$user\\\" home
        directory \\\"$home\\\" doesn't exist\"\ndone\n\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n-PASSED: - All local interactive users have a home directory\"\n\texit
        0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n) exit_status
        is expected to eq 0"
      :run_time: 0.077597276
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["valid_shells=\"^($( sed -rn ''/^\\//{s,/,\\\\\\\\/,g;p}''
        /etc/shells | paste -s -d ''|'' - ))$\"\nawk -v pat=\"$valid_shells\" -F:
        ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd | (while read -r user
        home; do\n\t[ ! -d \"$home\" ] && output=\"$output\\n  - User \\\"$user\\\"
        home directory \\\"$home\\\" doesn''t exist\"\ndone\n\nif [ -z \"$output\"
        ]; then\n\techo -e \"\\n-PASSED: - All local interactive users have a home
        directory\"\n\texit 0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit
        1\nfi\n)"]'
      :resource_id: "valid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells
        | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat {
        print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\n\t[
        ! -d \"$home\" ] && output=\"$output\\n  - User \\\"$user\\\" home directory
        \\\"$home\\\" doesn't exist\"\ndone\n\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n-PASSED: - All local interactive users have a home directory\"\n\texit
        0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.11_Ensure_local_interactive_users_own_their_home_directories
    :title: Ensure local interactive users own their home directories
    :desc: |-
      The user home directory is space defined for the particular user to set local environment variables and to store personal files.

      Rationale: Since the user is accountable for files stored in the user home directory, the user must be the owner of the directory.
    :descriptions:
    - :label: default
      :data: |-
        The user home directory is space defined for the particular user to set local environment variables and to store personal files.

        Rationale: Since the user is accountable for files stored in the user home directory, the user must be the owner of the directory.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.11_Ensure_local_interactive_users_own_their_home_directories\"
      do\n  title \"Ensure local interactive users own their home directories\"\n
      \ desc  \"\n    The user home directory is space defined for the particular
      user to set local environment variables and to store personal files.\n    \n
      \   Rationale: Since the user is accountable for files stored in the user home
      directory, the user must be the owner of the directory.\n  \"\n  impact 1.0\n
      \ describe bash(\"valid_shells=\\\"^($( sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}'
      /etc/shells | paste -s -d '|' - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F:
      '$(NF) ~ pat { print $1 \\\" \\\" $(NF-1) }' /etc/passwd | (while read -r user
      home; do\\n\\towner=\\\"$(stat -L -c \\\"%U\\\" \\\"$home\\\")\\\"\\n\\t[ \\\"$owner\\\"
      != \\\"$user\\\" ] && output=\\\"$output\\\\n  - User \\\\\\\"$user\\\\\\\"
      home directory \\\\\\\"$home\\\\\\\" is owned by user \\\\\\\"$owner\\\\\\\"\\\"\\ndone\\n\\nif
      [ -z \\\"$output\\\" ]; then\\n   echo -e \\\"\\\\n-PASSED: - All local interactive
      users have a home directory\\\\n\\\"\\n   exit 0\\nelse\\n   echo -e \\\"\\\\n-
      FAILED:\\\\n$output\\\\n\\\"\\n\\texit 1\\nfi\\n)\") do\n    its(\"exit_status\")
      { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4079
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command valid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\towner=\"$(stat -L -c \"%U\" \"$home\")\"\n\t[ \"$owner\" != \"$user\"
        ] && output=\"$output\\n  - User \\\"$user\\\" home directory \\\"$home\\\"
        is owned by user \\\"$owner\\\"\"\ndone\n\nif [ -z \"$output\" ]; then\n   echo
        -e \"\\n-PASSED: - All local interactive users have a home directory\\n\"\n
        \  exit 0\nelse\n   echo -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n)
        exit_status is expected to eq 0"
      :run_time: 0.084313389
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["valid_shells=\"^($( sed -rn ''/^\\//{s,/,\\\\\\\\/,g;p}''
        /etc/shells | paste -s -d ''|'' - ))$\"\nawk -v pat=\"$valid_shells\" -F:
        ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd | (while read -r user
        home; do\n\towner=\"$(stat -L -c \"%U\" \"$home\")\"\n\t[ \"$owner\" != \"$user\"
        ] && output=\"$output\\n  - User \\\"$user\\\" home directory \\\"$home\\\"
        is owned by user \\\"$owner\\\"\"\ndone\n\nif [ -z \"$output\" ]; then\n   echo
        -e \"\\n-PASSED: - All local interactive users have a home directory\\n\"\n   exit
        0\nelse\n   echo -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n)"]'
      :resource_id: "valid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells
        | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat {
        print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\n\towner=\"$(stat
        -L -c \"%U\" \"$home\")\"\n\t[ \"$owner\" != \"$user\" ] && output=\"$output\\n
        \ - User \\\"$user\\\" home directory \\\"$home\\\" is owned by user \\\"$owner\\\"\"\ndone\n\nif
        [ -z \"$output\" ]; then\n   echo -e \"\\n-PASSED: - All local interactive
        users have a home directory\\n\"\n   exit 0\nelse\n   echo -e \"\\n- FAILED:\\n$output\\n\"\n\texit
        1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.12_Ensure_local_interactive_user_home_directories_are_mode_750_or_more_restrictive
    :title: Ensure local interactive user home directories are mode 750 or more restrictive
    :desc: |-
      While the system administrator can establish secure permissions for users' home directories, the users can easily override these.

      Rationale: Group or world-writable user home directories may enable malicious users to steal or modify other users' data or to gain another user's system privileges.
    :descriptions:
    - :label: default
      :data: |-
        While the system administrator can establish secure permissions for users' home directories, the users can easily override these.

        Rationale: Group or world-writable user home directories may enable malicious users to steal or modify other users' data or to gain another user's system privileges.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.12_Ensure_local_interactive_user_home_directories_are_mode_750_or_more_restrictive\"
      do\n  title \"Ensure local interactive user home directories are mode 750 or
      more restrictive\"\n  desc  \"\n    While the system administrator can establish
      secure permissions for users' home directories, the users can easily override
      these.\n    \n    Rationale: Group or world-writable user home directories may
      enable malicious users to steal or modify other users' data or to gain another
      user's system privileges.\n  \"\n  impact 1.0\n  describe bash(\"output=\\\"\\\"\\nperm_mask=\\\"0027\\\"\\nmaxperm=\\\"$(
      printf '%o' $(( 0777 & ~$perm_mask)) )\\\"\\nvalid_shells=\\\"^($( sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}'
      /etc/shells | paste -s -d '|' - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F:
      '$(NF) ~ pat { print $1 \\\" \\\" $(NF-1) }' /etc/passwd | (while read -r user
      home; do\\n\\tif [ -d \\\"$home\\\" ]; then\\n\\t\\tmode=$( stat -L -c '%#a'
      \\\"$home\\\" )\\n\\t\\t[ $(( \\\"$mode\\\" & \\\"$perm_mask\\\" )) -gt 0 ]
      && output=\\\"$output\\\\n- User $user home directory: \\\\\\\"$home\\\\\\\"
      is too permissive: \\\\\\\"$mode\\\\\\\" (should be: \\\\\\\"$maxperm\\\\\\\"
      or more restrictive)\\\"\\n\\tfi\\ndone\\nif [ -z \\\"$output\\\" ]; then\\n\\techo
      -e \\\"\\\\n- Passed:\\\\n- All user home directories are mode: \\\\\\\"$maxperm\\\\\\\"
      or more restrictive\\\"\\n\\texit 0\\nelse\\n\\techo -e \\\"\\\\n- Failed:$output\\\"\\n\\texit
      1\\nfi\\n)\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4092
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command output=\"\"\nperm_mask=\"0027\"\nmaxperm=\"$( printf
        '%o' $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tif [ -d \"$home\" ]; then\n\t\tmode=$( stat -L -c '%#a' \"$home\" )\n\t\t[
        $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ] && output=\"$output\\n- User $user
        home directory: \\\"$home\\\" is too permissive: \\\"$mode\\\" (should be:
        \\\"$maxperm\\\" or more restrictive)\"\n\tfi\ndone\nif [ -z \"$output\" ];
        then\n\techo -e \"\\n- Passed:\\n- All user home directories are mode: \\\"$maxperm\\\"
        or more restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit
        1\nfi\n) exit_status is expected to eq 0"
      :run_time: 0.084875434
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["output=\"\"\nperm_mask=\"0027\"\nmaxperm=\"$( printf ''%o''
        $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn ''/^\\//{s,/,\\\\\\\\/,g;p}''
        /etc/shells | paste -s -d ''|'' - ))$\"\nawk -v pat=\"$valid_shells\" -F:
        ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd | (while read -r user
        home; do\n\tif [ -d \"$home\" ]; then\n\t\tmode=$( stat -L -c ''%#a'' \"$home\"
        )\n\t\t[ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ] && output=\"$output\\n-
        User $user home directory: \\\"$home\\\" is too permissive: \\\"$mode\\\"
        (should be: \\\"$maxperm\\\" or more restrictive)\"\n\tfi\ndone\nif [ -z \"$output\"
        ]; then\n\techo -e \"\\n- Passed:\\n- All user home directories are mode:
        \\\"$maxperm\\\" or more restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit
        1\nfi\n)"]'
      :resource_id: "output=\"\"\nperm_mask=\"0027\"\nmaxperm=\"$( printf '%o' $((
        0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tif [ -d \"$home\" ]; then\n\t\tmode=$( stat -L -c '%#a' \"$home\" )\n\t\t[
        $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ] && output=\"$output\\n- User $user
        home directory: \\\"$home\\\" is too permissive: \\\"$mode\\\" (should be:
        \\\"$maxperm\\\" or more restrictive)\"\n\tfi\ndone\nif [ -z \"$output\" ];
        then\n\techo -e \"\\n- Passed:\\n- All user home directories are mode: \\\"$maxperm\\\"
        or more restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit
        1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.13_Ensure_no_local_interactive_user_has_.netrc_files
    :title: Ensure no local interactive user has .netrc files
    :desc: |-
      The .netrc file contains data for logging into a remote host for file transfers via FTP.

      While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.

      Rationale: The .netrc file presents a significant security risk since it stores passwords in unencrypted form. Even if FTP is disabled, user accounts may have brought over .netrc files from other systems which could pose a risk to those systems.

      If a .netrc file is required, and follows local site policy, it should have permissions of 600 or more restrictive.
    :descriptions:
    - :label: default
      :data: |-
        The .netrc file contains data for logging into a remote host for file transfers via FTP.

        While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.

        Rationale: The .netrc file presents a significant security risk since it stores passwords in unencrypted form. Even if FTP is disabled, user accounts may have brought over .netrc files from other systems which could pose a risk to those systems.

        If a .netrc file is required, and follows local site policy, it should have permissions of 600 or more restrictive.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.13_Ensure_no_local_interactive_user_has_.netrc_files\"
      do\n  title \"Ensure no local interactive user has .netrc files\"\n  desc  \"\n
      \   The .netrc file contains data for logging into a remote host for file transfers
      via FTP.\n    \n    While the system administrator can establish secure permissions
      for users' .netrc files, the users can easily override these.\n    \n    Rationale:
      The .netrc file presents a significant security risk since it stores passwords
      in unencrypted form. Even if FTP is disabled, user accounts may have brought
      over .netrc files from other systems which could pose a risk to those systems.\n
      \   \n    If a .netrc file is required, and follows local site policy, it should
      have permissions of 600 or more restrictive.\n  \"\n  impact 1.0\n  describe
      bash(\"output=\\\"\\\" output2=\\\"\\\"\\nperm_mask=\\\"0177\\\"\\nmaxperm=\\\"$(
      printf '%o' $(( 0777 & ~$perm_mask)) )\\\"\\nvalid_shells=\\\"^($( sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}'
      /etc/shells | paste -s -d '|' - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F:
      '$(NF) ~ pat { print $1 \\\" \\\" $(NF-1) }' /etc/passwd | (while read -r user
      home; do\\n\\tif [ -f \\\"$home/.netrc\\\" ]; then\\n\\t\\tmode=\\\"$( stat
      -L -c '%#a' \\\"$home/.netrc\\\" )\\\"\\n\\t\\tif [ $(( \\\"$mode\\\" & \\\"$perm_mask\\\"
      )) -gt 0 ]; then\\n\\t\\t\\toutput=\\\"$output\\\\n  - User \\\\\\\"$user\\\\\\\"
      file: \\\\\\\"$home/.netrc\\\\\\\" is too permissive: \\\\\\\"$mode\\\\\\\"
      (should be: \\\\\\\"$maxperm\\\\\\\" or more restrictive)\\\"\\n\\t\\telse\\n\\t\\t\\toutput2=\\\"$output2\\\\n
      \ - User \\\\\\\"$user\\\\\\\" file: \\\\\\\"$home/.netrc\\\\\\\" exists and
      has file mode: \\\\\\\"$mode\\\\\\\" (should be: \\\\\\\"$maxperm\\\\\\\" or
      more restrictive)\\\"\\n\\t\\tfi\\n\\tfi\\ndone\\n\\nif [ -z \\\"$output\\\"
      ]; then\\n\\tif [ -z \\\"$output2\\\" ]; then\\n\\t\\techo -e \\\"\\\\n-PASSED:
      - No local interactive users have \\\\\\\".netrc\\\\\\\" files in their home
      directory\\\\n\\\"\\n\\telse\\n\\t\\techo -e \\\"\\\\n- WARNING:\\\\n$output2\\\\n\\\"\\n\\tfi\\n\\texit
      0\\nelse\\n\\techo -e \\\"\\\\n- FAILED:\\\\n$output\\\\n\\\"\\n\\t[ -n \\\"$output2\\\"
      ] && echo -e \\\"\\\\n- WARNING:\\\\n$output2\\\\n\\\"\\n\\texit 1\\nfi\\n)\")
      do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4105
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command output=\"\" output2=\"\"\nperm_mask=\"0177\"\nmaxperm=\"$(
        printf '%o' $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tif [ -f \"$home/.netrc\" ]; then\n\t\tmode=\"$( stat -L -c '%#a' \"$home/.netrc\"
        )\"\n\t\tif [ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ]; then\n\t\t\toutput=\"$output\\n
        \ - User \\\"$user\\\" file: \\\"$home/.netrc\\\" is too permissive: \\\"$mode\\\"
        (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\telse\n\t\t\toutput2=\"$output2\\n
        \ - User \\\"$user\\\" file: \\\"$home/.netrc\\\" exists and has file mode:
        \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\tfi\n\tfi\ndone\n\nif
        [ -z \"$output\" ]; then\n\tif [ -z \"$output2\" ]; then\n\t\techo -e \"\\n-PASSED:
        - No local interactive users have \\\".netrc\\\" files in their home directory\\n\"\n\telse\n\t\techo
        -e \"\\n- WARNING:\\n$output2\\n\"\n\tfi\n\texit 0\nelse\n\techo -e \"\\n-
        FAILED:\\n$output\\n\"\n\t[ -n \"$output2\" ] && echo -e \"\\n- WARNING:\\n$output2\\n\"\n\texit
        1\nfi\n) exit_status is expected to eq 0"
      :run_time: 0.084370993
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["output=\"\" output2=\"\"\nperm_mask=\"0177\"\nmaxperm=\"$(
        printf ''%o'' $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn ''/^\\//{s,/,\\\\\\\\/,g;p}''
        /etc/shells | paste -s -d ''|'' - ))$\"\nawk -v pat=\"$valid_shells\" -F:
        ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd | (while read -r user
        home; do\n\tif [ -f \"$home/.netrc\" ]; then\n\t\tmode=\"$( stat -L -c ''%#a''
        \"$home/.netrc\" )\"\n\t\tif [ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ];
        then\n\t\t\toutput=\"$output\\n  - User \\\"$user\\\" file: \\\"$home/.netrc\\\"
        is too permissive: \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\telse\n\t\t\toutput2=\"$output2\\n  -
        User \\\"$user\\\" file: \\\"$home/.netrc\\\" exists and has file mode: \\\"$mode\\\"
        (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\tfi\n\tfi\ndone\n\nif
        [ -z \"$output\" ]; then\n\tif [ -z \"$output2\" ]; then\n\t\techo -e \"\\n-PASSED:
        - No local interactive users have \\\".netrc\\\" files in their home directory\\n\"\n\telse\n\t\techo
        -e \"\\n- WARNING:\\n$output2\\n\"\n\tfi\n\texit 0\nelse\n\techo -e \"\\n-
        FAILED:\\n$output\\n\"\n\t[ -n \"$output2\" ] && echo -e \"\\n- WARNING:\\n$output2\\n\"\n\texit
        1\nfi\n)"]'
      :resource_id: "output=\"\" output2=\"\"\nperm_mask=\"0177\"\nmaxperm=\"$( printf
        '%o' $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tif [ -f \"$home/.netrc\" ]; then\n\t\tmode=\"$( stat -L -c '%#a' \"$home/.netrc\"
        )\"\n\t\tif [ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ]; then\n\t\t\toutput=\"$output\\n
        \ - User \\\"$user\\\" file: \\\"$home/.netrc\\\" is too permissive: \\\"$mode\\\"
        (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\telse\n\t\t\toutput2=\"$output2\\n
        \ - User \\\"$user\\\" file: \\\"$home/.netrc\\\" exists and has file mode:
        \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\t\tfi\n\tfi\ndone\n\nif
        [ -z \"$output\" ]; then\n\tif [ -z \"$output2\" ]; then\n\t\techo -e \"\\n-PASSED:
        - No local interactive users have \\\".netrc\\\" files in their home directory\\n\"\n\telse\n\t\techo
        -e \"\\n- WARNING:\\n$output2\\n\"\n\tfi\n\texit 0\nelse\n\techo -e \"\\n-
        FAILED:\\n$output\\n\"\n\t[ -n \"$output2\" ] && echo -e \"\\n- WARNING:\\n$output2\\n\"\n\texit
        1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.14_Ensure_no_local_interactive_user_has_.forward_files
    :title: Ensure no local interactive user has .forward files
    :desc: |-
      The .forward file specifies an email address to forward the user's mail to.

      Rationale: Use of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a risk as it can be used to execute commands that may perform unintended actions.
    :descriptions:
    - :label: default
      :data: |-
        The .forward file specifies an email address to forward the user's mail to.

        Rationale: Use of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a risk as it can be used to execute commands that may perform unintended actions.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.14_Ensure_no_local_interactive_user_has_.forward_files\"
      do\n  title \"Ensure no local interactive user has .forward files\"\n  desc
      \ \"\n    The .forward file specifies an email address to forward the user's
      mail to.\n    \n    Rationale: Use of the .forward file poses a security risk
      in that sensitive data may be inadvertently transferred outside the organization.
      The .forward file also poses a risk as it can be used to execute commands that
      may perform unintended actions.\n  \"\n  impact 1.0\n  describe bash(\"output=\\\"\\\"\\nfname=\\\".forward\\\"\\nvalid_shells=\\\"^($(
      sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|'
      - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F: '$(NF) ~ pat { print $1 \\\"
      \\\" $(NF-1) }' /etc/passwd | (while read -r user home; do\\n\\t[ -f \\\"$home/$fname\\\"
      ] && output=\\\"$output\\\\n  - User \\\\\\\"$user\\\\\\\" file: \\\\\\\"$home/$fname\\\\\\\"
      exists\\\"\\ndone\\n\\nif [ -z \\\"$output\\\" ]; then\\n\\techo -e \\\"\\\\n-PASSED:
      - No local interactive users have \\\\\\\"$fname\\\\\\\" files in their home
      directory\\\\n\\\"\\n\\texit 0\\nelse\\n\\techo -e \\\"\\\\n- FAILED:\\\\n$output\\\\n\\\"\\n\\texit
      1\\nfi\\n)\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4122
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command output=\"\"\nfname=\".forward\"\nvalid_shells=\"^($(
        sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk
        -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd
        | (while read -r user home; do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n
        \ - User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z
        \"$output\" ]; then\n\techo -e \"\\n-PASSED: - No local interactive users
        have \\\"$fname\\\" files in their home directory\\n\"\n\texit 0\nelse\n\techo
        -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n) exit_status is expected
        to eq 0"
      :run_time: 0.081285235
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["output=\"\"\nfname=\".forward\"\nvalid_shells=\"^($( sed
        -rn ''/^\\//{s,/,\\\\\\\\/,g;p}'' /etc/shells | paste -s -d ''|'' - ))$\"\nawk
        -v pat=\"$valid_shells\" -F: ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd
        | (while read -r user home; do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n  -
        User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z \"$output\"
        ]; then\n\techo -e \"\\n-PASSED: - No local interactive users have \\\"$fname\\\"
        files in their home directory\\n\"\n\texit 0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit
        1\nfi\n)"]'
      :resource_id: "output=\"\"\nfname=\".forward\"\nvalid_shells=\"^($( sed -rn
        '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v
        pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd
        | (while read -r user home; do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n
        \ - User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z
        \"$output\" ]; then\n\techo -e \"\\n-PASSED: - No local interactive users
        have \\\"$fname\\\" files in their home directory\\n\"\n\texit 0\nelse\n\techo
        -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.15_Ensure_no_local_interactive_user_has_.rhosts_files
    :title: Ensure no local interactive user has .rhosts files
    :desc: |-
      While no .rhosts files are shipped by default, users can easily create them.

      Rationale: This action is only meaningful if .rhosts support is permitted in the file /etc/pam.conf . Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , they may have been brought over from other systems and could contain information useful to an attacker for those other systems.
    :descriptions:
    - :label: default
      :data: |-
        While no .rhosts files are shipped by default, users can easily create them.

        Rationale: This action is only meaningful if .rhosts support is permitted in the file /etc/pam.conf . Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , they may have been brought over from other systems and could contain information useful to an attacker for those other systems.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.15_Ensure_no_local_interactive_user_has_.rhosts_files\"
      do\n  title \"Ensure no local interactive user has .rhosts files\"\n  desc  \"\n
      \   While no .rhosts files are shipped by default, users can easily create them.\n
      \   \n    Rationale: This action is only meaningful if .rhosts support is permitted
      in the file /etc/pam.conf . Even though the .rhosts files are ineffective if
      support is disabled in /etc/pam.conf , they may have been brought over from
      other systems and could contain information useful to an attacker for those
      other systems.\n  \"\n  impact 1.0\n  describe bash(\"output=\\\"\\\"\\nfname=\\\".rhosts\\\"\\nvalid_shells=\\\"^($(
      sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|'
      - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F: '$(NF) ~ pat { print $1 \\\"
      \\\" $(NF-1) }' /etc/passwd | (while read -r user home; do\\n\\t[ -f \\\"$home/$fname\\\"
      ] && output=\\\"$output\\\\n  - User \\\\\\\"$user\\\\\\\" file: \\\\\\\"$home/$fname\\\\\\\"
      exists\\\"\\ndone\\n\\nif [ -z \\\"$output\\\" ]; then\\n\\techo -e \\\"\\\\n-PASSED:
      - No local interactive users have \\\\\\\"$fname\\\\\\\" files in their home
      directory\\\\n\\\"\\n\\texit 0\\nelse\\n\\techo -e \\\"\\\\n- FAILED:\\\\n$output\\\\n\\\"\\n\\texit
      1\\nfi\\n)\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n"
    :source_location:
      :line: 4135
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: passed
      :code_desc: "Bash command output=\"\"\nfname=\".rhosts\"\nvalid_shells=\"^($(
        sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk
        -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd
        | (while read -r user home; do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n
        \ - User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z
        \"$output\" ]; then\n\techo -e \"\\n-PASSED: - No local interactive users
        have \\\"$fname\\\" files in their home directory\\n\"\n\texit 0\nelse\n\techo
        -e \"\\n- FAILED:\\n$output\\n\"\n\texit 1\nfi\n) exit_status is expected
        to eq 0"
      :run_time: 0.081399258
      :start_time: '2024-04-04T14:52:42+00:00'
      :resource_class: bash
      :resource_params: '["output=\"\"\nfname=\".rhosts\"\nvalid_shells=\"^($( sed
        -rn ''/^\\//{s,/,\\\\\\\\/,g;p}'' /etc/shells | paste -s -d ''|'' - ))$\"\nawk
        -v pat=\"$valid_shells\" -F: ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd
        | (while read -r user home; do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n  -
        User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z \"$output\"
        ]; then\n\techo -e \"\\n-PASSED: - No local interactive users have \\\"$fname\\\"
        files in their home directory\\n\"\n\texit 0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit
        1\nfi\n)"]'
      :resource_id: "output=\"\"\nfname=\".rhosts\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\t[ -f \"$home/$fname\" ] && output=\"$output\\n  - User \\\"$user\\\"
        file: \\\"$home/$fname\\\" exists\"\ndone\n\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n-PASSED: - No local interactive users have \\\"$fname\\\" files in
        their home directory\\n\"\n\texit 0\nelse\n\techo -e \"\\n- FAILED:\\n$output\\n\"\n\texit
        1\nfi\n)"
  - :id: xccdf_org.cisecurity.benchmarks_rule_6.2.16_Ensure_local_interactive_user_dot_files_are_not_group_or_world_writable
    :title: Ensure local interactive user dot files are not group or world writable
    :desc: |-
      While the system administrator can establish secure permissions for users' "dot" files, the users can easily override these.

      Rationale: Group or world-writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges.
    :descriptions:
    - :label: default
      :data: |-
        While the system administrator can establish secure permissions for users' "dot" files, the users can easily override these.

        Rationale: Group or world-writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges.
    :impact: 1.0
    :refs: []
    :tags: {}
    :code: "control \"xccdf_org.cisecurity.benchmarks_rule_6.2.16_Ensure_local_interactive_user_dot_files_are_not_group_or_world_writable\"
      do\n  title \"Ensure local interactive user dot files are not group or world
      writable\"\n  desc  \"\n    While the system administrator can establish secure
      permissions for users' \\\"dot\\\" files, the users can easily override these.\n
      \   \n    Rationale: Group or world-writable user configuration files may enable
      malicious users to steal or modify other users' data or to gain another user's
      system privileges.\n  \"\n  impact 1.0\n  describe bash(\"output=\\\"\\\"\\nperm_mask=\\\"0022\\\"\\nmaxperm=\\\"$(
      printf '%o' $(( 0777 & ~$perm_mask)) )\\\"\\nvalid_shells=\\\"^($( sed -rn '/^\\\\//{s,/,\\\\\\\\\\\\\\\\/,g;p}'
      /etc/shells | paste -s -d '|' - ))$\\\"\\nawk -v pat=\\\"$valid_shells\\\" -F:
      '$(NF) ~ pat { print $1 \\\" \\\" $(NF-1) }' /etc/passwd | (while read -r user
      home; do\\n\\tfor dfile in $(find \\\"$home\\\" -type f -name '.*'); do\\n\\t\\tmode=$(
      stat -L -c '%#a' \\\"$dfile\\\" )\\n\\t\\t[ $(( \\\"$mode\\\" & \\\"$perm_mask\\\"
      )) -gt 0 ] && output=\\\"$output\\\\n- User $user file: \\\\\\\"$dfile\\\\\\\"
      is too permissive: \\\\\\\"$mode\\\\\\\" (should be: \\\\\\\"$maxperm\\\\\\\"
      or more restrictive)\\\"\\n\\tdone\\ndone\\n# If the tests produce no output,
      we pass\\nif [ -z \\\"$output\\\" ]; then\\n\\techo -e \\\"\\\\n- Passed:\\\\n-
      All user dot files are mode: \\\\\\\"$maxperm\\\\\\\" or more restrictive\\\"\\n\\texit
      0\\nelse\\n\\techo -e \\\"\\\\n- Failed:$output\\\"\\n\\texit 1\\nfi\\n)\")
      do\n    its(\"exit_status\") { should eq 0 }\n  end\nend"
    :source_location:
      :line: 4148
      :ref: controls/translated-controls.rb
    :waiver_data: {}
    :results:
    - :status: failed
      :code_desc: "Bash command output=\"\"\nperm_mask=\"0022\"\nmaxperm=\"$( printf
        '%o' $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tfor dfile in $(find \"$home\" -type f -name '.*'); do\n\t\tmode=$( stat
        -L -c '%#a' \"$dfile\" )\n\t\t[ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ]
        && output=\"$output\\n- User $user file: \\\"$dfile\\\" is too permissive:
        \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\tdone\ndone\n#
        If the tests produce no output, we pass\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n- Passed:\\n- All user dot files are mode: \\\"$maxperm\\\" or more
        restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit 1\nfi\n)
        exit_status is expected to eq 0"
      :run_time: 0.156392929
      :start_time: '2024-04-04T14:52:42+00:00'
      :message: |2

        expected: 0
             got: 1

        (compared using ==)
      :resource_class: bash
      :resource_params: '["output=\"\"\nperm_mask=\"0022\"\nmaxperm=\"$( printf ''%o''
        $(( 0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn ''/^\\//{s,/,\\\\\\\\/,g;p}''
        /etc/shells | paste -s -d ''|'' - ))$\"\nawk -v pat=\"$valid_shells\" -F:
        ''$(NF) ~ pat { print $1 \" \" $(NF-1) }'' /etc/passwd | (while read -r user
        home; do\n\tfor dfile in $(find \"$home\" -type f -name ''.*''); do\n\t\tmode=$(
        stat -L -c ''%#a'' \"$dfile\" )\n\t\t[ $(( \"$mode\" & \"$perm_mask\" )) -gt
        0 ] && output=\"$output\\n- User $user file: \\\"$dfile\\\" is too permissive:
        \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\tdone\ndone\n#
        If the tests produce no output, we pass\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n- Passed:\\n- All user dot files are mode: \\\"$maxperm\\\" or more
        restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit 1\nfi\n)"]'
      :resource_id: "output=\"\"\nperm_mask=\"0022\"\nmaxperm=\"$( printf '%o' $((
        0777 & ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}'
        /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF)
        ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home;
        do\n\tfor dfile in $(find \"$home\" -type f -name '.*'); do\n\t\tmode=$( stat
        -L -c '%#a' \"$dfile\" )\n\t\t[ $(( \"$mode\" & \"$perm_mask\" )) -gt 0 ]
        && output=\"$output\\n- User $user file: \\\"$dfile\\\" is too permissive:
        \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\n\tdone\ndone\n#
        If the tests produce no output, we pass\nif [ -z \"$output\" ]; then\n\techo
        -e \"\\n- Passed:\\n- All user dot files are mode: \\\"$maxperm\\\" or more
        restrictive\"\n\texit 0\nelse\n\techo -e \"\\n- Failed:$output\"\n\texit 1\nfi\n)"
  :status: loaded
  :status_message: ''
:statistics:
  :duration: 12.2807912
:version: 6.6.0
